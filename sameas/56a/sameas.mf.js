
/*
 * Copyright 2012, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Additional Licenses for Third Party components can be found here:
 * http://wiki.freebase.com/wiki/Freebase_Site_License
 *
 */
/*
 
 jQuery Tools @VERSION Tooltip - UI essentials

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/tooltip/

 Since: November 2008
 Date: @DATE 
*/
(function(c){c.extend({tablesorter:new (function(){function d(g,l){n(g+","+((new Date).getTime()-l.getTime())+"ms")}function n(g){typeof console!="undefined"&&typeof console.debug!="undefined"?console.log(g):alert(g)}function h(g,l){if(g.config.debug)var p="";var a=g.tBodies[0].rows;if(g.tBodies[0].rows[0]){var f=[];a=a[0].cells;for(var o=a.length,m=0;m<o;m++){var r=false;if(c.metadata&&c(l[m]).metadata()&&c(l[m]).metadata().sorter)r=b(c(l[m]).metadata().sorter);else if(g.config.headers[m]&&g.config.headers[m].sorter)r=
b(g.config.headers[m].sorter);if(!r)a:{r=a[m];for(var t=z.length,u=1;u<t;u++)if(z[u].is(c.trim(j(g.config,r)),g,r)){r=z[u];break a}r=z[0]}if(g.config.debug)p+="column:"+m+" parser:"+r.id+"\n";f.push(r)}}g.config.debug&&n(p);return f}function b(g){for(var l=z.length,p=0;p<l;p++)if(z[p].id.toLowerCase()==g.toLowerCase())return z[p];return false}function e(g){if(g.config.debug)var l=new Date;for(var p=g.tBodies[0]&&g.tBodies[0].rows.length||0,a=g.tBodies[0].rows[0]&&g.tBodies[0].rows[0].cells.length||
0,f=g.config.parsers,o={row:[],normalized:[]},m=0;m<p;++m){var r=g.tBodies[0].rows[m],t=[];o.row.push(c(r));for(var u=0;u<a;++u)t.push(f[u].format(j(g.config,r.cells[u]),g,r.cells[u]));t.push(m);o.normalized.push(t)}g.config.debug&&d("Building cache for "+p+" rows:",l);return o}function j(g,l){if(!l)return"";var p="";return p=g.textExtraction=="simple"?l.childNodes[0]&&l.childNodes[0].hasChildNodes()?l.childNodes[0].innerHTML:l.innerHTML:typeof g.textExtraction=="function"?g.textExtraction(l):c(l).text()}
function q(g,l){if(g.config.debug)var p=new Date;for(var a=l.row,f=l.normalized,o=f.length,m=f[0].length-1,r=c(g.tBodies[0]),t=[],u=0;u<o;u++){t.push(a[f[u][m]]);if(!g.config.appender)for(var F=a[f[u][m]],E=F.length,D=0;D<E;D++)r[0].appendChild(F[D])}g.config.appender&&g.config.appender(g,t);t=null;g.config.debug&&d("Rebuilt table:",p);w(g);setTimeout(function(){c(g).trigger("sortEnd")},0)}function s(g){if(g.config.debug)var l=new Date;for(var p=[],a=0;a<g.tHead.rows.length;a++)p[a]=0;$tableHeaders=
c("thead th",g);$tableHeaders.each(function(f){this.count=0;this.column=f;var o=g.config.sortInitialOrder;this.order=i=typeof o!="Number"?o.toLowerCase()=="desc"?1:0:o==1?o:0;if(!(o=c.metadata&&c(this).metadata().sorter===false?true:false))o=g.config.headers[f]&&g.config.headers[f].sorter===false?true:false;if(o)this.sortDisabled=true;this.sortDisabled||c(this).addClass(g.config.cssHeader);g.config.headerList[f]=this});if(g.config.debug){d("Built headers:",l);n($tableHeaders)}return $tableHeaders}
function w(g){for(var l=g.config.widgets,p=l.length,a=0;a<p;a++)y(l[a]).format(g)}function y(g){for(var l=A.length,p=0;p<l;p++)if(A[p].id.toLowerCase()==g.toLowerCase())return A[p]}function C(g,l){for(var p=l.length,a=0;a<p;a++)if(l[a][0]==g)return true;return false}function v(g,l,p,a){l.removeClass(a[0]).removeClass(a[1]);var f=[];l.each(function(){this.sortDisabled||(f[this.column]=c(this))});g=p.length;for(l=0;l<g;l++)f[p[l][0]].addClass(a[p[l][1]])}function x(g){if(g.config.widthFixed){var l=
c("<colgroup>");c("tr:first td",g.tBodies[0]).each(function(){l.append(c("<col>").css("width",c(this).width()))});c(g).prepend(l)}}function B(g,l,p){if(g.config.debug)var a=new Date;for(var f="var sortWrapper = function(a,b) {",o=l.length,m=0;m<o;m++){var r=l[m][0],t=l[m][1],u="e"+m;f+="var "+u+" = "+(g.config.parsers[r].type=="text"?t==0?"sortText":"sortTextDesc":t==0?"sortNumeric":"sortNumericDesc")+"(a["+r+"],b["+r+"]); ";f+="if("+u+") { return "+u+"; } ";f+="else { "}m=p.normalized[0].length-
1;f+="return a["+m+"]-b["+m+"];";for(m=0;m<o;m++)f+="}; ";f+="return 0; ";f+="}; ";eval(f);p.normalized.sort(sortWrapper);g.config.debug&&d("Sorting on "+l.toString()+" and dir "+t+" time:",a);return p}var z=[],A=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:false,cancelSelection:true,
sortList:[],headerList:[],dateFormat:"us",decimal:".",debug:false};this.benchmark=d;this.construct=function(g){return this.each(function(){if(this.tHead&&this.tBodies){var l,p,a,f;this.config={};f=c.extend(this.config,c.tablesorter.defaults,g);l=c(this);p=s(this);this.config.parsers=h(this,p);a=e(this);var o=[f.cssDesc,f.cssAsc];x(this);p.click(function(m){l.trigger("sortStart");var r=l[0].tBodies[0]&&l[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&r>0){c(this);r=this.column;this.order=this.count++%
2;if(m[f.sortMultiSortKey])if(C(r,f.sortList))for(m=0;m<f.sortList.length;m++){var t=f.sortList[m],u=f.headerList[t[0]];if(t[0]==r){u.count=t[1];u.count++;t[1]=u.count%2}}else f.sortList.push([r,this.order]);else{f.sortList=[];if(f.sortForce!=null){t=f.sortForce;for(m=0;m<t.length;m++)t[m][0]!=r&&f.sortList.push(t[m])}f.sortList.push([r,this.order])}setTimeout(function(){v(l[0],p,f.sortList,o);q(l[0],B(l[0],f.sortList,a))},1);return false}}).mousedown(function(){if(f.cancelSelection){this.onselectstart=
function(){return false};return false}});l.bind("update",function(){this.config.parsers=h(this,p);a=e(this)}).bind("sorton",function(m,r){c(this).trigger("sortStart");f.sortList=r;for(var t=f.sortList,u=this.config,F=t.length,E=0;E<F;E++){var D=t[E],G=u.headerList[D[0]];G.count=D[1];G.count++}v(this,p,t,o);q(this,B(this,t,a))}).bind("appendCache",function(){q(this,a)}).bind("applyWidgetId",function(m,r){y(r).format(this)}).bind("applyWidgets",function(){w(this)});if(c.metadata&&c(this).metadata()&&
c(this).metadata().sortlist)f.sortList=c(this).metadata().sortlist;f.sortList.length>0&&l.trigger("sorton",[f.sortList]);w(this)}})};this.addParser=function(g){for(var l=z.length,p=true,a=0;a<l;a++)if(z[a].id.toLowerCase()==g.id.toLowerCase())p=false;p&&z.push(g)};this.addWidget=function(g){A.push(g)};this.formatFloat=function(g){g=parseFloat(g);return isNaN(g)?0:g};this.formatInt=function(g){g=parseInt(g);return isNaN(g)?0:g};this.isDigit=function(g,l){var p="\\"+l.decimal;return RegExp("/(^[+]?0("+
p+"0+)?$)|(^([-+]?[1-9][0-9]*)$)|(^([-+]?((0?|[1-9][0-9]*)"+p+"(0*[1-9][0-9]*)))$)|(^[-+]?[1-9]+[0-9]*"+p+"0+$)/").test(c.trim(g))};this.clearTableBody=function(g){if(c.browser.msie)(function(){for(;this.firstChild;)this.removeChild(this.firstChild)}).apply(g.tBodies[0]);else g.tBodies[0].innerHTML=""}})});c.fn.extend({tablesorter:c.tablesorter.construct});var k=c.tablesorter;k.addParser({id:"text",is:function(){return true},format:function(d){return c.trim(d.toLowerCase())},type:"text"});k.addParser({id:"digit",
is:function(d,n){return c.tablesorter.isDigit(d,n.config)},format:function(d){return c.tablesorter.formatFloat(d)},type:"numeric"});k.addParser({id:"currency",is:function(d){return/^[\u00c3\u201a\u00c2\u00a3$\u00c3\u00a2\u00e2\u20ac\u0161\u00c2\u00ac?.]/.test(d)},format:function(d){return c.tablesorter.formatFloat(d.replace(new RegExp(/[^0-9.]/g),""))},type:"numeric"});k.addParser({id:"ipAddress",is:function(d){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(d)},format:function(d){d=d.split(".");
for(var n="",h=d.length,b=0;b<h;b++){var e=d[b];n+=e.length==2?"0"+e:e}return c.tablesorter.formatFloat(n)},type:"numeric"});k.addParser({id:"url",is:function(d){return/^(https?|ftp|file):\/\/$/.test(d)},format:function(d){return jQuery.trim(d.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"});k.addParser({id:"isoDate",is:function(d){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(d)},format:function(d){return c.tablesorter.formatFloat(d!=""?(new Date(d.replace(new RegExp(/-/g),"/"))).getTime():
"0")},type:"numeric"});k.addParser({id:"percent",is:function(d){return/\%$/.test(c.trim(d))},format:function(d){return c.tablesorter.formatFloat(d.replace(new RegExp(/%/g),""))},type:"numeric"});k.addParser({id:"usLongDate",is:function(d){return d.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(d){return c.tablesorter.formatFloat((new Date(d)).getTime())},type:"numeric"});k.addParser({id:"shortDate",
is:function(d){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(d)},format:function(d,n){var h=n.config;d=d.replace(/\-/g,"/");if(h.dateFormat=="us")d=d.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2");else if(h.dateFormat=="uk")d=d.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1");else if(h.dateFormat=="dd/mm/yy"||h.dateFormat=="dd-mm-yy")d=d.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");return c.tablesorter.formatFloat((new Date(d)).getTime())},type:"numeric"});
k.addParser({id:"time",is:function(d){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(d)},format:function(d){return c.tablesorter.formatFloat((new Date("2000/01/01 "+d)).getTime())},type:"numeric"});k.addParser({id:"metadata",is:function(){return false},format:function(d,n,h){d=n.config;d=!d.parserMetadataName?"sortValue":d.parserMetadataName;return c(h).metadata()[d]},type:"numeric"});k.addWidget({id:"zebra",format:function(d){if(d.config.debug)var n=new Date;c("tr:visible",
d.tBodies[0]).filter(":even").removeClass(d.config.widgetZebra.css[1]).addClass(d.config.widgetZebra.css[0]).end().filter(":odd").removeClass(d.config.widgetZebra.css[0]).addClass(d.config.widgetZebra.css[1]);d.config.debug&&c.tablesorter.benchmark("Applying Zebra widget",n)}})})(jQuery);
(function(c){c(function(){if(c.tablesorter){var k=c("<div>");c.tablesorter.defaults.cssAsc="column-header-asc";c.tablesorter.defaults.cssDesc="column-header-desc";c.tablesorter.defaults.cssHeader="column-header";c.tablesorter.addParser({id:"datetime",is:function(){return false},format:function(d){k.html(d);return k.find("time:first").attr("datetime")},type:"text"});c.tablesorter.addParser({id:"ignoreCase",is:function(){return false},format:function(d){k.html(d);return k.text().toLowerCase()},type:"text"});
c.tablesorter.addParser({id:"string",is:function(){return false},format:function(d){k.html(d);return k.text()},type:"text"});c.tablesorter.addParser({id:"number",is:function(){return false},format:function(d){k.html(d);d=k.find(".number:first").attr("data-value");if(d==null)return Number.MAX_VALUE;return d},type:"numeric"});c(".table-sortable").each(function(){c(this).tablesorter()})}})})(jQuery);
(function(c){c.factory("collapse_module",{init:function(){var d=this;this.$column=c(this.options.column);this.modules=c(this.options.modules,this.element);this.first_module=this.modules.get(0);this.trigger=c(".trigger:first",this.first_module);this.first_section=c(".module-section",this.first_module);this.other_modules=this.modules.slice(1);this.column_offset=this.$column.css("margin-left");this.set_collapsed(this.options.collapsed);this.trigger.click(function(n){return d.toggle(n)})},set_collapsed:function(d){if(this.toggle_state=
d){this.trigger.addClass("collapsed");this.$column.css("margin-left",0);this.first_section.hide();this.other_modules.hide()}else{this.trigger.removeClass("collapsed");this.$column.css("margin-left",this.column_offset);this.first_section.show();this.other_modules.show()}},toggle:function(){var d=this;if(this.toggle_state){c.localstore("filters_collapsed",0,false);this.trigger.removeClass("collapsed");this.$column.animate({marginLeft:this.column_offset},function(){d.first_section.slideDown(function(){d.modules.removeClass("collapsed")});
d.other_modules.fadeIn()})}else{c.localstore("filters_collapsed",1,false);this.trigger.addClass("collapsed");this.other_modules.fadeOut();this.first_section.slideUp(function(){d.$column.animate({marginLeft:0});d.modules.addClass("collapsed")})}this.toggle_state=!this.toggle_state;this.options.toggle_callback&&this.options.toggle_callback.call(this.trigger,this.toggle_state);return false}});var k=c("body").is(".embed")||c.localstore("filters_collapsed");c.extend(true,c.collapse_module,{defaults:{collapsed:k===
null?false:!!k,modules:".module",column:"#main-column"}})})(jQuery);
(function(c){function k(h,b,e){var j=e.relative?h.position().top:h.offset().top,q=e.relative?h.position().left:h.offset().left,s=e.position[0];j-=b.outerHeight()-e.offset[0];q+=h.outerWidth()+e.offset[1];var w=b.outerHeight()+h.outerHeight();if(s=="center")j+=w/2;if(s=="bottom")j+=w;s=e.position[1];h=b.outerWidth()+h.outerWidth();if(s=="center")q-=h/2;if(s=="left")q-=h;return{top:j,left:q}}function d(h,b){var e=this,j=h.add(e),q,s=0,w=0,y=h.attr("title"),C=n[b.effect],v,x=h.is(":input"),B=x&&h.is(":checkbox, :radio, select, :button, :submit"),
z=h.attr("type"),A=b.events[z]||b.events[x?B?"widget":"input":"def"];if(!C)throw'Nonexistent effect "'+b.effect+'"';A=A.split(/,\s*/);if(A.length!=2)throw"Tooltip: bad events configuration for "+z;h.bind(A[0],function(g){clearTimeout(s);if(b.predelay)w=setTimeout(function(){e.show(g)},b.predelay);else e.show(g)}).bind(A[1],function(g){clearTimeout(w);if(b.delay)s=setTimeout(function(){e.hide(g)},b.delay);else e.hide(g)});if(y&&b.cancelDefault){h.removeAttr("title");h.data("title",y)}c.extend(e,{show:function(g){if(!q){if(y)q=
c(b.layout).addClass(b.tipClass).appendTo(document.body).hide().append(y);else if(b.tip)q=c(b.tip).eq(0);else{q=h.next();q.length||(q=h.parent().next())}if(!q.length)throw"Cannot find tooltip for "+h;}if(e.isShown())return e;q.stop(true,true);var l=k(h,q,b);g=g||c.Event();g.type="onBeforeShow";j.trigger(g,[l]);if(g.isDefaultPrevented())return e;l=k(h,q,b);q.css({position:"absolute",top:l.top,left:l.left});v=true;C[0].call(e,function(){g.type="onShow";v="full";j.trigger(g)});l=b.events.tooltip.split(/,\s*/);
q.bind(l[0],function(){clearTimeout(s);clearTimeout(w)});l[1]&&!h.is("input:not(:checkbox, :radio), textarea")&&q.bind(l[1],function(p){p.relatedTarget!=h[0]&&h.trigger(A[1].split(" ")[0])});return e},hide:function(g){if(!q||!e.isShown())return e;g=g||c.Event();g.type="onBeforeHide";j.trigger(g);if(!g.isDefaultPrevented()){v=false;n[b.effect][1].call(e,function(){g.type="onHide";v=false;j.trigger(g)});return e}},isShown:function(g){return g?v=="full":v},getConf:function(){return b},getTip:function(){return q},
getTrigger:function(){return h}});c.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(g,l){c.isFunction(b[l])&&c(e).bind(l,b[l]);e[l]=function(p){c(e).bind(l,p);return e}})}c.tools=c.tools||{version:"@VERSION"};c.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,position:["top","center"],offset:[0,0],relative:false,cancelDefault:true,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},
layout:"<div/>",tipClass:"tooltip"},addEffect:function(h,b,e){n[h]=[b,e]}};var n={toggle:[function(h){var b=this.getConf(),e=this.getTip();b=b.opacity;b<1&&e.css({opacity:b});e.show();h.call()},function(h){this.getTip().hide();h.call()}],fade:[function(h){var b=this.getConf();this.getTip().fadeTo(b.fadeInSpeed,b.opacity,h)},function(h){this.getTip().fadeOut(this.getConf().fadeOutSpeed,h)}]};c.fn.tooltip=function(h){var b=this.data("tooltip");if(b)return b;h=c.extend(true,{},c.tools.tooltip.conf,h);
if(typeof h.position=="string")h.position=h.position.split(/,?\s/);this.each(function(){b=new d(c(this),h);c(this).data("tooltip",b)});return h.api?b:this}})(jQuery);
(function(c,k){k.filters={init_domain_type_property_filter:function(d){c(":text[name=domain], :text[name=type], :text[name=property]",d).suggest(c.extend({scoring:"schema",format:null,mql_output:JSON.stringify([{id:null,name:null,type:{id:null,"id|=":["/type/domain","/type/type","/type/property"],limit:1}}])},k.suggest_options.any("type:/type/domain","type:/type/type","type:/type/property"))).bind("fb-select",function(n,h){var b=c(this);b.val(h.id);var e=h.type.id;if(e==="/type/domain")b.attr("name",
"domain");else if(e==="/type/type")b.attr("name","type");else e==="/type/property"&&b.attr("name","property");this.form.submit()}).parents(".filter-form").submit(function(){return false})}};c(function(){c(".filter-form :input").keypress(function(d){d.keyCode===13&&this.form.submit();return true});c(".filter-help-trigger").tooltip({events:{def:"click,mouseout"},position:"top center",effect:"fade",delay:300,offset:[-8,0]});c(".filter-form-trigger").click(function(){var d=c(this).siblings(".filter-form");
d.is(":hidden")?d.slideDown(function(){c(":text:first",d).focus()}):d.slideUp()})})})(jQuery,window.freebase);
(function(c){var k=function(){return typeof window.innerWidth!="undefined"?function(){return{w:window.innerWidth,h:window.innerHeight}}:typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0?function(){return{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}}:function(){return{w:document.getElementsByTagName("body")[0].clientWidth,h:document.getElementsByTagName("body")[0].clientHeight}}}();
window.kbs=function(d){c(".kbs.current",d).removeClass("current");var n=c(".domain-section:first",d),h=c(".domain-section:last",d),b=this.scroll_to=function(a){var f=c(document).scrollTop();c(document).height();var o=k().h;o=f+o;var m=a.offset().top;a=m+a.height();if(m<f)c(document).scrollTop(m);else a>o&&c(document).scrollTop(f+(a-o))},e=this.get_current=function(){return c(".kbs.current:first",d)},j=this.set_next=function(a,f,o){a=a||e();if(f.length){a.removeClass("current");f.addClass("current");
o||b(f)}},q=this.next_domain=function(a){var f=e(),o=s(f);if(o){o=o.find(".kbs:first");j(f,o,a)}},s=this._next_domain=function(a){if(!(a&&a.length))return c(".domain-section:first",d);a=a.closest(".domain-section");return!a.length||a[0]===h[0]?n:a.next(".domain-section")},w=this.prev_domain=function(){var a=e(),f=y(a);if(f){f=f.find(".kbs:first");j(a,f)}},y=this._prev_domain=function(a){if(!(a&&a.length))return c(".domain-section:last",d);var f=a.closest(".domain-section");if(a.closest(".property-section").length||
a.closest(".type-section").length)return f;return!f.length||f[0]===n[0]?h:f.prev(".domain-section")},C=this.next_type=function(){var a=e(),f=v(a);if(f){f=f.find(".kbs:first");j(a,f)}},v=this._next_type=function(a){if(!(a&&a.length))return c(".type-section:first",d);var f=a.closest(".domain-section");a=a.closest(".type-section");a=a.length?a.next(".type-section"):f.find(".type-section:first");if(!(a&&a.length)){var o=s(f);if(o)for(;o.get(0)!==f.get(0);){a=o.find(".type-section:first");if(a.length)break;
o=s(o)}}return a},x=this.prev_type=function(){var a=e(),f=B(a);if(f){f=f.find(".kbs:first");j(a,f)}},B=this._prev_type=function(a){if(!(a&&a.length))return c(".type-section:last",d);var f=a.closest(".domain-section"),o=a.closest(".type-section");if(a.closest(".property-section").length)return o;var m;if(o.length)m=o.prev(".type-section");if(!(m&&m.length))if(a=y(f))for(;a.get(0)!==f.get(0);){m=a.find(".type-section:last");if(m.length)break;a=y(a)}return m},z=this.next_prop=function(){var a=e(),f=
A(a);if(f){f=f.find(".kbs:first");j(a,f)}},A=this._next_prop=function(a){if(!(a&&a.length))return c(".property-section:first",d);var f=a.closest(".domain-section"),o=a.closest(".type-section"),m=a.closest(".property-section");f=m.length?m.next(".property-section"):o.length?o.find(".property-section:first"):f.find(".property-section:first");if(!(f&&f.length))if(a=v(a))for(;a.get(0)!==o.get(0);){f=a.find(".property-section:first");if(f.length)break;if(o.get(0)==null)o=a;a=v(a)}return f},g=this.prev_prop=
function(){var a=e(),f=l(a);if(f){f=f.find(".kbs:first");j(a,f)}},l=this._prev_prop=function(a){if(!(a&&a.length))return c(".property-section:last",d);var f=a.closest(".domain-section"),o=a.closest(".type-section"),m=a.closest(".property-section");if(a.closest(".data-section").length)return m;var r;if(m.length)r=m.prev(".property-section");if(!(r&&r.length))if(x=o.length?B(o):B(f))for(;x.get(0)!==o.get(0);){r=x.find(".property-section:last");if(r.length)break;if(o.get(0)==null)o=x;x=B(x)}return r};
this.next=function(){var a=e(),f=this._next(a);f&&j(a,f)};this._next=function(a){if(!(a&&a.length))return c(".domain-section:first .kbs:first",d);var f=a.closest(".domain-section"),o=a.closest(".type-section"),m=a.closest(".property-section");if(a.closest(".data-section").length){a=a.next(".kbs");if(a.length)return a;a=m.next(".property-section").find(".kbs:first");if(a.length)return a;a=o.next(".type-section").find(".kbs:first")}else if(m.length){a=m.find(".data-section:first .kbs:first");if(a.length)return a;
a=m.next(".property-section").find(".kbs:first");if(a.length)return a;a=o.next(".type-section").find(".kbs:first")}else if(o.length){a=o.find(".property-section:first .kbs:first");if(a.length)return a;a=o.next(".type-section").find(".kbs:first")}else a=f.find(".type-section:first .kbs:first");if(a.length)return a;return f.get(0)===h.get(0)?n.find(".kbs:first"):f.next(".domain-section").find(".kbs:first")};this.prev=function(){var a=e(),f=this._prev(a);f&&j(a,f)};this._prev=function(a){if(!(a&&a.length)){a=
c(".data-section:last .kbs:last",d);a.length||(a=c(".property-section:last .kbs:first",d));a.length||(a=c(".type-section:last .kbs:first",d));a.length||(a=c(".domain-section:last .kbs:first",d));return a}var f=a.closest(".domain-section"),o=a.closest(".type-section"),m=a.closest(".property-section");if(a.closest(".data-section").length){a=a.prev(".kbs");if(a.length)return a;return m.find(".kbs:first")}else if(m.length){a=m.prev(".property-section").find(".kbs:last");if(a.length)return a;return o.find(".kbs:first")}else if(o.length){a=
o.prev(".type-section").find(".kbs:last");if(a.length)return a;return f.find(".kbs:first")}else return f.get(0)===n.get(0)?h.find(".kbs:last"):f.prev(".domain-section").find(".kbs:last")};this.edit=function(){this.get_current().trigger("edit")};var p=this;c(document).unbind(".kbs").bind("keydown.kbs",function(a){var f=a.target;if(f==document.body||f==document||f==window||f==c("html")[0]){f=a.keyCode;if(f===68)a.shiftKey?w():q();else if(f===84)a.shiftKey?x():C();else if(f===80)a.shiftKey?g():z();else if(f===
74)p.next();else if(f===75)p.prev();else f===69&&p.edit()}})}})(jQuery);
(function(c,k){var d=window.propbox={init:function(n,h){h=c.extend({lang:"/lang/en"},h);if(!h.base_ajax_url)throw new Error("base_ajax_url required in propbox options");if(!h.base_static_url)throw new Error("base_static_url required in propbox options");if(!h.id)throw new Error("topic id required in propbox options");if(!h.lang)throw new Error("lang required in propbox options");d.options=h;d.kbs=new k(n);d.kbs.set_next(d.kbs.get_current(),c(".kbs:visible:first",n,true));c(".kbs",n).live("click",
function(){var b=d.kbs.get_current();d.kbs.set_next(b,c(this),true)}).live("edit",function(){var b=c(this).find(".headmenu:first").data("submenu");b&&c("li:first a:first",b).click()});d.init_menus(n)},init_menus:function(n,h){n=c(n||document);h&&c(".nicemenu",n).nicemenu();(n&&n.is(".data-row")?n:c(".data-row",n)).hover(d.row_menu_hoverover,d.row_menu_hoverout);c(".nicemenu .headmenu",n).add(c(".nicemenu .default-action",n)).click("click",function(){if(d.kbs){var b=d.kbs.get_current();b&&d.kbs.set_next(b,
c(this).parents(".kbs:first"),true)}return false})},row_menu_hoverover:function(){var n=c(this);d.row_menu_hoverover.timeout=setTimeout(function(){n.addClass("row-hover")},300)},row_menu_hoverout:function(){clearTimeout(d.row_menu_hoverover.timeout);c(this).removeClass("row-hover")},get_script:function(n,h){var b=d.get_script.cache;if(!b)b=d.get_script.cache={};var e=b[n];if(e)if(e.state===1)e.callbacks.push(h);else e.state===4&&h();else{e=b[n]={state:0,callbacks:[h]};c.ajax({url:d.options.base_static_url+
n,dataType:"script",beforeSend:function(){e.state=1},success:function(){e.state=4;c.each(e.callbacks,function(j,q){q()})},error:function(){e.state=-1}})}},prop_edit:function(n,h){var b=c(n).parents(".submenu").data("headmenu").parents(".property-section").find(".data-section .data-row:first:visible .nicemenu:first .headmenu:first a");b.length?b.click():d.prop_add(n,h);return false},prop_add:function(n,h){var b=c(n).parents(".submenu").data("headmenu").parents(".property-section");d.get_script("/propbox-edit.mf.js",
function(){d.edit.prop_add_begin(b,h)});return false},value_edit:function(n){var h=c(n).parents(".submenu").data("headmenu").parents(".data-row:first"),b=h.parents(".property-section");d.get_script("/propbox-edit.mf.js",function(){d.edit.value_edit_begin(b,h)});return false},value_delete:function(n){var h=c(n).parents(".submenu").data("headmenu").parents(".data-row:first"),b=h.parents(".property-section");d.get_script("/propbox-edit.mf.js",function(){d.edit.value_delete_begin(b,h)});return false},
close_message:function(n){c(n).parents(".row-msg:first").remove();return false}}})(jQuery,window.kbs);
(function(c,k,d){k.infinitescroll=function(b,e,j){this.element=k(j);this._create(b,e)};k.infinitescroll.defaults={loading:{finished:d,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"http://www.infinite-scroll.com/loading.gif",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:d},state:{isDuringAjax:false,isInvalidPage:false,isDestroyed:false,isDone:false,isPaused:false,currPage:1},callback:d,debug:false,behavior:d,binder:k(c),
nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:false,pathParse:d,dataType:"html",appendCallback:true,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:d,path:d};k.infinitescroll.prototype={_binding:function(b){var e=this,j=e.options;if(j.behavior&&this["_binding_"+j.behavior]!==d)this["_binding_"+j.behavior].call(this);else{if(b!=="bind"&&b!=="unbind"){this._debug("Binding value  "+b+" not valid");
return false}b=="unbind"?this.options.binder.unbind("smartscroll.infscr."+e.options.infid):this.options.binder[b]("smartscroll.infscr."+e.options.infid,function(){e.scroll()});this._debug("Binding",b)}},_create:function(b,e){if(!this._validate(b))return false;var j=this.options=k.extend(true,{},k.infinitescroll.defaults,b),q=k(j.nextSelector).attr("href");j.contentSelector=j.contentSelector||this.element;j.loading.selector=j.loading.selector||j.contentSelector;if(q){j.path=this._determinepath(q);
j.loading.msg=k('<div id="infscr-loading"><img alt="Loading..." src="'+j.loading.img+'" /><div>'+j.loading.msgText+"</div></div>");(new Image).src=j.loading.img;j.pixelsFromNavToBottom=k(document).height()-k(j.navSelector).offset().top;j.loading.start=j.loading.start||function(){k(j.navSelector).hide();j.loading.msg.appendTo(j.loading.selector).show(j.loading.speed,function(){beginAjax(j)})};j.loading.finished=j.loading.finished||function(){j.loading.msg.fadeOut("normal")};j.callback=function(s,w){j.behavior&&
s["_callback_"+j.behavior]!==d&&s["_callback_"+j.behavior].call(k(j.contentSelector)[0],w);e&&e.call(k(j.contentSelector)[0],w)};this._setup()}else this._debug("Navigation selector not found")},_debug:function(){if(this.options.debug)return c.console&&console.log.call(console,arguments)},_determinepath:function(b){var e=this.options;if(e.behavior&&this["_determinepath_"+e.behavior]!==d)this["_determinepath_"+e.behavior].call(this,b);else{if(e.pathParse){this._debug("pathParse manual");if(typeof e.pathParse===
"function")return e.pathParse();return e.pathParse}else if(b.match(/^(.*?)\b2\b(.*?$)/))b=b.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(b.match(/^(.*?)2(.*?$)/)){if(b.match(/^(.*?page=)2(\/.*|$)/))return b=b.match(/^(.*?page=)2(\/.*|$)/).slice(1);b=b.match(/^(.*?)2(.*?$)/).slice(1)}else if(b.match(/^(.*?page=)1(\/.*|$)/))return b=b.match(/^(.*?page=)1(\/.*|$)/).slice(1);else{this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.");
e.state.isInvalidPage=true}this._debug("determinePath",b);return b}},_error:function(b){var e=this.options;if(e.behavior&&this["_error_"+e.behavior]!==d)this["_error_"+e.behavior].call(this,b);else{if(b!=="destroy"&&b!=="end")b="unknown";this._debug("Error",b);b=="end"&&this._showdonemsg();e.state.isDone=true;e.state.currPage=1;e.state.isPaused=false;this._binding("unbind")}},_loadcallback:function(b,e){var j=this.options,q=this.options.callback,s=j.state.isDone?"done":!j.appendCallback?"no-append":
"append";if(j.behavior&&this["_loadcallback_"+j.behavior]!==d)this["_loadcallback_"+j.behavior].call(this,b,e);else{switch(s){case "done":this._showdonemsg();return false;case "no-append":if(j.dataType=="html"){e="<div>"+e+"</div>";e=k(e).find(j.itemSelector)}break;case "append":var w=b.children();if(w.length==0)return this._error("end");for(s=document.createDocumentFragment();b[0].firstChild;)s.appendChild(b[0].firstChild);this._debug("contentSelector",k(j.contentSelector)[0]);k(j.contentSelector)[0].appendChild(s);
e=w.get();break}j.loading.finished.call(k(j.contentSelector)[0],j);if(j.animate){s=k(c).scrollTop()+k("#infscr-loading").height()+j.extraScrollPx+"px";k("html,body").animate({scrollTop:s},800,function(){j.state.isDuringAjax=false})}if(!j.animate)j.state.isDuringAjax=false;q(this,e)}},_nearbottom:function(){var b=this.options,e=0+k(document).height()-b.binder.scrollTop()-k(c).height();if(b.behavior&&this["_nearbottom_"+b.behavior]!==d)this["_nearbottom_"+b.behavior].call(this);else{this._debug("math:",
e,b.pixelsFromNavToBottom);return e-b.bufferPx<b.pixelsFromNavToBottom}},_pausing:function(b){var e=this.options;if(e.behavior&&this["_pausing_"+e.behavior]!==d)this["_pausing_"+e.behavior].call(this,b);else{b!=="pause"&&b!=="resume"&&b!==null&&this._debug("Invalid argument. Toggling pause value instead");switch(b&&(b=="pause"||b=="resume")?b:"toggle"){case "pause":e.state.isPaused=true;break;case "resume":e.state.isPaused=false;break;case "toggle":e.state.isPaused=!e.state.isPaused;break}this._debug("Paused",
e.state.isPaused);return false}},_setup:function(){var b=this.options;if(b.behavior&&this["_setup_"+b.behavior]!==d)this["_setup_"+b.behavior].call(this);else{this._binding("bind");return false}},_showdonemsg:function(){var b=this.options;if(b.behavior&&this["_showdonemsg_"+b.behavior]!==d)this["_showdonemsg_"+b.behavior].call(this);else{b.loading.msg.find("img").hide().parent().find("div").html(b.loading.finishedMsg).animate({opacity:1},2E3,function(){k(this).parent().fadeOut("normal")});b.errorCallback.call(k(b.contentSelector)[0],
"done")}},_validate:function(b){for(var e in b){if(e.indexOf&&e.indexOf("Selector")>-1&&k(b[e]).length===0){this._debug("Your "+e+" found no elements.");return false}return true}},bind:function(){this._binding("bind")},destroy:function(){this.options.state.isDestroyed=true;return this._error("destroy")},pause:function(){this._pausing("pause")},resume:function(){this._pausing("resume")},retrieve:function(b){var e=this,j=e.options,q=this._determinepath(q),s,w,y,C;b=b||null;beginAjax=function(v){v.state.currPage++;
e._debug("heading into ajax",q);s=k(v.contentSelector).is("table")?k("<tbody/>"):k("<div/>");w=q.join(v.state.currPage);y=v.dataType=="html"||v.dataType=="json"?v.dataType:"html+callback";if(v.appendCallback&&v.dataType=="html")y+="+callback";switch(y){case "html+callback":e._debug("Using HTML via .load() method");s.load(w+" "+v.itemSelector,null,function(x){e._loadcallback(s,x)});break;case "html":case "json":e._debug("Using "+y.toUpperCase()+" via $.ajax() method");k.ajax({url:w,dataType:v.dataType,
complete:function(x,B){(C=typeof x.isResolved!=="undefined"?x.isResolved():B==="success"||B==="notmodified")?e._loadcallback(s,x.responseText):e._error("end")}});break}};if(j.behavior&&this["retrieve_"+j.behavior]!==d)this["retrieve_"+j.behavior].call(this,b);else{if(j.state.isDestroyed){this._debug("Instance is destroyed");return false}j.state.isDuringAjax=true;j.loading.start.call(k(j.contentSelector)[0],j)}},scroll:function(){var b=this.options,e=b.state;if(b.behavior&&this["scroll_"+b.behavior]!==
d)this["scroll_"+b.behavior].call(this);else e.isDuringAjax||e.isInvalidPage||e.isDone||e.isDestroyed||e.isPaused||this._nearbottom()&&this.retrieve()},toggle:function(){this._pausing()},unbind:function(){this._binding("unbind")},update:function(b){if(k.isPlainObject(b))this.options=k.extend(true,this.options,b)}};k.fn.infinitescroll=function(b,e){switch(typeof b){case "string":var j=Array.prototype.slice.call(arguments,1);this.each(function(){var q=k.data(this,"infinitescroll");if(!q)return false;
if(!k.isFunction(q[b])||b.charAt(0)==="_")return false;q[b].apply(q,j)});break;case "object":this.each(function(){var q=k.data(this,"infinitescroll");q?q.update(b):k.data(this,"infinitescroll",new k.infinitescroll(b,e,this))});break}return this};var n=k.event,h;n.special.smartscroll={setup:function(){k(this).bind("scroll",n.special.smartscroll.handler)},teardown:function(){k(this).unbind("scroll",n.special.smartscroll.handler)},handler:function(b,e){var j=this,q=arguments;b.type="smartscroll";h&&
clearTimeout(h);h=setTimeout(function(){k.event.handle.apply(j,q)},e==="execAsap"?0:100)}};k.fn.smartscroll=function(b){return b?this.bind("smartscroll",b):this.trigger("smartscroll",["execAsap"])}})(window,jQuery);
(function(c,k,d){var n=k.sameas={init:function(){c(".column.nav").collapse_module({modules:".module",column:".section"});c(":text[name=creator]").suggest(k.suggest_options.any("type:/type/user")).bind("fb-select",function(h,b){c(this).val(b.id).parents("form:first").submit()});d.init_menus();c(".infinitescroll > tbody").each(function(){n.init_infinitescroll(c(this))})},infid:0,init_infinitescroll:function(h){if(h.attr("data-next")){var b=h.next("tfoot").find(".infinitescroll-next");h.infinitescroll({loading:{msgText:"Fetching more links",
img:k.h.static_url("lib/template/img/horizontal-loader.gif")},nextSelector:b,navSelector:b,dataType:"json",pathParse:function(){return[b[0].href+"&"+c.param({next:h.attr("data-next")})+"&page=",""]},appendCallback:false,infid:n.infid++},function(e){e=JSON.parse(e);var j=c(e.result.html);if(e=j.attr("data-next")){j=c(">tr",j);h.append(j);j.each(function(){d.init_menus(this,true)});h.attr("data-next",e);e=c(">tr",h).length;j=h.parent("table");var q=j.prev(".table-title").find("[name=infinitescroll-count]");
c(".number",q).attr("data-value",e).text(e);j.trigger("update")}else(e=h.data("infinitescroll"))&&e.unbind()});c(window).trigger("scroll")}else h.next("tfoot").remove()},add_key:function(h,b){var e=c(this);k.get_script(k.h.static_url("sameas-edit.mf.js"),function(){n.edit.add_key_begin(e,b)});return false},edit_key:function(h,b){var e=c(h).parents(".submenu").data("headmenu").parents(".data-row:first");k.get_script(k.h.static_url("sameas-edit.mf.js"),function(){n.edit.edit_key_begin(e,b)});return false},
delete_key:function(h,b){var e=c(h).parents(".submenu").data("headmenu").parents(".data-row:first");k.get_script(k.h.static_url("sameas-edit.mf.js"),function(){n.edit.delete_key_begin(e,b)});return false}};c(n.init)})(jQuery,window.freebase,window.propbox);
