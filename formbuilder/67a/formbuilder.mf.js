
/*
 * Copyright 2012, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Additional Licenses for Third Party components can be found here:
 * http://wiki.freebase.com/wiki/Freebase_Site_License
 *
 */
/*
 
 jQuery Tools @VERSION / Expose - Dim the lights

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/toolbox/expose.html

 Since: Mar 2010
 Date: @DATE 
 
 jQuery Tools @VERSION Overlay - Overlay base. Extend it.

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/overlay/

 Since: March 2008
 Date: @DATE 
*/
(function(c){function k(){d();c(this).parents(".headmenu").data("submenu").find("a:first").click();return!1}function f(a,e){var b=c(this),f=b.data("menu"),j=b.data("submenu");f.addClass("active");if(!j.is(".submenu-valid")){var f=b.offset(),g=b.outerHeight(),g=f.top+g;j.is(".center")?(b=b.outerWidth(),b=f.left+b/2-j.outerWidth()/2):j.is(".right")?(b=b.outerWidth(),b=f.left+b-j.outerWidth()):b=f.left;b={display:"none",position:"absolute",top:g,left:b};e.overlay&&(b.zIndex=e.overlay.css("zIndex"));
j.css(b);c(document.body).append(j);j.addClass(".submenu-valid")}j.is(":visible")?d(j):(d(),j.fadeIn());return!1}function d(a){a=a||c(".submenu:visible");a.data("menu")&&a.data("menu").removeClass("active");a.hide()}c.factory("nicemenu",{init:function(){var a=this.options;c(".headmenu",this.element).each(function(){var e=c(this),b=e.next(".submenu"),d=e.parents(".nicemenu");e.data("submenu",b);e.data("menu",d);b.data("headmenu",e);b.data("menu",d);c(".default-action",e).click(k);e.click(function(c){return f.apply(this,
[c,a])})});c(".submenu",this.element).click(function(){d(c(this));c(this).fadeOut()})}});c(document).click(function(){d()})})(jQuery);
(function(c){function k(){if(c.browser.msie){var a=c(document).height(),b=c(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,20>a-b?b:a]}return[c(document).width(),c(document).height()]}function f(a){if(a)return a.call(c.mask)}c.tools=c.tools||{version:"@VERSION"};var d;d=c.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff",onLoad:null,
onClose:null}};var a,e,b,h,j;c.mask={load:function(g,l){if(b)return this;"string"==typeof g&&(g={color:g});g=g||h;h=g=c.extend(c.extend({},d.conf),g);a=c("#"+g.maskId);a.length||(a=c("<div/>").attr("id",g.maskId),c("body").append(a));var p=k();a.css({position:"absolute",top:0,left:0,width:p[0],height:p[1],display:"none",opacity:g.startOpacity,zIndex:g.zIndex});g.color&&a.css("backgroundColor",g.color);if(!1===f(g.onBeforeLoad))return this;g.closeOnEsc&&c(document).bind("keydown.mask",function(a){a.keyCode==
27&&c.mask.close(a)});g.closeOnClick&&a.bind("click.mask",function(a){c.mask.close(a)});c(window).bind("resize.mask",function(){c.mask.fit()});l&&l.length&&(j=l.eq(0).css("zIndex"),c.each(l,function(){var a=c(this);/relative|absolute|fixed/i.test(a.css("position"))||a.css("position","relative")}),e=l.css({zIndex:Math.max(g.zIndex+1,"auto"==j?0:j)}));a.css({display:"block"}).fadeTo(g.loadSpeed,g.opacity,function(){c.mask.fit();f(g.onLoad)});b=!0;return this},close:function(){if(b){if(!1===f(h.onBeforeClose))return this;
a.fadeOut(h.closeSpeed,function(){f(h.onClose);e&&e.css({zIndex:j})});c(document).unbind("keydown.mask");a.unbind("click.mask");c(window).unbind("resize.mask");b=!1}return this},fit:function(){if(b){var c=k();a.css({width:c[0],height:c[1]})}},getMask:function(){return a},isLoaded:function(){return b},getConf:function(){return h},getExposed:function(){return e}};c.fn.mask=function(a){c.mask.load(a);return this};c.fn.expose=function(a){c.mask.load(a,this);return this}})(jQuery);
(function(c){function k(a,e){var b=this,h=a.add(b),j=c(window),g,l,k,n=c.tools.expose&&(e.mask||e.expose),o=Math.random().toString().slice(10);n&&("string"==typeof n&&(n={color:n}),n.closeOnClick=n.closeOnEsc=!1);var m=e.target||a.attr("rel");l=m?c(m):a;if(!l.length)throw"Could not find Overlay: "+m;a&&-1==a.index(l)&&a.click(function(c){b.load(c);return c.preventDefault()});c.extend(b,{load:function(a){if(b.isOpened())return b;var g=d[e.effect];if(!g)throw'Overlay: cannot find effect : "'+e.effect+
'"';e.oneInstance&&c.each(f,function(){this.close(a)});a=a||c.Event();a.type="onBeforeLoad";h.trigger(a);if(a.isDefaultPrevented())return b;k=true;n&&c(l).expose(n);var m=e.top,q=e.left,t=l.outerWidth({margin:true}),r=l.outerHeight({margin:true});typeof m=="string"&&(m=m=="center"?Math.max((j.height()-r)/2,0):parseInt(m,10)/100*j.height());q=="center"&&(q=Math.max((j.width()-t)/2,0));g[0].call(b,{top:m,left:q},function(){if(k){a.type="onLoad";h.trigger(a)}});if(n&&e.closeOnClick)c.mask.getMask().one("click",
b.close);e.closeOnClick&&c(document).bind("click."+o,function(i){c(i.target).parents(l).length||b.close(i)});e.closeOnEsc&&c(document).bind("keydown."+o,function(i){i.keyCode==27&&b.close(i)});return b},close:function(a){if(!b.isOpened())return b;a=a||c.Event();a.type="onBeforeClose";h.trigger(a);if(!a.isDefaultPrevented()){k=false;d[e.effect][1].call(b,function(){a.type="onClose";h.trigger(a)});c(document).unbind("click."+o).unbind("keydown."+o);n&&c.mask.close();return b}},getOverlay:function(){return l},
getTrigger:function(){return a},getClosers:function(){return g},isOpened:function(){return k},getConf:function(){return e}});c.each(["onBeforeLoad","onStart","onLoad","onBeforeClose","onClose"],function(a,d){c.isFunction(e[d])&&c(b).bind(d,e[d]);b[d]=function(a){c(b).bind(d,a);return b}});g=l.find(e.close||".close");!g.length&&!e.close&&(g=c('<a class="close"></a>'),l.prepend(g));g.click(function(c){b.close(c)});e.load&&b.load()}c.tools=c.tools||{version:"@VERSION"};c.tools.overlay={addEffect:function(c,
e,b){d[c]=[e,b]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!c.browser.msie||6<c.browser.version,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var f=[],d={};c.tools.overlay.addEffect("default",function(a,d){var b=this.getConf(),f=c(window);b.fixed||(a.top+=f.scrollTop(),a.left+=f.scrollLeft());a.position=b.fixed?"fixed":"absolute";this.getOverlay().css(a).fadeIn(b.speed,d)},function(c){this.getOverlay().fadeOut(this.getConf().closeSpeed,
c)});c.fn.overlay=function(a){var d=this.data("overlay");if(d)return d;c.isFunction(a)&&(a={onBeforeLoad:a});a=c.extend(!0,{},c.tools.overlay.conf,a);this.each(function(){d=new k(c(this),a);f.push(d);c(this).data("overlay",d)});return a.api?d:this}})(jQuery);
(function(c){var k="undefined"!=typeof window.innerWidth?function(){return{w:window.innerWidth,h:window.innerHeight}}:"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?function(){return{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}}:function(){return{w:document.getElementsByTagName("body")[0].clientWidth,h:document.getElementsByTagName("body")[0].clientHeight}};window.kbs=
function(f){c(".kbs.current",f).removeClass("current");var d=c(".domain-section:first",f),a=c(".domain-section:last",f),e=this.scroll_to=function(i){var a=c(document).scrollTop();c(document).height();var d=k().h,d=a+d,b=i.offset().top,i=b+i.height();b<a?c(document).scrollTop(b):i>d&&c(document).scrollTop(a+(i-d))},b=this.get_current=function(){return c(".kbs.current:first",f)},h=this.set_next=function(i,c,a){i=i||b();c.length&&(i.removeClass("current"),c.addClass("current"),a||e(c))},j=this.next_domain=
function(c){var a=b(),d=g(a);d&&(d=d.find(".kbs:first"),h(a,d,c))},g=this._next_domain=function(i){if(!i||!i.length)return c(".domain-section:first",f);i=i.closest(".domain-section");return!i.length||i[0]===a[0]?d:i.next(".domain-section")},l=this.prev_domain=function(){var c=b(),a=p(c);a&&(a=a.find(".kbs:first"),h(c,a))},p=this._prev_domain=function(i){if(!i||!i.length)return c(".domain-section:last",f);var b=i.closest(".domain-section");return i.closest(".property-section").length||i.closest(".type-section").length?
b:!b.length||b[0]===d[0]?a:b.prev(".domain-section")},n=this.next_type=function(){var c=b(),a=o(c);a&&(a=a.find(".kbs:first"),h(c,a))},o=this._next_type=function(a){if(!a||!a.length)return c(".type-section:first",f);var d=a.closest(".domain-section"),a=a.closest(".type-section"),a=a.length?a.next(".type-section"):d.find(".type-section:first");if(!a||!a.length){var b=g(d);if(b)for(;b.get(0)!==d.get(0);){a=b.find(".type-section:first");if(a.length)break;b=g(b)}}return a},m=this.prev_type=function(){var c=
b(),a=s(c);a&&(a=a.find(".kbs:first"),h(c,a))},s=this._prev_type=function(a){if(!a||!a.length)return c(".type-section:last",f);var d=a.closest(".domain-section"),b=a.closest(".type-section");if(a.closest(".property-section").length)return b;var e;b.length&&(e=b.prev(".type-section"));if(!e||!e.length)if(a=p(d))for(;a.get(0)!==d.get(0);){e=a.find(".type-section:last");if(e.length)break;a=p(a)}return e},u=this.next_prop=function(){var a=b(),c=v(a);c&&(c=c.find(".kbs:first"),h(a,c))},v=this._next_prop=
function(a){if(!a||!a.length)return c(".property-section:first",f);var d=a.closest(".domain-section"),b=a.closest(".type-section"),e=a.closest(".property-section"),d=e.length?e.next(".property-section"):b.length?b.find(".property-section:first"):d.find(".property-section:first");if(!d||!d.length)if(a=o(a))for(;a.get(0)!==b.get(0);){d=a.find(".property-section:first");if(d.length)break;null==b.get(0)&&(b=a);a=o(a)}return d},q=this.prev_prop=function(){var a=b(),c=t(a);c&&(c=c.find(".kbs:first"),h(a,
c))},t=this._prev_prop=function(a){if(!a||!a.length)return c(".property-section:last",f);var d=a.closest(".domain-section"),b=a.closest(".type-section"),e=a.closest(".property-section");if(a.closest(".data-section").length)return e;var g;e.length&&(g=e.prev(".property-section"));if(!g||!g.length)if(m=b.length?s(b):s(d))for(;m.get(0)!==b.get(0);){g=m.find(".property-section:last");if(g.length)break;null==b.get(0)&&(b=m);m=s(m)}return g};this.next=function(){var a=b();if(a&&a.length){var d=this._next(a);
if(d){h(a,d);return}}a=c(".kbs:visible:first",f);h(a,a)};this._next=function(b){if(!b||!b.length)return c(".domain-section:first .kbs:first",f);var e=b.closest(".domain-section"),g=b.closest(".type-section"),h=b.closest(".property-section");if(b.closest(".data-section").length){b=b.next(".kbs");if(b.length)return b;b=h.next(".property-section").find(".kbs:first");if(b.length)return b;b=g.next(".type-section").find(".kbs:first")}else if(h.length){b=h.find(".data-section:first .kbs:first");if(b.length)return b;
b=h.next(".property-section").find(".kbs:first");if(b.length)return b;b=g.next(".type-section").find(".kbs:first")}else if(g.length){b=g.find(".property-section:first .kbs:first");if(b.length)return b;b=g.next(".type-section").find(".kbs:first")}else b=e.find(".type-section:first .kbs:first");return b.length?b:e.get(0)===a.get(0)?d.find(".kbs:first"):e.next(".domain-section").find(".kbs:first")};this.prev=function(){var a=b(),c=this._prev(a);c&&h(a,c)};this._prev=function(b){if(!b||!b.length)return b=
c(".data-section:last .kbs:last",f),b.length||(b=c(".property-section:last .kbs:first",f)),b.length||(b=c(".type-section:last .kbs:first",f)),b.length||(b=c(".domain-section:last .kbs:first",f)),b;var e=b.closest(".domain-section"),g=b.closest(".type-section"),h=b.closest(".property-section");return b.closest(".data-section").length?(b=b.prev(".kbs"),b.length?b:h.find(".kbs:first")):h.length?(b=h.prev(".property-section").find(".kbs:last"),b.length?b:g.find(".kbs:first")):g.length?(b=g.prev(".type-section").find(".kbs:last"),
b.length?b:e.find(".kbs:first")):e.get(0)===d.get(0)?a.find(".kbs:last"):e.prev(".domain-section").find(".kbs:last")};this.edit=function(){this.get_current().trigger("edit")};var r=this;c(document).unbind(".kbs").bind("keydown.kbs",function(a){var b=a.target;if(b==document.body||b==document||b==window||b==c("html")[0])b=a.keyCode,68===b?a.shiftKey?l():j():84===b?a.shiftKey?m():n():80===b?a.shiftKey?q():u():74===b?r.next():75===b?r.prev():69===b&&r.edit()})}})(jQuery);
(function(c,k){var f=window.propbox={init:function(d,a){a=c.extend({lang:"/lang/en"},a);if(!a.base_ajax_url)throw Error("base_ajax_url required in propbox options");if(!a.base_static_url)throw Error("base_static_url required in propbox options");if(!a.id)throw Error("topic id required in propbox options");if(!a.lang)throw Error("lang required in propbox options");f.options=a;f.kbs=new k(d);c(".kbs",d).live("click",function(){var a=f.kbs.get_current();f.kbs.set_next(a,c(this),!0)}).live("edit",function(){var a=
c(this).find(".headmenu:first").data("submenu");a&&c("li:first a:first",a).click()});f.init_menus(d);c.tablesorter&&c(".data-table").addClass("table-sortable").tablesorter()},init_menus:function(d,a){d=c(d||document);a&&c(".nicemenu",d).nicemenu();var e;e=d&&d.is(".hover-row")?d:c(".hover-row",d);e.hover(f.row_menu_hoverover,f.row_menu_hoverout);e.dblclick(function(){var a=c(".nicemenu .default-action",this);a.length||(a=c(".nicemenu:first .submenu:first a:first",this));var d=a.attr("href");d&&("#"==
d||0==d.indexOf("javascript:void(0)"))&&c(a).click()});c(".nicemenu .headmenu",d).add(c(".nicemenu .default-action",d)).click("click",function(){if(f.kbs){var a=f.kbs.get_current();a&&f.kbs.set_next(a,c(this).parents(".kbs:first"),!0)}return!1})},row_menu_hoverover:function(){c(this).addClass("row-hover")},row_menu_hoverout:function(){c(this).removeClass("row-hover")},get_script:function(d,a){var e=f.get_script.cache;e||(e=f.get_script.cache={});var b=e[d];b?1===b.state?b.callbacks.push(a):4===b.state&&
a():(b=e[d]={state:0,callbacks:[a]},c.ajax({url:f.options.base_static_url+d,dataType:"script",cache:!0,beforeSend:function(){b.state=1},success:function(){b.state=4;c.each(b.callbacks,function(a,b){b()})},error:function(){b.state=-1}}))},prop_edit:function(d,a){var e=c(d).parents(".property-section");e.length||(e=c(d).parents(".submenu").data("headmenu").parents(".property-section"));e=e.find(".data-section .data-row:first:visible .nicemenu:first .headmenu");e.length?e.data("submenu").find("a:first").click():
f.prop_add(d,a);return!1},prop_add:function(d,a){var e=c(d).parents(".property-section");e.length||(e=c(d).parents(".submenu").data("headmenu").parents(".property-section"));f.get_script("/propbox-edit.mf.js",function(){f.edit.prop_add_begin(e,a)});return!1},value_edit:function(d){var a=c(d).parents(".submenu").data("headmenu").parents(".data-row:first"),e=a.parents(".property-section");f.get_script("/propbox-edit.mf.js",function(){f.edit.value_edit_begin(e,a)});return!1},value_delete:function(d){var a=
c(d).parents(".submenu").data("headmenu").parents(".data-row:first"),e=a.parents(".property-section");f.get_script("/propbox-edit.mf.js",function(){f.edit.value_delete_begin(e,a)});return!1},remove_type:function(d){var d=c(d),a=d.parents(".type-section");f.get_script("/propbox-edit.mf.js",function(){f.edit.remove_type_begin(d,a)});return!1},add_type:function(d,a,e){var d=c(d),b=d.parents(".type-section"),h=f.options.incompatible_types;h?h.search(f.options.id,a,e,{compatible:function(){f.add_type_submit(d,
b)},incompatible:h.overlay_incompatible_callback({onConfirm:function(){f.add_type_submit(d,b)}})}):f.add_type_submit(d,b);return!1},add_type_submit:function(c,a){f.get_script("/propbox-edit.mf.js",function(){f.edit.add_type_submit(c,a)})},add_has_no_value:function(d){var a=c(d).parents(".submenu").data("headmenu").parents(".property-section");f.get_script("/propbox-edit.mf.js",function(){f.edit.add_has_no_value(a)});return!1},add_has_value:function(d){var a=c(d).parents(".submenu").data("headmenu").parents(".property-section");
f.get_script("/propbox-edit.mf.js",function(){f.edit.add_has_value(a)});return!1},add_is_reviewed:function(d){var a=c(d).parents(".submenu").data("headmenu").parents(".property-section");f.get_script("/propbox-edit.mf.js",function(){f.edit.add_is_reviewed(a)});return!1},remove_has_no_value:function(d){var a=c(d).parents(".property-section");f.get_script("/propbox-edit.mf.js",function(){f.edit.remove_has_no_value(a)});return!1},remove_has_value:function(d){var a=c(d).parents(".property-section");f.get_script("/propbox-edit.mf.js",
function(){f.edit.remove_has_value(a)});return!1},more:function(d,a,e,b){var h=c(d).parents(".property-section");f.get_script("/propbox-edit.mf.js",function(){f.edit.more(h,a,e,function(a){c.tablesorter&&a.find(".data-table").toggleClass("table-sortable",!0).tablesorter();b&&b(a)})})},more_and_sort:function(d,a,e,b){c(d).parents(".property-section");f.more(d,e,b,function(d){var j=d.find(".data-table");j.length?j.trigger("sorton",[[[a,0]]]):f.sort_values(c(":first-child",d),a,e,b)})},sort_values:function(d){var d=
c(d).parents(".property-section"),a=d.hasClass("column-header-desc"),e=d.find(".data-list"),b=e.find("li.data-row");b.sort(function(b,d){var e=c(b).find(".property-value").text(),f=c(d).find(".property-value").text();return e.toLowerCase()<f.toLowerCase()?a?1:-1:a?-1:1});e.empty().html(b);d.toggleClass("column-header-desc",!a).toggleClass("column-header-asc",a);f.init_menus(d,!0)}}})(jQuery,window.kbs);
(function(c,k,f){var d=k.formbuilder={init:function(){k.c.header&&c("#header").fadeIn();c(".nicemenu").nicemenu();f.init(null,{id:k.c.id,base_ajax_url:k.h.ajax_url("lib/propbox"),base_static_url:k.h.static_url("lib/propbox"),lang:k.lang||"/lang/en",suggest_impl:k.suggest_options,incompatible_types:k.incompatible_types});c(window).bind("fb.user.signedin",function(a,d){c("#signedin > a:first").text(d.name)})}};c(d.init)})(jQuery,window.freebase,window.propbox);
