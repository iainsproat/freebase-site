
/*
 * Copyright 2012, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Additional Licenses for Third Party components can be found here:
 * http://wiki.freebase.com/wiki/Freebase_Site_License
 *
 */
var CodeMirrorConfig=window.CodeMirrorConfig||{},CodeMirror=function(){function m(a,b){for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c])}function q(a,b){var c=document.createElement("DIV"),d=document.createElement("DIV");c.style.position="absolute";c.style.height="100%";if(c.style.setExpression)try{c.style.setExpression("height","this.previousSibling.offsetHeight + 'px'")}catch(f){}c.style.top="0px";c.style.left="0px";c.style.overflow="hidden";a.appendChild(c);d.className="CodeMirror-line-numbers";
c.appendChild(d);d.innerHTML="<div>"+b+"</div>";return c}function r(a){"string"==typeof a.parserfile&&(a.parserfile=[a.parserfile]);"string"==typeof a.basefiles&&(a.basefiles=[a.basefiles]);"string"==typeof a.stylesheet&&(a.stylesheet=[a.stylesheet]);var b=['<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head>'];b.push('<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>');for(var c=a.stylesheet,d=0;d<c.length;d++)b.push('<link rel="stylesheet" type="text/css" href="'+
c[d]+'"/>');c=a.basefiles.concat(a.parserfile);for(d=0;d<c.length;d++){var f=c[d];/^https?:/.test(f)||(f=a.path+f);b.push('<script type="text/javascript" src="'+f+(a.noScriptCaching?"?nocache="+(new Date).getTime().toString(16):"")+'"><\/script>')}b.push('</head><body style="border-width: 0;" class="editbox" spellcheck="'+(a.disableSpellcheck?"false":"true")+'"></body></html>');return b.join("")}function h(a,b){this.options=b=b||{};m(b,CodeMirrorConfig);b.dumbTabs?b.tabMode="spaces":b.normalTab&&
(b.tabMode="default");var c=this.frame=document.createElement("IFRAME");b.iframeClass&&(c.className=b.iframeClass);c.frameBorder=0;c.style.border="0";c.style.width="100%";c.style.height="100%";c.style.display="block";var d=this.wrapping=document.createElement("DIV");d.style.position="relative";d.className="CodeMirror-wrapping";d.style.width=b.width;d.style.height="dynamic"==b.height?b.minHeight+"px":b.height;var f=this.textareaHack=document.createElement("TEXTAREA");d.appendChild(f);f.style.position=
"absolute";f.style.left="-10000px";f.style.width="10px";c.CodeMirror=this;b.domain&&s?(this.html=r(b),c.src="javascript:(function(){document.open();"+(b.domain?'document.domain="'+b.domain+'";':"")+"document.write(window.frameElement.CodeMirror.html);document.close();})()"):c.src="javascript:;";a.appendChild?a.appendChild(d):a(d);d.appendChild(c);b.lineNumbers&&(this.lineNumbers=q(d,b.firstLineNumber));this.win=c.contentWindow;if(!b.domain||!s)this.win.document.open(),this.win.document.write(r(b)),
this.win.document.close()}m(CodeMirrorConfig,{stylesheet:[],path:"",parserfile:[],basefiles:"util.js stringstream.js select.js undo.js editor.js tokenize.js".split(" "),iframeClass:null,passDelay:200,passTime:50,lineNumberDelay:200,lineNumberTime:50,continuousScanning:!1,saveFunction:null,onChange:null,undoDepth:50,undoDelay:800,disableSpellcheck:!0,textWrapping:!0,readOnly:!1,width:"",height:"300px",minHeight:100,autoMatchParens:!1,parserConfig:null,tabMode:"indent",enterMode:"indent",electricChars:!0,
reindentOnLoad:!1,activeTokens:null,cursorActivity:null,lineNumbers:!1,firstLineNumber:1,indentUnit:2,domain:null,noScriptCaching:!1});var s=document.selection&&window.ActiveXObject&&/MSIE/.test(navigator.userAgent);h.prototype={init:function(){this.options.initCallback&&this.options.initCallback(this);this.options.lineNumbers&&this.activateLineNumbers();this.options.reindentOnLoad&&this.reindent();"dynamic"==this.options.height&&this.setDynamicHeight()},getCode:function(){return this.editor.getCode()},
setCode:function(a){this.editor.importCode(a)},selection:function(){this.focusIfIE();return this.editor.selectedText()},reindent:function(){this.editor.reindent()},reindentSelection:function(){this.focusIfIE();this.editor.reindentSelection(null)},focusIfIE:function(){this.win.select.ie_selection&&this.focus()},focus:function(){this.win.focus();this.editor.selectionSnapshot&&this.win.select.setBookmark(this.win.document.body,this.editor.selectionSnapshot)},replaceSelection:function(a){this.focus();
this.editor.replaceSelection(a);return!0},replaceChars:function(a,b,c){this.editor.replaceChars(a,b,c)},getSearchCursor:function(a,b,c){return this.editor.getSearchCursor(a,b,c)},undo:function(){this.editor.history.undo()},redo:function(){this.editor.history.redo()},historySize:function(){return this.editor.history.historySize()},clearHistory:function(){this.editor.history.clear()},grabKeys:function(a,b){this.editor.grabKeys(a,b)},ungrabKeys:function(){this.editor.ungrabKeys()},setParser:function(a,
b){this.editor.setParser(a,b)},setSpellcheck:function(a){this.win.document.body.spellcheck=a},setStylesheet:function(a){"string"===typeof a&&(a=[a]);for(var b={},c={},d=this.win.document.getElementsByTagName("link"),f=0,e;e=d[f];f++)if(-1!==e.rel.indexOf("stylesheet"))for(var g=0;g<a.length;g++){var i=a[g];e.href.substring(e.href.length-i.length)===i&&(b[e.href]=!0,c[i]=!0)}for(f=0;e=d[f];f++)-1!==e.rel.indexOf("stylesheet")&&(e.disabled=!(e.href in b));for(g=0;g<a.length;g++)i=a[g],i in c||(e=this.win.document.createElement("link"),
e.rel="stylesheet",e.type="text/css",e.href=i,this.win.document.getElementsByTagName("head")[0].appendChild(e))},setTextWrapping:function(a){a!=this.options.textWrapping&&(this.win.document.body.style.whiteSpace=a?"":"nowrap",this.options.textWrapping=a,this.lineNumbers&&(this.setLineNumbers(!1),this.setLineNumbers(!0)))},setIndentUnit:function(a){this.win.indentUnit=a},setUndoDepth:function(a){this.editor.history.maxDepth=a},setTabMode:function(a){this.options.tabMode=a},setEnterMode:function(a){this.options.enterMode=
a},setLineNumbers:function(a){a&&!this.lineNumbers?(this.lineNumbers=q(this.wrapping,this.options.firstLineNumber),this.activateLineNumbers()):!a&&this.lineNumbers&&(this.wrapping.removeChild(this.lineNumbers),this.wrapping.style.paddingLeft="",this.lineNumbers=null)},cursorPosition:function(a){this.focusIfIE();return this.editor.cursorPosition(a)},firstLine:function(){return this.editor.firstLine()},lastLine:function(){return this.editor.lastLine()},nextLine:function(a){return this.editor.nextLine(a)},
prevLine:function(a){return this.editor.prevLine(a)},lineContent:function(a){return this.editor.lineContent(a)},setLineContent:function(a,b){this.editor.setLineContent(a,b)},removeLine:function(a){this.editor.removeLine(a)},insertIntoLine:function(a,b,c){this.editor.insertIntoLine(a,b,c)},selectLines:function(a,b,c,d){this.win.focus();this.editor.selectLines(a,b,c,d)},nthLine:function(a){for(var b=this.firstLine();1<a&&!1!==b;a--)b=this.nextLine(b);return b},lineNumber:function(a){for(var b=0;!1!==
a;)b++,a=this.prevLine(a);return b},jumpToLine:function(a){"number"==typeof a&&(a=this.nthLine(a));this.selectLines(a,0);this.win.focus()},currentLine:function(){return this.lineNumber(this.cursorLine())},cursorLine:function(){return this.cursorPosition().line},cursorCoords:function(a){return this.editor.cursorCoords(a)},activateLineNumbers:function(){function a(){if(0!=e.offsetWidth){for(var a=e;a.parentNode;a=a.parentNode);if(!l.parentNode||a!=document||!g.Editor){try{u()}catch(b){}clearInterval(m)}else l.offsetWidth!=
h&&(h=l.offsetWidth,e.parentNode.style.paddingLeft=h+"px")}}function b(){l.scrollTop=t.scrollTop||i.documentElement.scrollTop||0}function c(a){var b=n.firstChild.offsetHeight;if(0!=b)for(var c=50+Math.max(t.offsetHeight,Math.max(e.offsetHeight,t.scrollHeight||0)),b=Math.ceil(c/b),c=n.childNodes.length;c<=b;c++){var d=document.createElement("DIV");d.appendChild(document.createTextNode(a?String(c+j.options.firstLineNumber):"\u00a0"));n.appendChild(d)}}function d(){function a(){c(!0);b()}j.updateNumbers=
a;var d=g.addEventHandler(g,"scroll",b,!0),e=g.addEventHandler(g,"resize",a,!0);u=function(){d();e();j.updateNumbers==a&&(j.updateNumbers=null)};a()}function f(){function a(b,c){h||(h=n.appendChild(document.createElement("DIV")));q&&q(h,c,b);o.push(h);o.push(b);m=h.offsetHeight+h.offsetTop;h=h.nextSibling}function d(){for(var a=0;a<o.length;a+=2)o[a].innerHTML=o[a+1];o=[]}function e(){if(n.parentNode&&n.parentNode==j.lineNumbers){for(var c=(new Date).getTime()+j.options.lineNumberTime;k;){for(a(i++,
k.previousSibling);k&&!g.isBR(k);k=k.nextSibling)for(var f=k.offsetTop+k.offsetHeight;n.offsetHeight&&f-3>m;)a("&nbsp;");k&&(k=k.nextSibling);if((new Date).getTime()>c){d();p=setTimeout(e,j.options.lineNumberDelay);return}}for(;h;)a(i++);d();b()}}function f(a){b();c(a);k=t.firstChild;h=n.firstChild;m=0;i=j.options.firstLineNumber;e()}function l(){p&&clearTimeout(p);j.editor.allClean()?f():p=setTimeout(l,200)}var k,h,i,m,o=[],q=j.options.styleNumbers;f(!0);var p=null;j.updateNumbers=l;var r=g.addEventHandler(g,
"scroll",b,!0),s=g.addEventHandler(g,"resize",l,!0);u=function(){p&&clearTimeout(p);j.updateNumbers==l&&(j.updateNumbers=null);r();s()}}var e=this.frame,g=e.contentWindow,i=g.document,t=i.body,l=this.lineNumbers,n=l.firstChild,j=this,h=null,u=function(){};a();var m=setInterval(a,500);(this.options.textWrapping||this.options.styleNumbers?f:d)()},setDynamicHeight:function(){function a(){for(var a=0,c=f.lastChild,g;c&&d.isBR(c);)c.hackBR||a++,c=c.previousSibling;c?(e=c.offsetHeight,g=c.offsetTop+(1+
a)*e):e&&(g=a*e);g&&(b.wrapping.style.height=Math.max(h+g,b.options.minHeight)+"px")}var b=this,c=b.options.cursorActivity,d=b.win,f=d.document.body,e=null,g=null,h=2*b.frame.offsetTop;f.style.overflowY="hidden";d.document.documentElement.style.overflowY="hidden";this.frame.scrolling="no";setTimeout(a,300);b.options.cursorActivity=function(b){c&&c(b);clearTimeout(g);g=setTimeout(a,100)}}};h.InvalidLineHandle={toString:function(){return"CodeMirror.InvalidLineHandle"}};h.replace=function(a){"string"==
typeof a&&(a=document.getElementById(a));return function(b){a.parentNode.replaceChild(b,a)}};h.fromTextArea=function(a,b){"string"==typeof a&&(a=document.getElementById(a));b=b||{};a.style.width&&null==b.width&&(b.width=a.style.width);a.style.height&&null==b.height&&(b.height=a.style.height);null==b.content&&(b.content=a.value);if(a.form){var c=function(){a.value=e.getCode()};"function"==typeof a.form.addEventListener?a.form.addEventListener("submit",c,!1):a.form.attachEvent("onsubmit",c);var d=a.form.submit,
f=function(){c();a.form.submit=d;a.form.submit();a.form.submit=f};a.form.submit=f}a.style.display="none";var e=new h(function(b){a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b)},b);e.toTextArea=function(){c();a.parentNode.removeChild(e.wrapping);a.style.display="";if(a.form){a.form.submit=d;typeof a.form.removeEventListener=="function"?a.form.removeEventListener("submit",c,false):a.form.detachEvent("onsubmit",c)}};return e};h.isProbablySupported=function(){var a;
return window.opera?9.52<=Number(window.opera.version()):/Apple Computer, Inc/.test(navigator.vendor)&&(a=navigator.userAgent.match(/Version\/(\d+(?:\.\d+)?)\./))?3<=Number(a[1]):document.selection&&window.ActiveXObject&&(a=navigator.userAgent.match(/MSIE (\d+(?:\.\d*)?)\b/))?6<=Number(a[1]):(a=navigator.userAgent.match(/gecko\/(\d{8})/i))?20050901<=Number(a[1]):(a=navigator.userAgent.match(/AppleWebKit\/(\d+)/))?525<=Number(a[1]):null};return h}();
