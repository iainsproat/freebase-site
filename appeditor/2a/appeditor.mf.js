
/*
 * Copyright 2010, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Additional Licenses for Third Party components can be found here:
 * http://wiki.freebase.com/wiki/Freebase_Site_License
 *
 */
/*
 
 jQuery Tools @VERSION Tabs- The basics of UI design.

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/tabs/

 Since: November 2008
 Date: @DATE 
*/
(function(e){function b(m,n,i){var q=this,f=m.add(this),g=m.find(i.tabs),s=n.jquery?n:m.children(n),d;g.length||(g=m.children());s.length||(s=m.parent().find(n));s.length||(s=e(n));e.extend(this,{click:function(c,p){var h=g.eq(c);if(typeof c=="string"&&c.replace("#","")){c=c.replace(/([\"\#\$\%\&\'\(\)\*\+\,\.\/\:\;\<\=\>\?\@\[\\\]\^\`\{\|\}\~])/g,"\\$1");h=g.filter("[href*="+c.replace("#","")+"]");c=Math.max(g.index(h),0)}if(i.rotate){var j=g.length-1;if(c<0)return q.click(j,p);if(c>j)return q.click(0,
p)}if(!h.length){if(d>=0)return q;c=i.initialIndex;h=g.eq(c)}if(c===d)return q;p=p||e.Event();p.type="onBeforeClick";f.trigger(p,[c]);if(!p.isDefaultPrevented()){l[i.effect].call(q,c,function(){p.type="onClick";f.trigger(p,[c])});d=c;g.removeClass(i.current);h.addClass(i.current);return q}},getConf:function(){return i},getTabs:function(){return g},getPanes:function(){return s},getCurrentPane:function(){return s.eq(d)},getCurrentTab:function(){return g.eq(d)},getIndex:function(){return d},next:function(){return q.click(d+
1)},prev:function(){return q.click(d-1)},destroy:function(){g.unbind(i.event).removeClass(i.current);s.find("a[href^=#]").unbind("click.T");return q}});e.each("onBeforeClick,onClick".split(","),function(c,p){e.isFunction(i[p])&&e(q).bind(p,i[p]);q[p]=function(h){e(q).bind(p,h);return q}});if(i.history&&e.fn.history){e.tools.history.init(g);i.event="history"}g.each(function(c){e(this).bind(i.event,function(p){q.click(c,p);return p.preventDefault()})});s.find("a[href^=#]").bind("click.T",function(c){q.click(e(this).attr("href"),
c)});if(location.hash)q.click(location.hash);else if(i.initialIndex===0||i.initialIndex>0)q.click(i.initialIndex)}e.tools=e.tools||{version:"@VERSION"};e.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialIndex:0,event:"click",rotate:false,history:false},addEffect:function(m,n){l[m]=n}};var l={"default":function(m,n){this.getPanes().hide().eq(m).show();n.call()},fade:function(m,n){var i=this.getConf(),q=i.fadeOutSpeed,f=this.getPanes();q?f.fadeOut(q):
f.hide();f.eq(m).fadeIn(i.fadeInSpeed,n)},slide:function(m,n){this.getPanes().slideUp(200);this.getPanes().eq(m).slideDown(400,n)},ajax:function(m,n){this.getPanes().eq(0).load(this.getTabs().eq(m).attr("href"),n)}},a;e.tools.tabs.addEffect("horizontal",function(m,n){a||(a=this.getPanes().eq(0).width());this.getCurrentPane().animate({width:0},function(){e(this).hide()});this.getPanes().eq(m).animate({width:a},function(){e(this).show();n.call()})});e.fn.tabs=function(m,n){var i=this.data("tabs");if(i){i.destroy();
this.removeData("tabs")}if(e.isFunction(n))n={onBeforeClick:n};n=e.extend({},e.tools.tabs.conf,n);this.each(function(){i=new b(e(this),m,n);e(this).data("tabs",i)});return n.api?i:this}})(jQuery);
(function(e,b){function l(a){return!e(a).parents().andSelf().filter(function(){return e.curCSS(this,"visibility")==="hidden"||e.expr.filters.hidden(this)}).length}e.ui=e.ui||{};if(!e.ui.version){e.extend(e.ui,{version:"1.8.10",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});e.fn.extend({_focus:e.fn.focus,focus:function(a,m){return typeof a==="number"?this.each(function(){var n=this;setTimeout(function(){e(n).focus();m&&m.call(n)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.curCSS(this,
"position",1))&&/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?e(document):a},zIndex:function(a){if(a!==b)return this.css("zIndex",a);if(this.length){a=e(this[0]);for(var m;a.length&&a[0]!==document;){m=a.css("position");
if(m==="absolute"||m==="relative"||m==="fixed"){m=parseInt(a.css("zIndex"),10);if(!isNaN(m)&&m!==0)return m}a=a.parent()}}return 0},disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});e.each(["Width","Height"],function(a,m){function n(g,s,d,c){e.each(i,function(){s-=parseFloat(e.curCSS(g,"padding"+this,true))||0;if(d)s-=parseFloat(e.curCSS(g,
"border"+this+"Width",true))||0;if(c)s-=parseFloat(e.curCSS(g,"margin"+this,true))||0});return s}var i=m==="Width"?["Left","Right"]:["Top","Bottom"],q=m.toLowerCase(),f={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+m]=function(g){if(g===b)return f["inner"+m].call(this);return this.each(function(){e(this).css(q,n(this,g)+"px")})};e.fn["outer"+m]=function(g,s){if(typeof g!=="number")return f["outer"+m].call(this,g);return this.each(function(){e(this).css(q,
n(this,g,true,s)+"px")})}});e.extend(e.expr[":"],{data:function(a,m,n){return!!e.data(a,n[3])},focusable:function(a){var m=a.nodeName.toLowerCase(),n=e.attr(a,"tabindex");if("area"===m){m=a.parentNode;n=m.name;if(!a.href||!n||m.nodeName.toLowerCase()!=="map")return false;a=e("img[usemap=#"+n+"]")[0];return!!a&&l(a)}return(/input|select|textarea|button|object/.test(m)?!a.disabled:"a"==m?a.href||!isNaN(n):!isNaN(n))&&l(a)},tabbable:function(a){var m=e.attr(a,"tabindex");return(isNaN(m)||m>=0)&&e(a).is(":focusable")}});
e(function(){var a=document.body,m=a.appendChild(m=document.createElement("div"));e.extend(m.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});e.support.minHeight=m.offsetHeight===100;e.support.selectstart="onselectstart"in m;a.removeChild(m).style.display="none"});e.extend(e.ui,{plugin:{add:function(a,m,n){a=e.ui[a].prototype;for(var i in n){a.plugins[i]=a.plugins[i]||[];a.plugins[i].push([m,n[i]])}},call:function(a,m,n){if((m=a.plugins[m])&&a.element[0].parentNode)for(var i=0;i<m.length;i++)a.options[m[i][0]]&&
m[i][1].apply(a.element,n)}},contains:function(a,m){return document.compareDocumentPosition?a.compareDocumentPosition(m)&16:a!==m&&a.contains(m)},hasScroll:function(a,m){if(e(a).css("overflow")==="hidden")return false;var n=m&&m==="left"?"scrollLeft":"scrollTop",i=false;if(a[n]>0)return true;a[n]=1;i=a[n]>0;a[n]=0;return i},isOverAxis:function(a,m,n){return a>m&&a<m+n},isOver:function(a,m,n,i,q,f){return e.ui.isOverAxis(a,n,q)&&e.ui.isOverAxis(m,i,f)}})}})(jQuery);
(function(e,b){if(e.cleanData){var l=e.cleanData;e.cleanData=function(m){for(var n=0,i;(i=m[n])!=null;n++)e(i).triggerHandler("remove");l(m)}}else{var a=e.fn.remove;e.fn.remove=function(m,n){return this.each(function(){if(!n)if(!m||e.filter(m,[this]).length)e("*",this).add([this]).each(function(){e(this).triggerHandler("remove")});return a.call(e(this),m,n)})}}e.widget=function(m,n,i){var q=m.split(".")[0],f;m=m.split(".")[1];f=q+"-"+m;if(!i){i=n;n=e.Widget}e.expr[":"][f]=function(g){return!!e.data(g,
m)};e[q]=e[q]||{};e[q][m]=function(g,s){arguments.length&&this._createWidget(g,s)};n=new n;n.options=e.extend(true,{},n.options);e[q][m].prototype=e.extend(true,n,{namespace:q,widgetName:m,widgetEventPrefix:e[q][m].prototype.widgetEventPrefix||m,widgetBaseClass:f},i);e.widget.bridge(m,e[q][m])};e.widget.bridge=function(m,n){e.fn[m]=function(i){var q=typeof i==="string",f=Array.prototype.slice.call(arguments,1),g=this;i=!q&&f.length?e.extend.apply(null,[true,i].concat(f)):i;if(q&&i.charAt(0)==="_")return g;
q?this.each(function(){var s=e.data(this,m),d=s&&e.isFunction(s[i])?s[i].apply(s,f):s;if(d!==s&&d!==b){g=d;return false}}):this.each(function(){var s=e.data(this,m);s?s.option(i||{})._init():e.data(this,m,new n(i,this))});return g}};e.Widget=function(m,n){arguments.length&&this._createWidget(m,n)};e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(m,n){e.data(n,this.widgetName,this);this.element=e(n);this.options=e.extend(true,{},this.options,
this._getCreateOptions(),m);var i=this;this.element.bind("remove."+this.widgetName,function(){i.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},
widget:function(){return this.element},option:function(m,n){var i=m;if(arguments.length===0)return e.extend({},this.options);if(typeof m==="string"){if(n===b)return this.options[m];i={};i[m]=n}this._setOptions(i);return this},_setOptions:function(m){var n=this;e.each(m,function(i,q){n._setOption(i,q)});return this},_setOption:function(m,n){this.options[m]=n;if(m==="disabled")this.widget()[n?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",n);return this},
enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(m,n,i){var q=this.options[m];n=e.Event(n);n.type=(m===this.widgetEventPrefix?m:this.widgetEventPrefix+m).toLowerCase();i=i||{};if(n.originalEvent){m=e.event.props.length;for(var f;m;){f=e.event.props[--m];n[f]=n.originalEvent[f]}}this.element.trigger(n,i);return!(e.isFunction(q)&&q.call(this.element[0],n,i)===false||n.isDefaultPrevented())}}})(jQuery);
(function(e){e.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(l){return b._mouseDown(l)}).bind("click."+this.widgetName,function(l){if(true===e.data(l.target,b.widgetName+".preventClickEvent")){e.removeData(l.target,b.widgetName+".preventClickEvent");l.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(b){b.originalEvent=
b.originalEvent||{};if(!b.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(b);this._mouseDownEvent=b;var l=this,a=b.which==1,m=typeof this.options.cancel=="string"?e(b.target).parents().add(b.target).filter(this.options.cancel).length:false;if(!a||m||!this._mouseCapture(b))return true;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){l.mouseDelayMet=true},this.options.delay);if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=
this._mouseStart(b)!==false;if(!this._mouseStarted){b.preventDefault();return true}}this._mouseMoveDelegate=function(n){return l._mouseMove(n)};this._mouseUpDelegate=function(n){return l._mouseUp(n)};e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);b.preventDefault();return b.originalEvent.mouseHandled=true}},_mouseMove:function(b){if(e.browser.msie&&!(document.documentMode>=9)&&!b.button)return this._mouseUp(b);if(this._mouseStarted){this._mouseDrag(b);
return b.preventDefault()}if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b))(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==false)?this._mouseDrag(b):this._mouseUp(b);return!this._mouseStarted},_mouseUp:function(b){e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;b.target==this._mouseDownEvent.target&&e.data(b.target,this.widgetName+".preventClickEvent",
true);this._mouseStop(b)}return false},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
(function(e){e.ui=e.ui||{};var b=/left|center|right/,l=/top|center|bottom/,a=e.fn.position,m=e.fn.offset;e.fn.position=function(n){if(!n||!n.of)return a.apply(this,arguments);n=e.extend({},n);var i=e(n.of),q=i[0],f=(n.collision||"flip").split(" "),g=n.offset?n.offset.split(" "):[0,0],s,d,c;if(q.nodeType===9){s=i.width();d=i.height();c={top:0,left:0}}else if(q.setTimeout){s=i.width();d=i.height();c={top:i.scrollTop(),left:i.scrollLeft()}}else if(q.preventDefault){n.at="left top";s=d=0;c={top:n.of.pageY,
left:n.of.pageX}}else{s=i.outerWidth();d=i.outerHeight();c=i.offset()}e.each(["my","at"],function(){var p=(n[this]||"").split(" ");if(p.length===1)p=b.test(p[0])?p.concat(["center"]):l.test(p[0])?["center"].concat(p):["center","center"];p[0]=b.test(p[0])?p[0]:"center";p[1]=l.test(p[1])?p[1]:"center";n[this]=p});if(f.length===1)f[1]=f[0];g[0]=parseInt(g[0],10)||0;if(g.length===1)g[1]=g[0];g[1]=parseInt(g[1],10)||0;if(n.at[0]==="right")c.left+=s;else if(n.at[0]==="center")c.left+=s/2;if(n.at[1]==="bottom")c.top+=
d;else if(n.at[1]==="center")c.top+=d/2;c.left+=g[0];c.top+=g[1];return this.each(function(){var p=e(this),h=p.outerWidth(),j=p.outerHeight(),o=parseInt(e.curCSS(this,"marginLeft",true))||0,r=parseInt(e.curCSS(this,"marginTop",true))||0,t=h+o+(parseInt(e.curCSS(this,"marginRight",true))||0),u=j+r+(parseInt(e.curCSS(this,"marginBottom",true))||0),x=e.extend({},c),C;if(n.my[0]==="right")x.left-=h;else if(n.my[0]==="center")x.left-=h/2;if(n.my[1]==="bottom")x.top-=j;else if(n.my[1]==="center")x.top-=
j/2;x.left=Math.round(x.left);x.top=Math.round(x.top);C={left:x.left-o,top:x.top-r};e.each(["left","top"],function(w,A){e.ui.position[f[w]]&&e.ui.position[f[w]][A](x,{targetWidth:s,targetHeight:d,elemWidth:h,elemHeight:j,collisionPosition:C,collisionWidth:t,collisionHeight:u,offset:g,my:n.my,at:n.at})});e.fn.bgiframe&&p.bgiframe();p.offset(e.extend(x,{using:n.using}))})};e.ui.position={fit:{left:function(n,i){var q=e(window);q=i.collisionPosition.left+i.collisionWidth-q.width()-q.scrollLeft();n.left=
q>0?n.left-q:Math.max(n.left-i.collisionPosition.left,n.left)},top:function(n,i){var q=e(window);q=i.collisionPosition.top+i.collisionHeight-q.height()-q.scrollTop();n.top=q>0?n.top-q:Math.max(n.top-i.collisionPosition.top,n.top)}},flip:{left:function(n,i){if(i.at[0]!=="center"){var q=e(window);q=i.collisionPosition.left+i.collisionWidth-q.width()-q.scrollLeft();var f=i.my[0]==="left"?-i.elemWidth:i.my[0]==="right"?i.elemWidth:0,g=i.at[0]==="left"?i.targetWidth:-i.targetWidth,s=-2*i.offset[0];n.left+=
i.collisionPosition.left<0?f+g+s:q>0?f+g+s:0}},top:function(n,i){if(i.at[1]!=="center"){var q=e(window);q=i.collisionPosition.top+i.collisionHeight-q.height()-q.scrollTop();var f=i.my[1]==="top"?-i.elemHeight:i.my[1]==="bottom"?i.elemHeight:0,g=i.at[1]==="top"?i.targetHeight:-i.targetHeight,s=-2*i.offset[1];n.top+=i.collisionPosition.top<0?f+g+s:q>0?f+g+s:0}}}};if(!e.offset.setOffset){e.offset.setOffset=function(n,i){if(/static/.test(e.curCSS(n,"position")))n.style.position="relative";var q=e(n),
f=q.offset(),g=parseInt(e.curCSS(n,"top",true),10)||0,s=parseInt(e.curCSS(n,"left",true),10)||0;f={top:i.top-f.top+g,left:i.left-f.left+s};"using"in i?i.using.call(n,f):q.css(f)};e.fn.offset=function(n){var i=this[0];if(!i||!i.ownerDocument)return null;if(n)return this.each(function(){e.offset.setOffset(this,n)});return m.call(this)}}})(jQuery);
(function(e){e.widget("ui.draggable",e.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper==
"original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(b){var l=
this.options;if(this.helper||l.disabled||e(b.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(b);if(!this.handle)return false;return true},_mouseStart:function(b){var l=this.options;this.helper=this._createHelper(b);this._cacheHelperProportions();if(e.ui.ddmanager)e.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-
this.margins.top,left:this.offset.left-this.margins.left};e.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;l.cursorAt&&this._adjustOffsetFromHelper(l.cursorAt);l.containment&&this._setContainment();if(this._trigger("start",b)===false){this._clear();return false}this._cacheHelperProportions();
e.ui.ddmanager&&!l.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,b);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(b,true);return true},_mouseDrag:function(b,l){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!l){var a=this._uiHash();if(this._trigger("drag",b,a)===false){this._mouseUp({});return false}this.position=a.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||
this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";e.ui.ddmanager&&e.ui.ddmanager.drag(this,b);return false},_mouseStop:function(b){var l=false;if(e.ui.ddmanager&&!this.options.dropBehaviour)l=e.ui.ddmanager.drop(this,b);if(this.dropped){l=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!l||this.options.revert=="valid"&&l||this.options.revert===true||e.isFunction(this.options.revert)&&
this.options.revert.call(this.element,l)){var a=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){a._trigger("stop",b)!==false&&a._clear()})}else this._trigger("stop",b)!==false&&this._clear();return false},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var l=!this.options.handle||!e(this.options.handle,this.element).length?true:false;e(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==
b.target)l=true});return l},_createHelper:function(b){var l=this.options;b=e.isFunction(l.helper)?e(l.helper.apply(this.element[0],[b])):l.helper=="clone"?this.element.clone():this.element;b.parents("body").length||b.appendTo(l.appendTo=="parent"?this.element[0].parentNode:l.appendTo);b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute");return b},_adjustOffsetFromHelper:function(b){if(typeof b=="string")b=b.split(" ");if(e.isArray(b))b={left:+b[0],top:+b[1]||
0};if("left"in b)this.offset.click.left=b.left+this.margins.left;if("right"in b)this.offset.click.left=this.helperProportions.width-b.right+this.margins.left;if("top"in b)this.offset.click.top=b.top+this.margins.top;if("bottom"in b)this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],
this.offsetParent[0])){b.left+=this.scrollParent.scrollLeft();b.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var b=this.element.position();return{top:b.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;if(b.containment==
"parent")b.containment=this.helper[0].parentNode;if(b.containment=="document"||b.containment=="window")this.containment=[(b.containment=="document"?0:e(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(b.containment=="document"?0:e(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:e(window).scrollLeft())+e(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?
0:e(window).scrollTop())+(e(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var l=e(b.containment)[0];if(l){b=e(b.containment).offset();var a=e(l).css("overflow")!="hidden";this.containment=[b.left+(parseInt(e(l).css("borderLeftWidth"),10)||0)+(parseInt(e(l).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(e(l).css("borderTopWidth"),
10)||0)+(parseInt(e(l).css("paddingTop"),10)||0)-this.margins.top,b.left+(a?Math.max(l.scrollWidth,l.offsetWidth):l.offsetWidth)-(parseInt(e(l).css("borderLeftWidth"),10)||0)-(parseInt(e(l).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(a?Math.max(l.scrollHeight,l.offsetHeight):l.offsetHeight)-(parseInt(e(l).css("borderTopWidth"),10)||0)-(parseInt(e(l).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}}else if(b.containment.constructor==
Array)this.containment=b.containment},_convertPositionTo:function(b,l){if(!l)l=this.position;var a=b=="absolute"?1:-1,m=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,n=/(html|body)/i.test(m[0].tagName);return{top:l.top+this.offset.relative.top*a+this.offset.parent.top*a-(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():
n?0:m.scrollTop())*a),left:l.left+this.offset.relative.left*a+this.offset.parent.left*a-(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():n?0:m.scrollLeft())*a)}},_generatePosition:function(b){var l=this.options,a=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,m=/(html|body)/i.test(a[0].tagName),n=b.pageX,i=b.pageY;
if(this.originalPosition){if(this.containment){if(b.pageX-this.offset.click.left<this.containment[0])n=this.containment[0]+this.offset.click.left;if(b.pageY-this.offset.click.top<this.containment[1])i=this.containment[1]+this.offset.click.top;if(b.pageX-this.offset.click.left>this.containment[2])n=this.containment[2]+this.offset.click.left;if(b.pageY-this.offset.click.top>this.containment[3])i=this.containment[3]+this.offset.click.top}if(l.grid){i=this.originalPageY+Math.round((i-this.originalPageY)/
l.grid[1])*l.grid[1];i=this.containment?!(i-this.offset.click.top<this.containment[1]||i-this.offset.click.top>this.containment[3])?i:!(i-this.offset.click.top<this.containment[1])?i-l.grid[1]:i+l.grid[1]:i;n=this.originalPageX+Math.round((n-this.originalPageX)/l.grid[0])*l.grid[0];n=this.containment?!(n-this.offset.click.left<this.containment[0]||n-this.offset.click.left>this.containment[2])?n:!(n-this.offset.click.left<this.containment[0])?n-l.grid[0]:n+l.grid[0]:n}}return{top:i-this.offset.click.top-
this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():m?0:a.scrollTop()),left:n-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&e.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():m?0:a.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=
this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(b,l,a){a=a||this._uiHash();e.ui.plugin.call(this,b,[l,a]);if(b=="drag")this.positionAbs=this._convertPositionTo("absolute");return e.Widget.prototype._trigger.call(this,b,l,a)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});e.extend(e.ui.draggable,{version:"1.8.10"});e.ui.plugin.add("draggable",
"connectToSortable",{start:function(b,l){var a=e(this).data("draggable"),m=a.options,n=e.extend({},l,{item:a.element});a.sortables=[];e(m.connectToSortable).each(function(){var i=e.data(this,"sortable");if(i&&!i.options.disabled){a.sortables.push({instance:i,shouldRevert:i.options.revert});i._refreshItems();i._trigger("activate",b,n)}})},stop:function(b,l){var a=e(this).data("draggable"),m=e.extend({},l,{item:a.element});e.each(a.sortables,function(){if(this.instance.isOver){this.instance.isOver=
0;a.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(b);this.instance.options.helper=this.instance.options._helper;a.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",b,m)}})},drag:function(b,l){var a=e(this).data("draggable"),m=this;e.each(a.sortables,function(){this.instance.positionAbs=
a.positionAbs;this.instance.helperProportions=a.helperProportions;this.instance.offset.click=a.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=e(m).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return l.helper[0]};b.target=this.instance.currentItem[0];this.instance._mouseCapture(b,
true);this.instance._mouseStart(b,true,true);this.instance.offset.click.top=a.offset.click.top;this.instance.offset.click.left=a.offset.click.left;this.instance.offset.parent.left-=a.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=a.offset.parent.top-this.instance.offset.parent.top;a._trigger("toSortable",b);a.dropped=this.instance.element;a.currentItem=a.element;this.instance.fromOutside=a}this.instance.currentItem&&this.instance._mouseDrag(b)}else if(this.instance.isOver){this.instance.isOver=
0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",b,this.instance._uiHash(this.instance));this.instance._mouseStop(b,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();a._trigger("fromSortable",b);a.dropped=false}})}});e.ui.plugin.add("draggable","cursor",{start:function(){var b=e("body"),l=e(this).data("draggable").options;if(b.css("cursor"))l._cursor=
b.css("cursor");b.css("cursor",l.cursor)},stop:function(){var b=e(this).data("draggable").options;b._cursor&&e("body").css("cursor",b._cursor)}});e.ui.plugin.add("draggable","iframeFix",{start:function(){var b=e(this).data("draggable").options;e(b.iframeFix===true?"iframe":b.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(e(this).offset()).appendTo("body")})},
stop:function(){e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});e.ui.plugin.add("draggable","opacity",{start:function(b,l){var a=e(l.helper),m=e(this).data("draggable").options;if(a.css("opacity"))m._opacity=a.css("opacity");a.css("opacity",m.opacity)},stop:function(b,l){var a=e(this).data("draggable").options;a._opacity&&e(l.helper).css("opacity",a._opacity)}});e.ui.plugin.add("draggable","scroll",{start:function(){var b=e(this).data("draggable");if(b.scrollParent[0]!=
document&&b.scrollParent[0].tagName!="HTML")b.overflowOffset=b.scrollParent.offset()},drag:function(b){var l=e(this).data("draggable"),a=l.options,m=false;if(l.scrollParent[0]!=document&&l.scrollParent[0].tagName!="HTML"){if(!a.axis||a.axis!="x")if(l.overflowOffset.top+l.scrollParent[0].offsetHeight-b.pageY<a.scrollSensitivity)l.scrollParent[0].scrollTop=m=l.scrollParent[0].scrollTop+a.scrollSpeed;else if(b.pageY-l.overflowOffset.top<a.scrollSensitivity)l.scrollParent[0].scrollTop=m=l.scrollParent[0].scrollTop-
a.scrollSpeed;if(!a.axis||a.axis!="y")if(l.overflowOffset.left+l.scrollParent[0].offsetWidth-b.pageX<a.scrollSensitivity)l.scrollParent[0].scrollLeft=m=l.scrollParent[0].scrollLeft+a.scrollSpeed;else if(b.pageX-l.overflowOffset.left<a.scrollSensitivity)l.scrollParent[0].scrollLeft=m=l.scrollParent[0].scrollLeft-a.scrollSpeed}else{if(!a.axis||a.axis!="x")if(b.pageY-e(document).scrollTop()<a.scrollSensitivity)m=e(document).scrollTop(e(document).scrollTop()-a.scrollSpeed);else if(e(window).height()-
(b.pageY-e(document).scrollTop())<a.scrollSensitivity)m=e(document).scrollTop(e(document).scrollTop()+a.scrollSpeed);if(!a.axis||a.axis!="y")if(b.pageX-e(document).scrollLeft()<a.scrollSensitivity)m=e(document).scrollLeft(e(document).scrollLeft()-a.scrollSpeed);else if(e(window).width()-(b.pageX-e(document).scrollLeft())<a.scrollSensitivity)m=e(document).scrollLeft(e(document).scrollLeft()+a.scrollSpeed)}m!==false&&e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(l,b)}});e.ui.plugin.add("draggable",
"snap",{start:function(){var b=e(this).data("draggable"),l=b.options;b.snapElements=[];e(l.snap.constructor!=String?l.snap.items||":data(draggable)":l.snap).each(function(){var a=e(this),m=a.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:a.outerWidth(),height:a.outerHeight(),top:m.top,left:m.left})})},drag:function(b,l){for(var a=e(this).data("draggable"),m=a.options,n=m.snapTolerance,i=l.offset.left,q=i+a.helperProportions.width,f=l.offset.top,g=f+a.helperProportions.height,s=
a.snapElements.length-1;s>=0;s--){var d=a.snapElements[s].left,c=d+a.snapElements[s].width,p=a.snapElements[s].top,h=p+a.snapElements[s].height;if(d-n<i&&i<c+n&&p-n<f&&f<h+n||d-n<i&&i<c+n&&p-n<g&&g<h+n||d-n<q&&q<c+n&&p-n<f&&f<h+n||d-n<q&&q<c+n&&p-n<g&&g<h+n){if(m.snapMode!="inner"){var j=Math.abs(p-g)<=n,o=Math.abs(h-f)<=n,r=Math.abs(d-q)<=n,t=Math.abs(c-i)<=n;if(j)l.position.top=a._convertPositionTo("relative",{top:p-a.helperProportions.height,left:0}).top-a.margins.top;if(o)l.position.top=a._convertPositionTo("relative",
{top:h,left:0}).top-a.margins.top;if(r)l.position.left=a._convertPositionTo("relative",{top:0,left:d-a.helperProportions.width}).left-a.margins.left;if(t)l.position.left=a._convertPositionTo("relative",{top:0,left:c}).left-a.margins.left}var u=j||o||r||t;if(m.snapMode!="outer"){j=Math.abs(p-f)<=n;o=Math.abs(h-g)<=n;r=Math.abs(d-i)<=n;t=Math.abs(c-q)<=n;if(j)l.position.top=a._convertPositionTo("relative",{top:p,left:0}).top-a.margins.top;if(o)l.position.top=a._convertPositionTo("relative",{top:h-a.helperProportions.height,
left:0}).top-a.margins.top;if(r)l.position.left=a._convertPositionTo("relative",{top:0,left:d}).left-a.margins.left;if(t)l.position.left=a._convertPositionTo("relative",{top:0,left:c-a.helperProportions.width}).left-a.margins.left}if(!a.snapElements[s].snapping&&(j||o||r||t||u))a.options.snap.snap&&a.options.snap.snap.call(a.element,b,e.extend(a._uiHash(),{snapItem:a.snapElements[s].item}));a.snapElements[s].snapping=j||o||r||t||u}else{a.snapElements[s].snapping&&a.options.snap.release&&a.options.snap.release.call(a.element,
b,e.extend(a._uiHash(),{snapItem:a.snapElements[s].item}));a.snapElements[s].snapping=false}}}});e.ui.plugin.add("draggable","stack",{start:function(){var b=e(this).data("draggable").options;b=e.makeArray(e(b.stack)).sort(function(a,m){return(parseInt(e(a).css("zIndex"),10)||0)-(parseInt(e(m).css("zIndex"),10)||0)});if(b.length){var l=parseInt(b[0].style.zIndex)||0;e(b).each(function(a){this.style.zIndex=l+a});this[0].style.zIndex=l+b.length}}});e.ui.plugin.add("draggable","zIndex",{start:function(b,
l){var a=e(l.helper),m=e(this).data("draggable").options;if(a.css("zIndex"))m._zIndex=a.css("zIndex");a.css("zIndex",m.zIndex)},stop:function(b,l){var a=e(this).data("draggable").options;a._zIndex&&e(l.helper).css("zIndex",a._zIndex)}})})(jQuery);
shortcut={all_shortcuts:{},add:function(e,b,l){var a={type:"keydown",propagate:false,disable_in_input:false,target:document,keycode:false};if(l)for(var m in a){if(typeof l[m]=="undefined")l[m]=a[m]}else l=a;a=l.target;if(typeof l.target=="string")a=document.getElementById(l.target);e=e.toLowerCase();m=function(n){n=n||window.event;if(l.disable_in_input){var i;if(n.target)i=n.target;else if(n.srcElement)i=n.srcElement;if(i.nodeType==3)i=i.parentNode;if(i.tagName=="INPUT"||i.tagName=="TEXTAREA")return}if(n.keyCode)code=
n.keyCode;else if(n.which)code=n.which;i=String.fromCharCode(code).toLowerCase();if(code==188)i=",";if(code==190)i=".";var q=e.split("-"),f=0,g={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},s={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,
home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},d={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(n.ctrlKey)d.ctrl.pressed=true;if(n.shiftKey)d.shift.pressed=true;if(n.altKey)d.alt.pressed=true;if(n.metaKey)d.meta.pressed=true;for(var c=0;k=q[c],c<q.length;c++)if(k==
"ctrl"||k=="control"){f++;d.ctrl.wanted=true}else if(k=="shift"){f++;d.shift.wanted=true}else if(k=="alt"){f++;d.alt.wanted=true}else if(k=="meta"){f++;d.meta.wanted=true}else if(k.length>1)s[k]==code&&f++;else if(l.keycode)l.keycode==code&&f++;else if(i==k)f++;else if(g[i]&&n.shiftKey){i=g[i];i==k&&f++}if(f==q.length&&d.ctrl.pressed==d.ctrl.wanted&&d.shift.pressed==d.shift.wanted&&d.alt.pressed==d.alt.wanted&&d.meta.pressed==d.meta.wanted){b(n);if(!l.propagate){n.cancelBubble=true;n.returnValue=
false;if(n.stopPropagation){n.stopPropagation();n.preventDefault()}return false}}};this.all_shortcuts[e]={callback:m,target:a,event:l.type};if(a.addEventListener)a.addEventListener(l.type,m,false);else if(a.attachEvent)a.attachEvent("on"+l.type,m);else a["on"+l.type]=m},remove:function(e){e=e.toLowerCase();var b=this.all_shortcuts[e];delete this.all_shortcuts[e];if(b){e=b.event;var l=b.target;b=b.callback;if(l.detachEvent)l.detachEvent("on"+e,b);else if(l.removeEventListener)l.removeEventListener(e,
b,false);else l["on"+e]=false}}};var assert={};assert.critical=function(e,b){if(!e){if(typeof mjt!=="undefined"&&mjt.error)mjt.error("Internal Error: "+b);else typeof console!=="undefined"&&console.error&&console.error("Internal Error: "+b);if(!document.getElementById("error-dialog")){var l="";l+='<div style="font-weight:bold;">Internal Error</div>';l+=b;assert.error_dialog(l)}}};
assert.error_dialog=function(e){var b=document.createElement("div");b.style.cssText="position: absolute; top: 30px; left: 50%; width: 350px; margin: 0 0 0 -175px; padding: 15px; background-color: #fce2db; border: 1px solid #f3c5ac; color: #676767; font-size: 12px; z-index: 100;";b.innerHTML='<div id="error-dialog" style="float:right; color: #1170a3; margin: -10px -5px 0 0; cursor: pointer;" onclick="document.body.removeChild(this.parentNode);">x</div>'+e;document.body.appendChild(b)};
var unicode={};unicode.escape_char=function(e){e=e.charCodeAt(0).toString(16).toUpperCase();if(e.length===1)return"\\u000"+e;if(e.length===2)return"\\u00"+e;if(e.length===3)return"\\u0"+e;if(e.length===4)return"\\u"+e;return null};unicode.escape_str=function(e){return e.replace(/[^\u0020-\u007F]/g,unicode.escape_char)};
var zen=function(){function e(f,g){if(!f||!f.length)return"";var s=f.shift().split("+"),d=s.length-1,c=e(f,g+1);return s.map(function(p,h){var j=h===d?c:"";q.newTag();var o=p.replace(l,q.tag).replace(a,q.id).replace(m,q.className).replace(n,q.attr).replace(i,q.mult);if(o.length&&!b.length)b=o;return q.html(j,g)}).join("\n")}var b="",l=/^[\w:]+/,a=/^\#[:\w\$]+/,m=/^(\.[\w\$]+)+/,n=/^\[.+\]/,i=/^\*\d+/,q=function(){var f=function(s){return(new Array(s+1)).join("  ")},g;return{newTag:function(){return g=
{tagName:"div"}},tag:function(s){g.tagName=s;return""},id:function(s){g.id=s.slice(1);return""},className:function(s){g.className=s.slice(1).replace(/\./g," ");return""},attr:function(s){g.attrs=s.slice(1,-1);return""},mult:function(s){g.multiplier=parseInt(s.slice(1),10);return""},html:function(s,d){for(var c="<"+g.tagName+(g.id?' id="'+g.id+'"':"")+(g.className?' class="'+g.className+'"':"")+(g.attrs?" "+g.attrs:"")+">"+(s?"\n"+s+"\n"+f(d):"")+"</"+g.tagName+">",p=[],h=0,j=g.multiplier||1;h<j;h++)p[h]=
c.replace(/\$/g,h+1);return f(d)+p.join("\n"+f(d))}}}();return{convert:function(f,g){b="";var s=f.split("|"),d=s[0].split(">");s=s[1];d=e(d,g||0);if(s)if(s==="e")d=d.replace(/</g,"&lt;").replace(/>/g,"&gt;");else b="Unknown filter "+s;if(/^[\.\#\[\*]$/.test(b))b="";return{out:d,error:b}}}}();
function FreebaseStore(e,b){this._url=e||fb.acre.freebase.service_url;this._site_url=fb.acre.freebase.site_host;this._acre_server=b||fb.acre.host.name+(fb.acre.host.port===80?"":":"+fb.acre.host.port);this._handlers=[];this._user=null;return this}
(function(){var e=fb.acre.appeditor.service_path,b=mjt.define_task(mjt.freebase.FreebaseJsonPTask,[{name:"service"},{name:"args"}]);b.prototype.request=function(){return this.service_request(e+this.service,this.args)};b.prototype.response=function(i){return this.ready(i.result)};var l=mjt.define_task(mjt.freebase.FreebaseXhrTask,[{name:"service"},{name:"args"}]);l.prototype.request=function(){var i=e+this.service;if(this.args)i+="?"+mjt.formencode(this.args);return this.xhr_request("GET",i)};var a=
mjt.define_task(mjt.freebase.FreebaseXhrTask,[{name:"service"},{name:"args"}]);a.prototype.request=function(){return this.xhr_form_post(e+this.service,this.args)};var m=mjt.define_task(null,[{name:"service"},{name:"form"},{name:"args"}]);m.prototype.dynamic_iframe=function(i){var q=document.createElement("iframe");if(typeof i==="string"){q.id=i;q.name=i}q.style.display="none";q.className="mjt_dynamic";return q};m.prototype.request=function(){function i(){var c=f.contentWindow||f.contentDocument;if(c.document)return c.document;
return c}function q(){window.setTimeout(function(){$(f).remove()},1)}this.domid=mjt.uniqueid("mjt_iframe");var f=this.dynamic_iframe(this.domid);$("body").append(f);var g=this.form,s=this,d=window.setTimeout(function(){s.error("timeout","Upload timed out - no response from server.");q()},3E4);f.onload=function(){window.clearTimeout(d);var c=$(i(f).body).text();c=JSON.parse(c);if(c.code==="/api/status/ok"){s.result=c.result;s.ready(s.result)}else s.error(c.code,c.messages[0].message);q()};g.attr({target:this.domid,
action:mjt.form_url(e+this.service,this.args),method:"POST",enctype:"multipart/form-data"}).submit()};var n=mjt.define_task(mjt.freebase.FreebaseJsonPTask,[{name:"service_url","default":null}]);n.prototype.request=function(){this.jsonp.cache_controller={is_fresh:function(){return false}};return this.service_request("/acre/touch?_="+ +new Date)};n.prototype.response=function(){return this.ready(null)};FreebaseStore.prototype.Jsonp=b;FreebaseStore.prototype.XhrGet=l;FreebaseStore.prototype.XhrPost=
a;FreebaseStore.prototype.FileUpload=m;FreebaseStore.prototype.AppTouch=n;FreebaseStore.prototype.set_user=function(i){if(i){this._user=new AcreUser(this,i);if(i.apps)this._user_apps=i.apps;mjt.freebase.freebase_user={name:i.name,id:"/user/"+i.name}}else{this._user_apps=this._user=null;mjt.freebase.freebase_user=null}};FreebaseStore.prototype.t_init=function(){var i=this;mjt.app=new mjt.App;mjt.freebase.service_url=window.location.protocol+"//"+window.location.host;mjt.freebase.xhr_ok=true;return this.XhrGet("init_store").onready(function(q){i._acre_server=
q.host.name+(q.host.port===80?"":":"+q.host.port);i._handlers=q.acre_handlers;i._version=q.version;i.set_user(q.user)}).enqueue()};FreebaseStore.prototype.destroy=function(){};b=mjt.define_task(null,[{name:"store"}]);b.prototype.request=function(){this.url=window.location.protocol+fb.acre.apps.lib+"."+this.store.get_acre_host()+"/appeditor-services/check_thirdparty_cookies";var i=this;this.jsonp=mjt.JsonP();this.jsonp.set_timeout().jsonp_request_form(this.url,null,"callback").onready(function(q){q.result===
"success"?i.ready():i.error()}).onerror("error",i)};FreebaseStore.prototype.TestCookies=b;FreebaseStore.prototype.get_acre_version=function(){return this._version};FreebaseStore.prototype.get_user=function(){return this._user};FreebaseStore.prototype.get_user_apps=function(i){if(i){for(var q=0;q<this._user_apps.length;q++)if(this._user_apps[q].appid==i)return this._user_apps[q].appid;return null}else return this._user_apps};FreebaseStore.prototype.set_user_apps=function(i){this._user_apps=i};FreebaseStore.prototype.t_refresh_user_apps=
function(){var i=this;i.XhrGet("list_user_apps").enqueue().onready(function(q){i._user_apps=q})};FreebaseStore.prototype.get_url=function(){return this._url};FreebaseStore.prototype.get_service_path=function(){return e};FreebaseStore.prototype.get_name=function(){var i=this._name?this._name:"???";if(i==="OTG")i="";return i};FreebaseStore.prototype.get_acre_handlers=function(){return this._handlers};FreebaseStore.prototype.get_supported_mime_types=function(i){assert.critical(i,"Can't list supported mimetype");
return this._handlers[i].supported_mime_types};FreebaseStore.prototype.get_acre_host=function(){return this._acre_server};FreebaseStore.prototype.get_freebase_url=function(){return this._site_url};FreebaseStore.prototype.get_user_new_app_path=function(i,q){return"//"+q+"."+i.get_name()+".user.dev"};FreebaseStore.prototype.get_user_default_app_host=function(i){return i.get_name()+".user.dev."+this.get_acre_host()};FreebaseStore.prototype.get_user_view_url=function(i){return this.get_freebase_url()+
"/view/user/"+i.get_name()};FreebaseStore.prototype.get_user_image_url=function(i){return this.get_url()+"/api/trans/image_thumb/user/"+i.get_name()+"?maxwidth=30&maxheight=30&mode=fillcrop"};FreebaseStore.prototype.validate_filename=function(i){if(!/^[A-Za-z][\-_0-9A-Za-z\.]+$/.test(i))return false;if(i in{acre:true,status:"",api:true})return false;return true};mjt.label_package("FreebaseStore")})();var AcreDoc;
(function(){AcreDoc=function(e,b,l,a){assert.critical(e,"Must specify app when creating a file");this._app=e;this._name=b&&this._app.get_store().validate_filename(b)?b:this._app.get_untitled_file_name();this._acre_handler=l.handler||"mjt";this._mime_type=l.media_type||"text/plain";this._revision=l.content_id||null;this._based_on=l.based_on||null;this._has_been_saved=l.has_been_saved||false;this._dom_element=document.createElement("div");this._dom_element.className="file";this._event_handlers={};this._initial_state=
a||null;e=!this.has_been_saved();this._dirty_state={name:e,content:e,metadata:e,to_delete:false,revision:false,editor:false};this._loaded_editors={};this._current_editor=null;this._app.register_file(this);return this};AcreDoc.prototype.t_get_history=function(){var e={fileid:this.get_fileid()};return this.get_store().XhrGet("get_file_history",e).enqueue()};AcreDoc.prototype.t_get_revision=function(e){var b={fileid:this.get_fileid()};if(this.get_app().get_repository_capability("versioned")){b.revision=
e||this.get_revision();return b.revision?this.get_store().XhrGet("get_file_revision",b):mjt.Succeed({text:""})}else return this.get_store().XhrGet("get_file_revision",b)};AcreDoc.prototype.hide=function(){this._current_editor&&this._current_editor.hide();$(this._dom_element).hide()};AcreDoc.prototype.destroy=function(){for(var e in this._loaded_editors){var b=this._loaded_editors[e];b.destroy&&b.destroy()}$(this._dom_element).remove()};AcreDoc.prototype.is_writable=function(){return this.get_app().is_writable()};
AcreDoc.prototype.has_been_saved=function(){return!!this._has_been_saved};AcreDoc.prototype.is_dirty=function(e){if(e)return this._dirty_state[e];else for(var b in this._dirty_state)if(this._dirty_state[b]===true)return true;return false};AcreDoc.prototype.get_element=function(){return this._dom_element};AcreDoc.prototype.get_store=function(){return this.get_app().get_store()};AcreDoc.prototype.get_app=function(){return this._app};AcreDoc.prototype.get_name=function(){return this._name};AcreDoc.prototype.get_fileid=
function(){var e=this._old_name||this._name;return this.get_app().get_path()+"/"+e};AcreDoc.prototype.get_relative_path=function(){return this.get_name()};AcreDoc.prototype.get_revision=function(){return this._revision};AcreDoc.prototype.get_acre_handler=function(){return this._acre_handler};AcreDoc.prototype.get_mime_type=function(){return this._mime_type};AcreDoc.prototype.is_library=function(){return this._library};AcreDoc.prototype.get_based_on=function(){return this._based_on};AcreDoc.prototype.get_acre_url=
function(e){return this.get_app().get_base_url()+"/"+this.get_name()+(e?"?acre.console=1":"")};AcreDoc.prototype.set_name=function(e){if(e!==this.get_name()){if(!/^[\-_0-9A-Za-z\.]+$/.test(e))throw"File names can only contain alphanumeric characters, ., - and _";if(!/^[A-Za-z]/.test(e))throw"File names must be begin with a letter";if(!/[0-9A-Za-z]$/.test(e))throw"File names cannot end with a special character";this._old_name=this.get_name();this.get_app().unregister_file(this._old_name);this._name=
e;this.get_app().register_file(this);this.set_dirty("name")}};AcreDoc.prototype.set_acre_handler=function(e){if(e!==this._acre_handler){this._acre_handler=e;this.set_dirty("metadata");this.set_dirty("editor")}};AcreDoc.prototype.set_mime_type=function(e){if(e!==this._mime_type){this._mime_type=e;this.set_dirty("content");this.set_dirty("editor")}};AcreDoc.prototype.set_revision=function(e){if(this.is_dirty("content")||e!==this._revision){this._revision=e;this.set_dirty("revision");this.set_dirty("editor")}this.set_dirty("content",
false);this.set_dirty("to_delete",false)};AcreDoc.prototype.set_dirty=function(e,b){var l=e||"content",a=typeof b=="undefined"?true:b;if(l==="all")for(var m in this._dirty_state)this._dirty_state[m]=a;else this._dirty_state[l]=a};AcreDoc.prototype.t_save=function(e){var b=this;if(b.is_dirty("to_delete"))return b.t_delete();var l={fileid:b.get_fileid()},a=b.get_store().XhrPost("save_text_file",l);if(!b.has_been_saved()&&b.get_based_on())l.based_on=b.get_based_on().id;if(b.is_dirty("name"))l.name=b.get_name();
if(b.is_dirty("metadata")||!b.has_been_saved())l.acre_handler=b.get_acre_handler();if(!e&&b.get_revision()&&!(b.is_dirty("content")&&b.is_dirty("revision")))l.revision=b.get_revision();if(b.is_dirty("content")){e=b.get_editor_state();if(e.form)a=b.get_store().FileUpload("save_binary_file",e.form,l);else{l.text=e.text;l.content_type=b.get_mime_type()}}else if(b.is_dirty("revision"))a=b.get_store().XhrPost("set_file_revision",l);a.onready(function(m){if(m.content_id)b._revision=m.content_id;if(m.content_type)b._mime_type=
m.content_type;delete b._old_name;b._has_been_saved=true;b.set_dirty("all",false);b._current_editor&&typeof b._current_editor.refresh==="function"&&b._current_editor.refresh()}).onerror(function(m,n,i){if(m==="/api/status/error/file_format/unsupported_mime_type"){delete b._old_name;b._has_been_saved=true;b.set_dirty("all",false)}else mjt.warn("Save of",b.get_name(),"failed: ",m," - ",n,i)});return this.get_app().t_flush_cache().require(a).enqueue()};AcreDoc.prototype.t_delete=function(){function e(){b.get_app().unregister_file(b.get_name());
b.destroy()}var b=this,l={appid:b.get_app().get_path(),name:b.get_name()};if(!b.has_been_saved())return mjt.Succeed().enqueue().onready(e);l=b.get_store().XhrPost("delete_app_file",l).onready(e).onerror(function(a,m,n){mjt.warn("Delete of",b.get_name(),"failed: ",a," - ",m,n)});return this.get_app().t_flush_cache().require(l).enqueue()};AcreDoc.prototype.t_revert_to_saved=function(){var e=this,b={fileid:e.get_fileid()};return e.get_store().XhrGet("get_file",b).onready(function(l){e.set_name(l.name);
e.set_acre_handler(l.handler);e.set_mime_type(l.content_type);e.set_revision(l.content_id);e.set_dirty("all",false);e.clear_editors()}).onerror(function(l,a,m){mjt.warn("Rever of",e.get_name(),"failed: ",l," - ",a,m)}).enqueue()};AcreDoc.prototype.is_editor_loaded=function(e){var b=false;if(e)b=this._loaded_editors[e]?true:false;else for(var l in this._loaded_editors){b=true;break}return b};AcreDoc.prototype.clear_editors=function(e){function b(m){var n=l._loaded_editors[m];n.destroy&&n.destroy();
delete l._loaded_editors[m]}var l=this;if(e){if(l.get_edtior_name()===e)l._current_editor=null;b(e)}else{l._current_editor=null;for(var a in l._loaded_editors)b(a)}};AcreDoc.prototype.get_editor_name=function(){for(var e in EDITORS)if(this._current_editor&&this._current_editor instanceof EDITORS[e].editor_class)return e;return false};AcreDoc.prototype.t_editor_show=function(e,b,l){var a=this;if(a._showing_editor)return mjt.Succeed().enqueue();a._showing_editor=true;var m=null;if(l){m=l;a.set_dirty("content")}else if(a.is_dirty("revision"))m=
null;else if(a._current_editor)m=a.get_editor_state();else if(a._initial_state){m=a._initial_state;a._initial_state=null}if(a.is_dirty("editor")){a.clear_editors();a.set_dirty("editor",false)}l=EDITORS[e].editor_class;a._current_editor&&!(a._current_editor instanceof l)&&a._current_editor.hide();if(typeof a._loaded_editors[e]!=="undefined"){a._current_editor=a._loaded_editors[e];a.is_dirty("content")&&m&&a.set_editor_state(m);a._current_editor.show(b);a._showing_editor=false;return mjt.Succeed().enqueue()}return l.t_load(a,
m).onready(function(n){a._loaded_editors[e]=n;a._current_editor=a._loaded_editors[e];a._current_editor.show(b);a._showing_editor=false}).onerror(function(n,i,q){mjt.warn("Loading of",a.get_name(),"failed: ",n," - ",i,q)}).enqueue()};AcreDoc.prototype.get_editor_state=function(){var e=null;if(this._current_editor)e=this._current_editor.get_state();else if(this._initial_state)e=this._initial_state;return e};AcreDoc.prototype.set_editor_state=function(e){assert.critical(e,"Trying to set undefined editor state");
this._current_editor&&this._current_editor.set_state(e)};AcreDoc.prototype.get_editor_supported_features=function(e){if(!this.get_editor_name())return false;var b=EDITORS[this.get_editor_name()].supports;return e?!!b[e]:b};AcreDoc.prototype.register_editor_event_handlers=function(e){for(var b in e)this._event_handlers[b]=e[b]};AcreDoc.prototype.trigger_editor_event=function(e,b){if(e==="change")if(b[0]>0){this.set_dirty("content");this.set_dirty("revision",false)}else this.set_dirty("content",false);
this._event_handlers[e]&&this._event_handlers[e].apply(this,b)};AcreDoc.prototype.editor_undo=function(){this._current_editor&&this._current_editor.undo&&this._current_editor.undo()};AcreDoc.prototype.editor_redo=function(){this._current_editor&&this._current_editor.redo&&this._current_editor.redo()};AcreDoc.prototype.editor_indent=function(){this._current_editor&&this._current_editor.reindentSelection&&this._current_editor.reindentSelection()};AcreDoc.prototype.editor_goto_line=function(e){this._current_editor&&
this._current_editor.goto_line&&this._current_editor.goto_line(Number(e))}})();var AcreApp;
(function(){AcreApp=function(e,b){this._store=e;this._acre_host=e.get_acre_host();this._service_url=e.get_url();this._path=b;this._version=null;this._name="Untitled";this._release=this._listed=this._write_user=this._oauth_enabled=null;this._hosts=[];this._versions=[];this._authors={};this._files={};this._untitled_label="untitled_";this._untitled_counter=1;return this};AcreApp.prototype.t_load=function(){var e=this;return e._store.XhrGet("get_app",{appid:e._path}).onready(function(b){e._acre_host=
b.acre_host;e._remote_app=b.acre_host!==e.get_store().get_acre_host();e._repository=b.repository||{versioned:true};e._path=b.path;e._appid=b.id;e._version=b.version;e._name=b.name||"Untitled";e._oauth_enabled=b.oauth_enabled;e._write_user=b.write_user;e._parent=b.parent;e._children=b.children;e._listed=b.listed;e._release=b.release;e._hosts=b.hosts;e._versions=b.all_versions||[];e._last_edit=null;e._initial_file=b.current_file;for(var l in b.authors){var a=b.authors[l];e._authors[a.name]=new AcreUser(e.get_store(),
a)}for(var m in b.files){b.files[m].has_been_saved=true;new AcreDoc(e,b.files[m].name,b.files[m])}e.is_writable()&&!e._write_user&&e._oauth_enabled===null&&e.t_set_oauth(true)}).enqueue()};AcreApp.prototype.t_flush_cache=function(e){var b=this.get_store().AppTouch(this.get_base_url());if(e){e=this.get_hosts();for(var l=0;l<e.length;l++)this.get_store().AppTouch("http://"+e[l].host).enqueue()}return b};AcreApp.prototype.destroy=function(){for(var e in this._files)this._files[e].destroy();for(var b in this._authors)this._authors[b].destroy()};
AcreApp.prototype.register_file=function(e){var b=(new RegExp(this._untitled_label+"(\\d+)")).exec(e.get_name());if(b&&b.length){b=parseInt(b[1],10);if(this._untitled_counter<=b)this._untitled_counter=b+1}this._files[e.get_name()]=e};AcreApp.prototype.unregister_file=function(e){delete this._files[e]};AcreApp.prototype.is_dirty=function(){var e=this.get_files();for(var b in e)if(e[b].is_dirty())return true;return false};AcreApp.prototype.get_store=function(){return this._store};AcreApp.prototype.get_repository_capability=
function(e){return!!this._repository[e]};AcreApp.prototype.get_path=function(){return this.get_acre_host()===this.get_store().get_acre_host()?this._path:this._path+"."+this._acre_host+"."};AcreApp.prototype.get_versioned_path=function(){var e=this.get_path();if(this.is_version())e=e.replace("//","//"+this._version+".");return e};AcreApp.prototype.get_name=function(){return this._path.split("//")[1].split(".").shift()};AcreApp.prototype.get_display_name=function(){return this._name};AcreApp.prototype.get_parent=
function(){return this._parent};AcreApp.prototype.get_children=function(){return this._children};AcreApp.prototype.get_released_version=function(){return this._release};AcreApp.prototype.get_versions=function(){return this._versions};AcreApp.prototype.get_patches=function(){return this._patches};AcreApp.prototype.get_hosts=function(){return this._hosts};AcreApp.prototype.get_files=function(){return this._files};AcreApp.prototype.get_file=function(e){if(e){var b=e.split("/");return b.length>1?this.get_library(b[0]).get_file(b[1]):
this._files[e]}if(this._initial_file&&this._files[this._initial_file]){e=this._files[this._initial_file];this._initial_file=null;return e}else if(this._files.index)return this._files.index;else{var l=this.get_files();for(b in l)if(e=l[b])return e}return null};AcreApp.prototype.get_untitled_file_name=function(){return this._untitled_label+this._untitled_counter};AcreApp.prototype.get_acre_host=function(){return this._acre_host};AcreApp.prototype.get_base_url=function(){return"http:"+this.get_versioned_path()+
"."+this.get_acre_host()};AcreApp.prototype.get_view_url=function(){return this._repository.url+"/apps"+this._appid};AcreApp.prototype.get_edit_url=function(){return this._repository.url+"/apps/admin"+this._appid};AcreApp.prototype.is_version=function(){return!!this._version};AcreApp.prototype.get_version_label=function(){return this._version};AcreApp.prototype.get_version_timestamp=function(e){e=e?e:this._version;for(var b=0;b<this._versions.length;b++){var l=this._versions[b];if(l.name==e)return l.as_of_time}return null};
AcreApp.prototype.t_save_all=function(){var e=mjt.Succeed();for(var b in this._files){var l=this._files[b];l.is_dirty()&&e.require(l.t_save())}return this.t_flush_cache().require(e).enqueue()};AcreApp.prototype.t_get_history=function(e){var b={appid:this.get_path()};if(e)b.limit=e;return this.get_store().XhrGet("get_app_history",b).enqueue()};AcreApp.prototype.get_last_change=function(){return this._last_edit};AcreApp.prototype.set_last_change=function(e){this._last_edit=e};AcreApp.prototype.t_set_listing=
function(e,b,l){var a=this,m={appid:a.get_path()};if(e)m.name=e;if(e)m.description=b;if(e)m.listed=l;return a.get_store().XhrPost("set_app_properties",m).onready(function(){if(e)a._display_name=e}).onerror(function(n,i,q){mjt.warn("Changing app listing of",a.get_name(),"failed: ",n," - ",i,q)}).enqueue()};AcreApp.prototype.t_move=function(e){var b=this,l={appid:b.get_path(),to_appid:e};return b.get_store().XhrPost("move_app",l).onready(function(){b._path=e;b.t_flush_cache().enqueue()}).onerror(function(a,
m,n){mjt.warn("Move of",b.get_display_name(),"failed: ",a," - ",m,n)}).enqueue()};AcreApp.prototype.t_delete=function(){var e=this,b={appid:e.get_path()};return this.get_store().XhrPost("delete_app",b).enqueue().onready(function(){e.destroy()}).onerror(function(l,a,m){mjt.warn("Failed to delete app: "+l+", "+a+", "+m)})};AcreApp.prototype.t_set_host=function(e){var b=this;e={appid:b.get_path(),host:e};return b.get_store().XhrPost("set_app_host",e).onready(function(l){b._hosts=l.hosts;if(l.listed)b._listed=
true;b.t_flush_cache(true).enqueue()}).onerror(function(l,a,m){mjt.warn("Setting release URL of",b.get_display_name(),"failed: ",l," - ",a,m)}).enqueue()};AcreApp.prototype.t_set_release=function(e){var b=this;e={appid:b.get_path(),version:e};return b.get_store().XhrPost("set_app_release",e).onready(function(l){b._hosts=l.hosts;b._versions=l.versions;b._release=l.release;b.t_flush_cache(true).enqueue()}).onerror(function(l,a,m){mjt.warn("Setting release of",b.get_display_name(),"failed: ",l," - ",
a,m)}).enqueue()};AcreApp.prototype.t_add_version=function(e,b,l){var a=this;e={appid:a.get_path(),version:e};if(b)e.timestamp=b;if(typeof l!=="undefined")e.service_url=l;return this.get_store().XhrPost("create_app_version",e).onready(function(m){a._versions=m.versions}).onerror(function(m,n,i){mjt.warn("Failed to add version: "+m+", "+n+", "+i)}).enqueue()};AcreApp.prototype.t_remove_version=function(e){var b=this;e={appid:b.get_path(),version:e};return this.get_store().XhrPost("delete_app_version",
e).onready(function(l){b._versions=l.versions}).onerror(function(l,a,m){mjt.warn("Failed to remove version: "+l+", "+a+", "+m)}).enqueue()};AcreApp.prototype.is_remote=function(){return this._remote_app};AcreApp.prototype.is_writable=function(){return this.is_author()&&!this.is_version()&&!this.is_remote()};AcreApp.prototype.is_author=function(){return this.get_store().get_user()?this.get_store().get_user().get_name()in this.get_authors():false};AcreApp.prototype.is_oauth_enabled=function(){return!!this._oauth_enabled};
AcreApp.prototype.get_authors=function(){return this._authors};AcreApp.prototype.get_write_user=function(){return this._authors[this._write_user]};AcreApp.prototype.t_add_author=function(e){var b=this,l={appid:b.get_path(),username:e};return this.get_store().XhrPost("add_app_author",l).onready(function(a){a=new AcreUser(b._store,a.authors[e]);b._authors[e]=a}).onerror(function(a,m,n){mjt.warn("Failed to add author: "+a+", "+m+", "+n)}).enqueue()};AcreApp.prototype.t_remove_author=function(e){var b=
this,l={appid:b.get_path(),username:e};return this.get_store().XhrPost("remove_app_author",l).onready(function(){delete b._authors[e]}).onerror(function(a,m,n){mjt.warn("Failed to add author: "+a+", "+m+", "+n)}).enqueue()};AcreApp.prototype.t_get_apikeys=function(){var e={appid:this.get_path()};return this.get_store().XhrPost("list_app_apikeys",e).onerror(function(b,l,a){mjt.warn("Failed to get API Keys: "+b+", "+l+", "+a)}).enqueue()};AcreApp.prototype.t_add_apikey=function(e,b,l){e={appid:this.get_path(),
name:e,token:b,secret:l};return this.get_store().XhrPost("create_app_apikey",e).onerror(function(a,m,n){mjt.warn("Failed to add api key: "+a+", "+m+", "+n)}).enqueue()};AcreApp.prototype.t_remove_apikey=function(e){e={appid:this.get_path(),name:e};return this.get_store().XhrPost("delete_app_apikey",e).onerror(function(b,l,a){mjt.warn("Failed to add api key: "+b+", "+l+", "+a)}).enqueue()};AcreApp.prototype.t_set_oauth=function(e){var b=this;if(b.is_oauth_enabled()==e)return mjt.Succeed().enqueue();
if(!(e===true||e===false))return mjt.Fail(500,"Must set oauth_enabled to true or false").enqueue();var l={appid:b.get_path(),enable:e};return b.get_store().XhrPost("set_app_oauth_enabled",l).onready(function(){b._oauth_enabled=e}).onerror(function(a,m,n){mjt.warn("Setting OAuth enabled for ",b.get_name(),"failed: ",a," - ",m,n)}).enqueue()};AcreApp.prototype.t_set_writeuser=function(e){var b=this;if(!!b.get_write_user()===e)return mjt.Succeed().enqueue();if(!(e===true||e===false))return mjt.Fail(500,
"Must set write_user to true or false (current user)").enqueue();var l={appid:b.get_path(),enable:e};return b.get_store().XhrPost("set_app_writeuser",l).onready(function(a){b._write_user=e?a.write_user:null}).onerror(function(a,m,n){mjt.warn("Setting write user for ",b.get_name(),"failed: ",a," - ",m,n)}).enqueue()}})();var AcreUser;
(function(){AcreUser=function(e,b){this._store=e;this._name=b.name||null;this._full_name=b.full_name||null;this._is_admin=b.admin;return this};AcreUser.prototype.destroy=function(){};AcreUser.prototype.get_name=function(){return this._name};AcreUser.prototype.get_full_name=function(){return this._full_name};AcreUser.prototype.is_admin=function(){return!!this._is_admin};AcreUser.prototype.get_image_url=function(){return this._store.get_user_image_url(this)};AcreUser.prototype.get_view_url=function(){return this._store.get_user_view_url(this)};
AcreUser.prototype.get_new_app_host=function(){return this._store.get_user_default_app_host(this)};AcreUser.prototype.get_new_app_path=function(e){return this._store.get_user_new_app_path(this,e)}})();var EDITORS={},ImageEditor;
(function(){ImageEditor=function(e){this.supports_mime_type_change=false;this.ui_element=document.createElement("div");if(e.cssClassName)this.ui_element.className=e.cssClassName;this.file=e.file;this.readOnly=e.readOnly;if(e.onChange)this.on_change=e.onChange};ImageEditor.t_load=function(e,b){var l=EDITORS.ImageEditor.config;l.readOnly=!e.is_writable();l.onChange=function(a,m){e.trigger_editor_event("change",[a,m])};l=new ImageEditor(l);l.file=e;$(e.get_element()).append(l.ui_element);b&&l.set_state(b);
return mjt.Succeed(l)};ImageEditor.prototype.destroy=function(){$(this.ui_element).remove()};ImageEditor.prototype.show=function(e){var b="Upload an image";this._prefs=e;$(this.ui_element).empty();this.file.set_dirty("content",false);if(this.file.has_been_saved())b="Replace this image";if(!this.readOnly){this.form_element=$('<form class="image-upload"><label for="image-browse">'+b+':</label> <input id="image-browse" type="file" name="file" size="40"></form>');$(this.form_element).change(this.on_change);
$(this.ui_element).append(this.form_element)}e=this.file.get_name();b=this.file.get_app().get_base_url();if(this.file.has_been_saved())if(this.file.get_mime_type().substr(0,6)==="image/")$('<div class="image-preview"><p>'+e+':</p><img src="'+this.file.get_acre_url()+'"/></div>').appendTo(this.ui_element);else this.file.get_revision()&&$('<a href="'+b+"/"+e+'">download file</a>').appendTo(this.ui_element);$(this.ui_element).append('<div class="image-attribution"><img src="'+fb.h.reentrant_url("/static",
"freebase-cc-by-61x23.png")+' alt="Freebase CC-BY" width="61" height="23" /><p>All images included in Acre apps are released under <a href="http://creativecommons.org/licenses/by/3.0/">CC-BY</a>.</p></div>');$(this.ui_element).show()};ImageEditor.prototype.refresh=ImageEditor.prototype.show;ImageEditor.prototype.hide=function(){$(this.ui_element).hide()};ImageEditor.prototype.get_state=function(){return{form:this.form_element}};ImageEditor.prototype.set_state=function(e){if(e.revision){this.file.set_revision(e.revision);
this.file.set_dirty("content")}this.show()}})();EDITORS.ImageEditor={editor_class:ImageEditor,supports:{},config:{cssClassName:"Editor-view"}};
function EditorMargin(e){this._container=e;this._container.innerHTML="<div style='position: relative; left: 0; top: 0; width: 100%; height: 100%'></div>";e=[];for(var b=0;b<100;b++)e.push("<div>0</div>");this._lineMetricDiv=this._createLayer();this._lineMetricDiv.style.visibility="hidden";this._lineMetricDiv.innerHTML=e.join("");this._fontMetricDiv=this._createLayer();this._fontMetricDiv.style.visibility="hidden";this._fontMetricDiv.style.height="100em";this._lineNumberDiv=this._createLayer();this._lineNumberDiv.className=
"editor-margin-line-numbers";this._renderedLineCount=this._firstRenderedLine=0;this._currentLine=-1}
(function(){EditorMargin.get_layout_metrics=function(e,b){var l;if(e.getComputedStyle){l=e.getComputedStyle(b,null);return{paddingTop:l.getPropertyValue("padding-top"),marginTop:l.getPropertyValue("margin-top")}}else{l=b.currentStyle;return{paddingTop:l.paddingTop,marginTop:l.marginTop}}};EditorMargin.prototype={dispose:function(){},redraw:function(e,b){var l=this._lineMetricDiv.offsetHeight/100,a=this._fontMetricDiv.offsetHeight/100,m=l/a,n=null;if(b.contentHeight!==null)n=Math.floor(b.contentHeight/
l);var i=Math.floor(b.scrollY/l);l=Math.ceil((b.scrollY+b.visibleHeight)/l)-1;if(n!==null)l=Math.min(l,n-1);var q=this._firstRenderedLine+this._renderedLineCount;if(i<this._firstRenderedLine||i>=q||l>=q||n!==null&&n<l){q=l-i+1;i=Math.max(0,i-q);l=l+q;if(n!==null)l=Math.min(l,n-1);this._lineNumberDiv.style.paddingTop=m*i+"em";m=[];for(n=i;n<=l;n++)m.push("<div>"+(n+1)+"</div>");this._lineNumberDiv.innerHTML=m.join("");this._firstRenderedLine=i;this._renderedLineCount=l-i+1;this._highlightCurrentLine()}m=
function(f){try{if(f.indexOf("px")>0)return parseInt(f.replace(/px$/g,""),10);else if(f.indexOf("em")>0)return Math.round(parseFloat(f.replace(/em$/g,""),10)*a)}catch(g){}return 0};this._lineNumberDiv.style.top=-b.scrollY+m(e.paddingTop)+m(e.marginTop)+"px"},_createLayer:function(){var e=document.createElement("div");e.style.position="absolute";this._container.firstChild.appendChild(e);return e},setCurrentLine:function(e){if(e!==this._currentLine){this._unhighlightCurrentLine();this._currentLine=
e;this._highlightCurrentLine()}},_unhighlightCurrentLine:function(){if(this._currentLine!==-1){var e=this._lineNumberDiv.childNodes,b=this._currentLine-this._firstRenderedLine;if(b>=0&&b<e.length)e[b].className=""}},_highlightCurrentLine:function(){if(this._currentLine!==-1){var e=this._lineNumberDiv.childNodes,b=this._currentLine-this._firstRenderedLine;if(b>=0&&b<e.length)e[b].className="edit-margin-current-line-number"}}}})();var TextareaEditor;
(function(){TextareaEditor=function(e){var b=this;b._edit_element=document.createElement("textarea");if(e.cssClassName)b._edit_element.className=e.cssClassName;if(e.readOnly){$(b._edit_element).attr("readonly","yes").addClass("readonly");$(b._top_element).append("<div class='readonly-warning'>READ ONLY</div></div>")}if(e.on_change){b.timeout_id=null;var l=function(){b.timeout_id&&window.clearTimeout(b.timeout_id);b.timeout_id=window.setTimeout(e.on_change,300)},a=["input","drop"];$.browser.mozilla||
a.push("paste","keypress");for(var m=0;m<a.length;m++)$(b._edit_element).bind(a[m],l)}};TextareaEditor.t_load=function(e,b){var l=EDITORS.TextareaEditor.config;l.readOnly=!e.is_writable();l.on_change=function(){e.trigger_editor_event("change",[])};var a=new TextareaEditor(l);a._top_element=document.createElement("div");$(a._top_element).css({height:"100%",width:"100%"});$(e.get_element()).append(a._top_element);$(a._top_element).append(a._edit_element);a._margin_width=l.marginWidth;a._margin_element=
document.createElement("div");a._margin_element.className="edit-margin";$(a._top_element).append(a._margin_element);l=mjt.Succeed(a);if(b)a.set_state(b);else if(e.has_been_saved()){var m=e.t_get_revision().onready(function(n){a.set_state({text:n.text})});l.require(m)}return l};TextareaEditor.prototype.destroy=function(){$(this._top_element).remove()};TextareaEditor.prototype.show=function(e){var b=this;b._prefs=e;if(e.margin){if(!b.editorMargin)b.editorMargin=new EditorMargin(b._margin_element,{});
b._scroll_callback=function(){b._redraw_editor_margin()};if($.browser.msie)b._edit_element.onscroll=b._scroll_callback;else $(b._edit_element).bind("scroll",b._scroll_callback)}b._resize_callback=function(){b._on_resize()};$(window).bind("resize",b._resize_callback);b._on_resize();$(b._top_element).show()};TextareaEditor.prototype.hide=function(){$(this._top_element).hide();$(this._edit_element).unbind("scroll",this._scroll_callback);$(window).unbind("resize",this._resize_callback)};TextareaEditor.prototype.get_state=
function(){return{text:this._edit_element.value}};TextareaEditor.prototype.set_state=function(e){this._edit_element.value=e.text};TextareaEditor.prototype._on_resize=function(){if(this._prefs.margin){$(this._edit_element).css("left",this._margin_width);$(this._edit_element).width($(this._top_element).width()-this._margin_width);$(this._margin_element).width(this._margin_width);$(this._margin_element).show();this._redraw_editor_margin()}else{$(this._edit_element).css("left",0).width($(this._top_element).width());
$(this._margin_element).hide()}};TextareaEditor.prototype._redraw_editor_margin=function(){if(this._prefs.margin)try{var e=this._get_scroll_info();this.editorMargin.redraw(this._get_layout_metrics(),e)}catch(b){}};TextareaEditor.prototype._get_scroll_info=function(){return{scrollY:$(this._edit_element).scrollTop(),visibleHeight:$(this._edit_element).innerHeight(),contentHeight:null}};TextareaEditor.prototype._get_layout_metrics=function(){return EditorMargin.get_layout_metrics(window,this._edit_element)}})();
EDITORS.TextareaEditor={name:"TextArea",editor_class:TextareaEditor,supports:{hotswap:true,mimetype_change:true,margin:true},config:{cssClassName:"Editor-view",marginWidth:45}};
var QueryEditor=function(e,b,l){var a;e.innerHTML='<div style="position: relative"><div style="position: absolute;"></div><div style="position: absolute;"></div></div>';var m=e.firstChild.childNodes[0],n=e.firstChild.childNodes[1],i=this,q=function(){var f=Math.round((Math.max(100,e.offsetWidth)-20-10)/2)+"px",g=Math.max(100,e.offsetHeight);e.firstChild.style.width="100%";e.firstChild.style.height=g+"px";g=g-20;$(m).css("top","10px").css("height",g+"px");$(m).css("left","10px").css("width",f);$(n).css("right",
"10px").css("width",f).css("top","10px").css("height",g+"px");a.queryEditor.layout();a.outputPane.layout()};b.focusOnReady=true;b.onReady=function(){l.ready(i)};this.composition=a=CueCard.createComposition({queryEditorElement:m,queryEditorOptions:b,outputPaneElement:n,outputPaneOptions:{verticalPadding:2,horizontalPadding:2,hideHelp:true}});a.queryEditor._onRun=function(){this.run(true)};this.get_state=function(){return{text:a.queryEditor.content()}};this.set_state=function(f){a.queryEditor.content(f.text)};
this.destroy=function(){$(e).hide();$(e).remove()};this.show=function(f){var g=this;g._prefs=f;if(f.emql)this.composition.queryEditor._getQueryEnvelope=function(){return{extended:1}};var s=a.queryEditor._editor;setTimeout(function(){s.setLineNumbers(f.margin);s.setTextWrapping(f.softwrap);g._file.trigger_editor_event("linechange",[s.currentLine()]);if(s._last_selection){var d=s._last_selection.start,c=s._last_selection.end;s.selectLines(d.line,d.character,c.line,c.character);delete s._last_selection}},
1);$(window).bind("resize",q);$(".cuecard-queryEditor-controls-bottom").acre(fb.acre.apps.appeditor+"/templates.mjt","query_button_bar");$(g._file.get_element()).show();$(e).show();q()};this.hide=function(){$(e).hide();$(window).unbind("resize",q)};this.undo=function(){a.queryEditor._editor.editor.history.undo()};this.redo=function(){a.queryEditor._editor.editor.history.redo()};this.reindentSelection=function(){a.queryEditor._editor.editor.reindentSelection()};this.query_assist=function(){a.queryEditor.startAssistAtCursor()};
this.query_run=function(){a.queryEditor.run(this._file.is_writable())};this.query_redangle=function(){var f=a.queryEditor,g=f.getQueryModelAndContext();g.model.toInsideOutQueryJson(g.context,CueCard.UI.createBlockingContinuations(function(s,d){f.content(CueCard.jsonize(d,f.getJsonizingSettings()))}))};this.generate_template=function(){var f=this,g=ui.get_app().get_untitled_file_name(),s=a.queryEditor.getQueryModelAndContext().model.toQueryJson();CueCard.CodeGeneration.serializers["acre-template"].generateQueryCall=
function(d,c,p,h,j,o,r){c.appendIndent();c.append("<acre:script>");c.appendLineBreak();c.indent();c.appendIndent();c.append("var "+o+' = acre.require("'+f._file.get_name()+'").query');c.append(";");c.appendLineBreak();if(f._prefs.emql){c.appendIndent();c.append("var "+r+" = acre.freebase.mqlread("+o+", {extended:1});")}else{c.appendIndent();c.append("var "+r+" = acre.freebase.mqlread("+o+");")}c.appendLineBreak();c.unindent();c.appendIndent();c.append("</acre:script>");c.appendLineBreak();return r+
".result"};s=CueCard.CodeGeneration.generate(s,CueCard.CodeGeneration.serializers["acre-template"],{indentLevel:1});ui.do_file_create_new(g,{acre_handler:"mjt"},{text:'<html>\r<head>\r\r  <title>Query-Generated Template</title>\r\r  <style type="text/css" media="screen">\r    * { vertical-align: baseline; font-weight: inherit; font-family: inherit; \r        font-style: inherit; font-size: inherit; border: 0 none; outline: 0; padding: 0; margin: 0; }\r    body { margin: 15px; }\r    ul { list-style: none; }\r    li { padding: 3px; }\r    table { border-collapse: collapse; border-spacing: 0; width: 100%; }\r    th, td { border: 1px solid #ddd; vertical-align: top; padding: 6px; }\r    th { width: 20%; text-align: right; font-size: 11px; font-weight: bold; padding: 6px; color: #666; background: #f5f5f5; }\r    td { width: 80%; font-size: 12px; }\r    img { padding: 1px; border: 1px solid #ccc;}\r    ins { color: #aaa; text-decoration: none;}\r  </style>\r\r</head>\r\r<body>\r'+
s+'  \r  <!-- Freebase attribution template --\>\r  ${acre.require("/freebase/apps/attribution/templates").blanket()}\r</body>\r</html>\r'})};CodeMirror.prototype.highlight_line=function(){var f=this._file,g=this.currentLine(),s=$(this.lineNumbers);s.find(".Codemirror-current-line").removeClass("Codemirror-current-line");s.find("div").eq(g).addClass("Codemirror-current-line");f.trigger_editor_event("linechange",[g])};this.goto_line=function(f){var g=a.queryEditor._editor.editor;try{g.jumpToLine(f)}catch(s){g.selectLines(g.prevLine(g.lastLine()),
0)}}};
(function(){var e=mjt.define_task(null,[{name:"parent"},{name:"editor_config"}]);e.prototype._task_class="CreateQueryEditor";e.prototype.request=function(){return new QueryEditor(this.parent,this.editor_config,this)};QueryEditor.t_load=function(b,l){CueCard.helper=fb.acre.freebase.site_host+"/cuecard/";CueCard.freebaseServiceUrl=fb.acre.freebase.service_url+"/";CueCard.urlPrefix=CueCard.apiProxy.base=fb.acre.appeditor.cuecard_api;var a=$.extend(true,{},EDITORS.QueryEditor.config);a.readOnly=!b.is_writable();
var m=document.createElement("div");$(m).css({height:"100%",width:"100%"});$(b.get_element()).hide().append(m);a.codeMirror.onChange=function(){try{var q=b._loaded_editors.QueryEditor.composition.queryEditor._editor.historySize();b.trigger_editor_event("change",[q.undo,q.redo])}catch(f){}};a.codeMirror.cursorActivity=function(){b._loaded_editors.QueryEditor.composition.queryEditor._editor.highlight_line()};var n,i=e(m,a).onready(function(q){q.composition.queryEditor._editor.setParser("JSParser");
if(l)q.set_state(l);else n&&q.set_state({text:n.result.text});q._file=q.composition.queryEditor._editor._file=b;q._top_element=m;$(">div",m).css("height","100%");if(a.readOnly){$(b.get_element()).addClass("readonly");$(".cuecard-queryEditor",b.get_element()).append("<div class='readonly-warning'>READ ONLY</div>")}$('<a class="cuecard-permalink" href="javascript:{}">Open in Query Editor</a>').click(function(){var f="http://www.freebase.com/app/queryeditor?q="+encodeURIComponent(q.composition.queryEditor.getUnresolvedQuery());
window.open(f,"_blank")}).appendTo($(m).find(".cuecard-outputPane")[0]);b.trigger_editor_event("newframe",[q.composition.queryEditor._editor.frame])});if(!l&&b.has_been_saved()){n=b.t_get_revision();i.require(n)}return i}})();EDITORS.QueryEditor={editor_class:QueryEditor,supports:{margin:true,linenumbers:true,softwrap:true,undo:true,indent:true,inline_preview:true,emql:true},config:{codeMirror:{lineNumbers:false,parserfile:[fb.acre.libs.codemirror],stylesheet:[fb.acre.libs.codemirror_css]}}};
(function(){function e(a){var m="DummyParser",n={mqlquery:"JSParser",acre_script:"JSParser",mjt:"HTMLMixedParser"},i={"text/html":"HTMLMixedParser","text/css":"CSSParser","text/javascript":"JSParser","application/json":"JSParser"},q=a.get_acre_handler();a=a.get_mime_type();if(a!=="text/plain"){if(a in i)m=i[a]}else if(q in n)m=n[q];return m}var b=mjt.define_task(null,[{name:"parent"},{name:"editor_config"}]);b.prototype._task_class="CreateCodeMirror";b.prototype.request=function(){var a=this,m=new CodeMirror(this.parent,
this.editor_config);this.editor_config.initCallback=function(){a.ready(m)};m.get_state=function(){return{text:this.editor.getCode()}};m.set_state=function(n){this.editor.importCode(n.text)}};CodeMirror.t_load=function(a,m){var n=$.extend(true,{},EDITORS.CodeMirror.config);n.readOnly=!a.is_writable();n.readOnly&&$(a.get_element()).addClass("readonly").append("<div class='readonly-warning'>READ ONLY</div>");n.onChange=function(){if(a._loaded_editors.CodeMirror){var g=a._loaded_editors.CodeMirror.historySize();
a.trigger_editor_event("change",[g.undo,g.redo])}};var i=document.createElement("div");$(i).css({height:"100%",width:"100%"});$(a.get_element()).append(i);var q,f=b(i,n).onready(function(g){g.setParser(e(a));if(m)g.set_state(m);else q&&g.set_state({text:q.result.text});g._file=a;g._top_element=i;a.trigger_editor_event("newframe",[g.frame]);n.cursorActivity=function(){g.highlight_line()}});if(!m&&a.has_been_saved()){q=a.t_get_revision();f.require(q)}return f};CodeMirror.prototype.destroy=function(){if("_codeAssist"in
this){this._codeAssist.dispose();this._codeAssist=null}$(this._top_element).remove()};CodeMirror.prototype.show=function(a){var m=this,n=m._file;m._prefs=a;setTimeout(function(){m.setLineNumbers(a.margin);m.setTextWrapping(a.softwrap);m.highlight_line();$(m._top_element).show();$("iframe",m._top_element).focus();if(m._last_selection){var i=m._last_selection.start,q=m._last_selection.end;m.selectLines(i.line,i.character,q.line,q.character);delete m._last_selection}a.dotTrigger&&n.is_writable()&&fb.get_script(fb.acre.libs.codeassist,
function(){if(!m._codeAssist)m._codeAssist=new CodeAssist(m.frame,m,{isMjt:n.get_acre_handler()=="mjt"});m._codeAssist.putSetting("dotTrigger",a.dotTrigger)})},1)};CodeMirror.prototype.hide=function(){var a=this.cursorPosition(),m=this.cursorPosition(false);this._last_selection={start:a,end:m};$(this._top_element).hide()};CodeMirror.prototype.highlight_line=function(){var a=this._file,m=this.currentLine(),n=$(this.lineNumbers);n.find(".Codemirror-current-line").removeClass("Codemirror-current-line");
n.find("div").eq(m).addClass("Codemirror-current-line");a.trigger_editor_event("linechange",[m])};CodeMirror.prototype.goto_line=function(a){try{this.jumpToLine(a)}catch(m){this.selectLines(this.prevLine(this.lastLine()),0)}};var l={"acre:doc":"xml-tagname-acre","acre:block":"xml-tagname-acre","acre:script":"xml-tagname-acre"};CodeMirror.style_token=function(a,m){var n=m.content.toLowerCase();if(m.style=="xml-tagname")if(l[n])a.className+=" "+l[n]}})();
EDITORS.CodeMirror={name:"CodeMirror",editor_class:CodeMirror,supports:{hotswap:true,mimetype_change:true,margin:true,linenumbers:true,softwrap:true,undo:true,indent:true,codeassist:true},config:{parserConfig:{triggers:{"acre:script":"JSParser",script:"JSParser",style:"CSSParser"}},activeTokens:CodeMirror.style_token,height:"100%",marginWidth:45,autoMatchParens:true,passDelay:100,undoDelay:250,basefiles:[],parserfile:[fb.acre.libs.codemirror],stylesheet:[fb.acre.libs.codemirror_css],lineNumbers:true,
highlightActiveLine:true,tabMode:"shift",dotTrigger:false}};var ui={};
(function(){function e(h){h=h.replace(/<\?xml[^>]+>/g,"");h=h.replace(/<style[^>]+>/g,"<style>");return h=h.replace(/type=['"]text\/(css|javascript)['"]/g,"")}function b(h){return h.replace(/acre:/g,"")}function l(h){h=h.replace(/<acre:script>/g,"<script>").replace(/<\/acre:script>/g,"<\/script>");h=h.replace(/<\/?acre:(block|doc)[^>]*>/g,"");h=h.replace(/<[^>]+>/g,b);return h=e(h)}function a(h){/^\s*@charset\s+"UTF-8";/.test(h)||(h='@charset "UTF-8"; '+h);return h}ui.init=function(){$("#body").acre(fb.acre.apps.appeditor+
"/templates.mjt","body");$("#button-apps").click(function(){ui.do_show_menu("apps")}).attr("title",ui.shortcut.get_keys("Open App"));ui.shortcut.register_keys(document);window.onbeforeunload=ui.warn_user_about_unsaved_files;$(document).keydown(function(h){return!(h.which===8&&h.target.nodeName!=="INPUT"&&h.target.nodeName!=="TEXTAREA")});$(".exit").live("click",ui.do_hide_overlays);$(".app-link").live("click",function(h){if(!(h.ctrlKey||h.metaKey||h.altKey||h.shiftKey)){h=$(this).attr("apppath");
ui.do_hide_overlays();ui.get_app()&&ui.get_app().is_dirty()?ui.do_show_dialog("files_dirty",[h]):ui.do_choose_app(h);return false}});ui.check_browser_hash();setInterval(ui.check_browser_hash,250)};ui.refresh_app_templates=function(h){var j=ui.get_app();$("#header-apptitle").acre(fb.acre.apps.appeditor+"/templates.mjt","header",[h]);if(j){$("#list-column").acre(fb.acre.apps.appeditor+"/templates.mjt","list_column");j.is_writable()?$("#about-bar").hide():$("#about-bar").acre(fb.acre.apps.appeditor+
"/templates.mjt","about_bar").show()}};ui.refresh_file_templates=function(){$("#file-list").acre(fb.acre.apps.appeditor+"/templates.mjt","file_list");$("#button-bar").acre(fb.acre.apps.appeditor+"/templates.mjt","button_bar");ui.finish_drawing()};ui.finish_drawing=function(){$(".refresh").show();ui.set_state();$(window).trigger("resize")};ui.do_show_dialog=function(h,j){function o(r){if(r.keyCode==27){ui.do_hide_dialog_overlays();$(document).unbind("keydown",o)}}ui.do_hide_overlays();if(h=="welcome")ui.dialog=
$("<div id='"+h+"'></div>").acre(fb.acre.apps.appeditor+"/dialogs.mjt",h,j).prependTo(document.body);else{$("<div id='dialog-overlay'></div>").prependTo(document.body);$(document).bind("keydown",o);ui.dialog=$("<div id='dialog-"+h+"' class='dialog'></div>").acre(fb.acre.apps.appeditor+"/dialogs.mjt",h,j).prepend("<div class='dialog-close' onclick='ui.do_hide_overlays()'></div>").prependTo(document.body)}ui.dialog.show();ui.dialog.css("left",($(window).width()-ui.dialog.outerWidth())/2);return false};
ui.do_show_menu=function(h,j){function o(){ui.do_hide_menu_overlays();$(document).unbind("keydown",r)}function r(x){x.keyCode==27&&o()}$("<div id='menu-overlay'></div>").prependTo(document.body).click(o);$(document).bind("keydown",r);$("#button-"+h).addClass("button-open");var t=$("#button-"+h).offset(),u=$("#button-"+h).height();$("<div id='menu-"+h+"' class='menu'></div>").css({top:t.top+u+10,left:t.left}).prependTo(document.body).acre(fb.acre.apps.appeditor+"/menus.mjt",h,j);return false};ui.do_setup_submenu=
function(h,j,o){var r,t,u=false,x=$("#"+h),C=x.closest(".menu"),w=$("<div id='menu-"+j+"' class='menu submenu'></div>");x.mouseenter(function(){r=setTimeout(function(){if(u)w.css("visibility","visible");else{w.css({top:x.offset().top,left:C.offset().left+C.width()}).prependTo(document.body).acre(fb.acre.apps.appeditor+"/menus.mjt",j,o).mouseenter(function(){clearTimeout(t)}).mouseleave(function(){clearTimeout(r);t=setTimeout(function(){w.css("visibility","hidden")},100)});u=true}},250)}).mouseleave(function(){clearTimeout(r);
t=setTimeout(function(){w.css("visibility","hidden")},100)})};ui.do_hide_dialog_overlays=function(){delete ui.dialog;$("#dialog-overlay, .dialog").remove();$(".fbs-pane, .fbs-flyout-pane").hide()};ui.do_hide_menu_overlays=function(){$("#menu-overlay, .menu").remove();$(".button-open").removeClass("button-open");$(".fbs-pane, .fbs-flyout-pane").hide()};ui.do_hide_overlays=function(){ui.do_hide_dialog_overlays();ui.do_hide_menu_overlays()};ui.do_hide_welcome=function(){$("#welcome").remove()};var m=
true,n,i,q,f,g,s=false,d=false,c=+new Date;ui.check_browser_hash=function(){if(!d){var h=ui._get_browser_hash();if(h=="0")ui.set_state();else if(m||ui._ui_state_to_browser_hash()!==h){m=false;h=mjt.app.decode_uristate(h);var j=/[\<\>]/,o=h.path||h.app;o=!j.test(o)?o:null;j=!j.test(h.file)?h.file:null;ui.do_choose_app(o,j,h.line,h.create)}}};ui._get_browser_hash=function(){return window.location.hash.replace(/#!?/,"")};ui._ui_state_to_browser_hash=function(){if(typeof ui.get_app()=="undefined")return null;
var h={};if(ui.get_app())h.path=ui.get_app().get_versioned_path();if(ui.get_file())h.path+="/"+ui.get_file().get_relative_path();return mjt.app.encode_uristate(h)};ui.set_state=function(){var h=ui.get_app(),j=ui.get_file();s=j?j.is_dirty():null;var o="";if(h)o+=(h.get_display_name()||h.get_path())+" - ";if(j)o+=j.get_name()+" - ";o+="Freebase App Editor";document.title=o;h=ui._ui_state_to_browser_hash();if(h!==ui._get_browser_hash())window.location.hash="!"+h;d=false};ui.clear_state=function(){s=
g=f=q=null};ui.get_store=function(){return n};ui.set_store=function(h){n=h};ui.set_user=function(h){var j=ui.get_store();h!==j.get_user()&&j.set_user(h);i=j.get_user()};ui.get_app=function(){if(!q)return null;return q};ui.get_file=function(){if(!f)return null;return f};ui.get_line=function(){return g};ui.get_user=function(){return i};ui.get_recents=function(h,j){var o=$.localstore("recent_"+h,undefined,false);if(o===null)o=[];!j&&o&&o.length>0&&o.shift();return o};ui.add_recent=function(h,j,o){var r=
$.localstore("recent_"+h,undefined,false);if(!r||!jQuery.isArray(r))r=[];for(var t=JSON.stringify(j),u=0;u<r.length;u++)if(JSON.stringify(r[u])==t||h=="apps"&&(j&&(r[u].path==j.path||ui.id_to_path(r[u].path)==j.path)||r[u].path==o))r.splice(u,1);if(j){r.unshift(j);if(r&&r.length>16){j=r.splice(16);if(h=="apps")for(o=0;o<j.length;o++)ui.clear_recents(j[o])}}$.localstore("recent_"+h,r,false)};ui.clear_recents=function(h){$.localstore("recent_"+h,null,false)};ui.do_choose_app=function(h,j,o,r){function t(){ui.clear_state();
ui.set_state();ui.refresh_app_templates("open");var A=ui.get_recents("apps",true);if(r=="app"){if(!ui.get_user())location.href=ui.get_store().get_user_account_url("signin")+"create=app";ui.do_show_dialog("new_app")}else if(A.length>0){var E=A.shift();$.localstore("recent_apps",A,false);ui.do_choose_app(E.path)}else ui.get_user()?ui.do_show_dialog("welcome",[true]):ui.do_show_dialog("welcome")}function u(){if(r=="file"){ui.set_state();ui.do_show_dialog("add_file")}else ui.do_choose_file(j,o)}d=true;
var x=ui.get_app(),C=x?x.get_versioned_path():null;if(h&&x&&h==C){ui.refresh_app_templates();u()}else{ui.do_hide_overlays();ui.do_hide_welcome();$(".refresh").hide();if(h){x&&x.destroy();ui.refresh_app_templates("loading");var w=new AcreApp(ui.get_store(),h);w.t_load().onready(function(){q=w;ui.add_recent("apps",{path:w.get_path(),name:w.get_display_name()});f=null;ui.refresh_app_templates();u();ui.do_status_check()}).onerror(function(A,E,F){if(A=="/api/status/error/input/no_app"){ui.MessagePanel.error(E?
E:"Error loading app: "+h+". "+E||"");ui.add_recent("apps",null,h);t()}else{assert.critical(false,"Error connecting to Freebase<br/>"+E);mjt.error(A,E,F);ui.clear_state();ui.set_state();ui.refresh_app_templates("open")}})}else t()}};ui.do_choose_file=function(h,j){function o(){var x=ui.get_file();if(!x)return ui.refresh_file_templates();var C=ui._get_desired_editor_classname();return x.t_editor_show(C,ui.get_editor_prefs()).onready(function(){j&&setTimeout(function(){x.editor_goto_line(j)},0);ui.refresh_file_templates();
ui.set_state()})}d=true;var r=ui.get_app(),t=ui.get_file(),u=r.get_file(h);u||(u=r.get_file());if(!u||u==t)o(j);else{f=u;s=u.is_dirty();if($("#file-area").has(u.get_element()).length===0){$("#file-area").append(u.get_element());ui._register_editor_event_handlers(u)}t&&t.hide();$(u.get_element()).show();return o(j)}};ui.do_refresh_file=function(){var h=ui.get_file();if(h){h.set_dirty("editor");var j=ui._get_desired_editor_classname();h.t_editor_show(j,ui.get_editor_prefs()).onready(function(){ui.refresh_file_templates();
setTimeout(function(){h.editor_goto_line(ui.get_line())},0)})}};ui.do_run_view=function(h,j){var o=ui.get_file();if(o.get_acre_handler()=="mqlquery")o._current_editor.query_run();else{var r=ui.get_file().get_acre_url(j),t=window.open("about:blank",ui.get_app().get_path().replace(/[\/-]/g,"_"));if(!t){ui.MessagePanel.error("A window couldn't be opened.  Tell your web browser to allow this site to open pop up windows and try again to continue.");return false}ui.do_app_save_all(function(){t.location=
r;t.focus()})}};ui.do_acre_home_link=function(){location.href=ui.get_store().get_freebase_url()+"/apps";return false};ui.do_status_check=function(){var h={};if(ui.get_app())h.appid=ui.get_app().get_path();ui.get_store().XhrGet("store_status_check",h).enqueue().onready(function(j){ui.get_app().set_last_change(j.change);if(!!j.user!==!!ui.get_user()){ui.set_user(j.user);if(!j.user){ui.MessagePanel.error("You are no longer signed in.  Sign back in in another window to not lose any changes.");$(window).trigger("fb.user.signedout")}$(window).trigger("fb.user.signedin")}$("#app-edits-shim").acre(fb.acre.apps.appeditor+
"/templates.mjt","app_edits");ui.refresh_file_templates()})};ui.do_app_create_new=function(h,j,o){var r={appid:h};if(j)r.name=j;if(o)r.clone=o;if(ui.get_store().get_user_apps(h))ui.MessagePanel.error("App with that URL already exists");else{ui.MessagePanel.doing("Creating: "+j+"...");ui.get_store().XhrPost("create_app",r).enqueue().onready(function(t){ui.MessagePanel.info("Created: "+j);ui.do_choose_app(h);ui.get_store().set_user_apps(t)}).onerror(function(t,u){ui.MessagePanel.error(u?u:"Error creating: "+
h+". "+u||"")})}};ui.do_app_move=function(h){var j=ui.get_app(),o=j.get_path();d=true;ui.MessagePanel.doing("Moving app...");j.t_move(h).onready(function(){ui.set_state();ui.add_recent("apps",{path:j.get_path(),name:j.get_display_name()},o);ui.get_store().t_refresh_user_apps();ui.MessagePanel.info("App moved to "+h)}).onerror(function(r,t){ui.MessagePanel.error(t?t:"Error moving: "+j.get_display_name())})};ui.do_app_set_host=function(h){var j=ui.get_app();ui.MessagePanel.doing("Updating release URL for "+
j.get_display_name()+"...");j.t_set_host(h).onready(function(){ui.MessagePanel.info("Release URL updated");$("#app-hosts-list").acre(fb.acre.apps.appeditor+"/menus.mjt","app_hosts_list")}).onerror(function(o,r){ui.MessagePanel.error(r?r:"Error updating release URL for: "+j.get_display_name())})};ui.do_app_set_release=function(h){var j=ui.get_app();ui.MessagePanel.doing("Updating release of "+j.get_display_name()+"...");j.t_set_release(h).onready(function(){ui.MessagePanel.info("Release updated to "+
h);$("#app-versions-add").acre(fb.acre.apps.appeditor+"/menus.mjt","app_versions_list");$("#app-hosts-list").acre(fb.acre.apps.appeditor+"/menus.mjt","app_hosts_list")}).onerror(function(o,r){ui.MessagePanel.error(r?r:"Error releasing: "+j.get_display_name())})};ui.do_app_add_version=function(h,j,o){var r=ui.get_app();ui.MessagePanel.doing("Creating version "+h);r.t_add_version(h,j,o).onready(function(){ui.MessagePanel.info("Created version "+h);$("#app-versions-add").acre(fb.acre.apps.appeditor+
"/menus.mjt","app_versions_list")}).onerror(function(t,u){ui.MessagePanel.error("Failed to add version. "+u)})};ui.do_app_remove_version=function(h){var j=ui.get_app();ui.MessagePanel.doing("Removing version "+h);j.t_remove_version(h).onready(function(o){ui.MessagePanel.info("Removed version "+h);$("#app-versions-add").acre(fb.acre.apps.appeditor+"/menus.mjt","app_versions_list",[o])})};ui.do_app_set_listing=function(h,j,o){var r=ui.get_app();ui.MessagePanel.doing("Updating app name...");r.t_set_listing(h,
j,o).onready(function(){h&&ui.add_recent("apps",{path:r.get_path(),name:r.get_display_name()},r.get_path());ui.MessagePanel.info("Updated app name");ui.refresh_app_templates()}).onerror(function(t,u){ui.MessagePanel.error(u?u:"Error changing app name")})};ui.do_app_add_author=function(h){ui.get_app().t_add_author(h).onready(function(){var j=ui.get_app().get_authors();$("#app-authors-list").acre(fb.acre.apps.appeditor+"/menus.mjt","app_authors_list",[j])})};ui.do_app_remove_author=function(h){ui.get_app().t_remove_author(h).onready(function(){var j=
ui.get_app().get_authors();$("#app-authors-list").acre(fb.acre.apps.appeditor+"/menus.mjt","app_authors_list",[j])})};ui.do_app_set_oauth=function(h){var j=ui.get_app();ui.MessagePanel.doing("Setting OAuth state...");j.t_set_oauth(h).onready(function(){ui.MessagePanel.info("OAuth "+(h?"enabled":"disabled"))}).onerror(function(o,r){ui.MessagePanel.error("Failed to update OAuth state: "+r)})};ui.do_app_set_writeuser=function(h){var j=ui.get_app();ui.MessagePanel.doing("Setting write user...");j.t_set_writeuser(h).onready(function(){ui.MessagePanel.info("Write user "+
(h?"enabled":"disabled"))}).onerror(function(o,r){ui.MessagePanel.error("Failed to update writeuser state: "+r)})};ui.do_app_add_apikey=function(h,j,o){var r=ui.get_app();ui.MessagePanel.doing("Adding API key for "+h+"...");r.t_add_apikey(h,j,o).onready(function(t){ui.MessagePanel.info(h+" API key added.");$("#app-apikeys-add").acre(fb.acre.apps.appeditor+"/menus.mjt","app_apikeys_list",[t.keys])}).onerror(function(t,u){ui.MessagePanel.error("Failed to add API key: "+u)})};ui.do_app_remove_apikey=
function(h){var j=ui.get_app();ui.MessagePanel.doing("Deleting API key for "+h+"...");j.t_remove_apikey(h).onready(function(o){ui.MessagePanel.info(h+" API key deleted.");$("#app-apikeys-add").acre(fb.acre.apps.appeditor+"/menus.mjt","app_apikeys_list",[o.keys])}).onerror(function(o,r){ui.MessagePanel.error("Failed to delete API key: "+r)})};ui.do_app_save_all=function(h){var j=ui.get_app();if(!j.is_dirty()&&typeof h==="function")h();else{ui.MessagePanel.doing("Saving all files...");j.t_save_all().onready(function(){ui.MessagePanel.info("All files saved.");
ui.refresh_file_templates();typeof h==="function"&&setTimeout(h,500)}).onerror(function(o,r){ui.MessagePanel.error("Failed to save all files: "+r)})}};ui.do_app_delete=function(){var h=ui.get_app();ui.MessagePanel.doing("Deleting: "+h.get_display_name()+"...");h.t_delete().onready(function(j){ui.get_store().set_user_apps(j);ui.MessagePanel.info("Deleted app");q=null;ui.add_recent("apps",null,h.get_path());ui.do_choose_app()}).onerror(function(j,o){ui.MessagePanel.error(o?o:"Error deleting: "+h.get_display_name())})};
ui.do_app_apply_changes=function(h,j,o){for(var r=0;r<j.length;r++)ui.do_file_apply_change(h.files[j[r]]);ui.refresh_file_templates();o&&ui.do_app_save_all()};ui.do_file_create_new=function(h,j,o){if(ui.get_app().get_file(h))ui.MessagePanel.error("File with that name already exists");else{h=new AcreDoc(ui.get_app(),h,j,o);ui.do_choose_file(h.get_name())}};ui.do_file_set_acre_handler=function(h){var j=ui.get_file();if(h!==j.get_acre_handler()){j.set_acre_handler(h);ui.do_refresh_file()}};ui.do_file_set_mime_type=
function(h){var j=ui.get_file();if(h!==j.get_mime_type()){j.set_mime_type(h);ui.do_refresh_file()}};ui.do_file_save=function(h){var j=ui.get_file();if(j.is_dirty()){ui.MessagePanel.doing("Saving file: "+j.get_name()+"...");j.t_save(h).enqueue().onready(function(){ui.refresh_file_templates();ui.MessagePanel.info("File saved: "+j.get_name())}).onerror(function(o,r,t){if(o==="/api/status/error/upload/content_mismatch"){ui.MessagePanel.clear();ui.do_show_dialog("diff_patch",["save_conflict",t.info])}else if(o===
"/api/status/error/auth")ui.MessagePanel.error("You are not currently signed in.  To not lose your changes, sign in in a new tab or window and then try again.");else o==="/api/status/error/file_format/unsupported_mime_type"?ui.MessagePanel.error(r):ui.MessagePanel.error(r||"Error saving: "+j.get_name());ui.refresh_file_templates()})}};ui.do_file_save_as=function(h,j){var o=ui.get_file(),r=h==o.get_app().get_path()?o.get_app():new AcreApp(ui.get_store(),h),t={acre_handler:o.get_acre_handler(),content_type:o.get_mime_type(),
based_on:o.get_app().get_path()+"/"+mjt.freebase.mqlkey_quote(o.get_name())},u=new AcreDoc(r,j,t,o.get_editor_state());ui.MessagePanel.doing("Saving file as: "+j+"...");u.t_save().enqueue().onready(function(){r==ui.get_app()?ui.do_choose_file(u.get_name()):r.destroy();ui.MessagePanel.info("File created: "+j)}).onerror(function(x,C,w){w&&w.code=="/api/status/error/auth"?ui.MessagePanel.error("You are not currently signed in.  To not lose your changes, sign in in a new tab or window and then try again."):
ui.MessagePanel.error(C||"Error creating: "+j)})};ui.do_file_revert_to_saved=function(){ui.get_file().t_revert_to_saved().onready(function(){ui.do_refresh_file()})};ui.do_file_move=function(h,j){var o=ui.get_file(),r=o.get_name();if(h!=r)if(ui.get_app().get_file(h))ui.MessagePanel.error('The name "'+h+'" is already taken. Please choose a different name.',j);else{try{o.set_name(h)}catch(t){ui.MessagePanel.error(t,j);return}ui.do_choose_file(o.get_name())}};ui.do_file_delete=function(h){var j=h?ui.get_app().get_file(h):
ui.get_file();ui.MessagePanel.doing("Deleting file:"+j.get_name()+"...");j.t_delete().onready(function(){ui.MessagePanel.info("File deleted: "+j.get_name());f=null;ui.do_choose_file()}).onerror(function(o,r){ui.MessagePanel.error(r?r:"Error deleting: "+j.get_name())})};ui.do_file_apply_change=function(h,j){var o=h.file1,r=h.file2,t;if(o)if(r){t=ui.get_app().get_file(r.name);t.set_name(o.name);t.set_acre_handler(o.acre_handler);t.set_mime_type(o.content_type);if(h.patch){o=h.patch.text;if(t.is_editor_loaded())t.set_editor_state({text:o});
else{$("#file-area").append(t.get_element());t.t_editor_show("TextareaEditor",{margin:false},{text:o});t.hide()}}else o.content_id&&o.content_id!==r.content_id&&t.set_revision(o.content_id)}else{t={acre_handler:o.acre_handler,content_type:o.content_type,based_on:o.fileid};t=new AcreDoc(ui.get_app(),o.name,t,{text:o.text});t.hide()}else{t=ui.get_app().get_file(r.name);t.set_dirty("to_delete")}r&&r.name===ui.get_file().get_name()&&ui.do_refresh_file();j&&ui.do_file_save()};ui.do_file_editor_undo=function(){ui.get_file().editor_undo()};
ui.do_file_editor_redo=function(){ui.get_file().editor_redo()};ui.do_file_editor_goto_line=function(h){ui.get_file().editor_goto_line(h)};ui.do_file_editor_indent=function(){ui.get_file().editor_indent()};ui.get_file_check_options=function(){var h={bitwise:true,eqeqeq:true,forin:true,sub:true,undef:true,useful:1},j=["acre","JSON","XMLHttpRequest","console"];switch(ui.get_file().get_acre_handler()){case "mqlquery":break;case "acre_script":h.predef=j;h.es5=true;break;case "mjt":h.es5=true;h.useful=
0;h.predef=j;h.before_check=l;break;case "passthrough":h.browser=true;switch(ui.get_file().get_mime_type()){case "application/json":break;case "text/javascript":break;case "text/html":h.before_check=e;break;case "text/css":h.before_check=a;break;case "text/plain":h.useful=0;break;default:h.useful=-1;break}break;default:h.useful=-1;break}return h};ui.do_click_error=function(h){h=$(h.target);if(h.hasClass("jslint-error")){var j=h.attr("title");ui.MessagePanel.clear();j=(j+"").replace(/\&/g,"&amp;").replace(/</g,
"&lt;").replace(/>/g,"&gt;");ui.MessagePanel.error(j);h=h.text();ui.get_file().editor_goto_line(h)}};ui.do_file_check=function(){ui.do_hide_overlays();var h=$(".CodeMirror-line-numbers,.editor-margin-line-numbers",ui.get_file().get_element());$(">div.jslint-error",h).attr("title","").removeClass("jslint-error");ui.MessagePanel.clear();var j=ui.get_file_check_options();assert.critical(j,"missing jslint_options");var o=ui.get_file().get_editor_state().text;if(j.before_check)o=j.before_check(o);fb.get_script(fb.acre.libs.fulljslint,
function(){if(JSLINT(o,j))ui.MessagePanel.info("No syntax errors found");else{var r=JSLINT.errors,t="Found "+r.length+" errors.  Click any of the red line numbers below to see corresponding error details.",u=$(">div",h);if(u.length)for(var x=0;x<r.length;x++){var C=r[x];if(C){var w=u.eq(C.line-1);w.addClass("jslint-error");w.attr("title",w.attr("title")+" "+C.reason)}}else{r=r.slice(0,3);t=$.map(r,function(A){if(A)return"Line: "+A.line+" "+A.reason})}ui.MessagePanel.error(t);ui.get_file().editor_goto_line(r[0].line)}})};
ui.do_zen_coding=function(){if(ui.get_file().get_editor_name()==="CodeMirror"){var h=ui.get_file()._current_editor.editor,j=h.cursorPosition(),o=h.options.indentUnit,r=/(\s*)(.*)/.exec(h.lineContent(j.line));o=Math.floor(r[1].length/o);if(r=r[2]){r=zen.convert(r,o);if(r.error)ui.MessagePanel.error('Zen Coding syntax error in "'+mjt.htmlencode(r.error)+'".<br> See <a target="_blank" href="http://code.google.com/p/zen-coding/wiki/ZenHTMLSelectorsEn">ZenCoding</a> for help');else{ui.MessagePanel.info('Expanded <a target="_blank" href="http://code.google.com/p/zen-coding/wiki/ZenHTMLSelectorsEn">ZenCoding</a> expression');
h.setLineContent(j.line,r.out)}}}};var p={texteditor:"CodeMirror",syntax:navigator.userAgent.indexOf("iPad")===-1?true:false,margin:true,softwrap:false,dotTrigger:false,flw:200,t_mjt:true,t_acre_script:true,t_mqlquery:true,t_passthrough:true,t_binary:true,t_test:true,emql:false};ui.get_editor_prefs=function(h){function j(r){var t=$.localstore(r);return t===null?p[r]:t=="1"?true:t=="0"?false:t}if(h)return j(h);else{h={};for(var o in p)h[o]=j(o);return h}};ui.set_editor_prefs=function(h,j){var o;if(arguments.length==
1)o=h;else if(arguments.length==2){o={};o[h]=j}for(var r in o)$.localstore(r,o[r]===true?"1":o[r]===false?"0":o[r])};ui._get_desired_editor_classname=function(h){h=h||this.get_file();h=h.get_acre_handler();if(h=="binary")return"ImageEditor";else if(h=="mqlquery")return"QueryEditor";else{h=ui.get_editor_prefs("texteditor");return EDITORS[h]?h:p.texteditor}};ui._register_editor_event_handlers=function(h){h.register_editor_event_handlers({change:ui.editor_change_handler,linechange:ui.editor_linechange_handler,
newframe:ui.editor_newframe_handler})};ui.editor_change_handler=function(h,j){if(+new Date-c>6E4){c=+new Date;ui.do_status_check()}if(s!=ui.get_file().is_dirty()||h===0)ui.refresh_file_templates();if(h>0){ui._has_undos||$("#button-undo").removeAttr("disabled");ui._has_undos=true}else{ui._has_undos&&$("#button-undo").attr("disabled","disabled");ui._has_undos=false}if(j>0){ui._has_redos||$("#button-redo").removeAttr("disabled");ui._has_redos=true}else{ui._has_redos&&$("#button-redo").attr("disabled",
"disabled");ui._has_redos=false}};ui.editor_linechange_handler=function(h){g=h;$("#linenumber").val(h)};ui.editor_newframe_handler=function(h){ui.shortcut.register_keys(h.contentWindow?h.contentWindow.document:h.contentDocument)};ui.warn_user_about_unsaved_files=function(){if(ui&&ui.get_app()&&ui.get_app().is_dirty())return"You have unsaved files! The changes you made to these files will be lost if you leave this page."};ui.url_for=function(h){return fb.acre.request.base_path+"/"+h};ui.get_app_url=
function(h){return"http://"+h+ui.get_store().get_acre_host()};ui.get_appeditor_url=function(h,j){var o;if(typeof h=="string")o=h;else if(h instanceof AcreDoc){o=h.get_app().get_versioned_path();j=h.get_relative_path()}else if(h instanceof AcreApp)o=h.get_versioned_path();var r=window.location.protocol+"//"+window.location.host+window.location.pathname;if(o)r+="#!path="+o;if(j)r+="/"+j;return r};ui.id_to_path=function(h){return"//"+h.split("/").reverse().join(".")+"dev"};ui.get_human_timestamp=function(h){return mjt.freebase.date_from_iso(h).toLocaleString()};
ui.get_relative_timestamp=function(h){var j=new Date;h=mjt.freebase.date_from_iso(h);var o=j.getTime()-h.getTime();j=Math.floor(o/94608E7);h=Math.floor(o/2592E6);var r=Math.floor(o/864E5),t=Math.floor(o/36E5);o=Math.floor(o/6E4);if(j>0)return j===1?"1 year ago":j+" years ago";if(h>0)return h===1?"1 month ago":h+" months ago";if(r>0)return r===1?"1 day ago":r+" days ago";if(t>0)return t===1?"1 hour ago":t+" hours ago";if(o>0)return o===1?"1 minute ago":o+" minutes ago";if(o===0)return"less than a minute ago";
if(o<0)return"in the future???"};ui.order_section_files=function(h){var j={};h=h.get_files();for(var o in h){var r=h[o],t=r.get_name();r=r.get_acre_handler();r=r=="acre_script"&&t.substr(0,5)=="test_"?"test":r;if(typeof j[r]=="undefined")j[r]=[];j[r].push(t)}for(var u in j)j[u].sort(function(x,C){return x.localeCompare(C)});return j};ui.order_lib_files=function(h){var j=[];h=h.get_files();for(var o in h)j.push(h[o].get_name());j.sort(function(r,t){return r.localeCompare(t)});return j};ui.watch_inputs=
function(h,j){function o(){var C=false,w=j.inputs.length,A={};jQuery.each(j.inputs,function(E){var F,z=$("#"+E)[0];if(typeof z=="undefined")z=$("input[name='"+E+"']")[0];if(typeof z!="undefined"){if(z.tagName=="TEXTAREA")F=jQuery.trim($("#"+E).val());else if(z.tagName=="INPUT"){z=$(z).attr("type");if(z=="text")F=jQuery.trim($("#"+E).val());else if(z=="radio")F=$("input[name='"+E+"']:checked").val();else if(z=="checkbox")F=$("#"+E).attr("checked")}else if(z.tagName=="SELECT")F=$("#"+E+" :selected").val();
if(F!=j.inputs[E]){C=true;w-=1;A[E]=F}}});return j.activate_on=="all"?w===0?A:false:C?A:false}function r(){var C=o();if(C&&j.change){var w=j.change.apply(this,[C]);if(typeof w!=="undefined")C=w}C?$("#button-"+h).removeAttr("disabled").addClass("button-primary"):$("#button-"+h).attr("disabled","disabled").removeClass("button-primary")}function t(C){$("#"+C).bind("change",function(){r()})}function u(C){var w;$("#"+C).bind("keyup",function(){clearTimeout(w);w=setTimeout(r,j.text_delay||300)})}function x(C){$("input[name='"+
C+"']").bind("click",function(){r()})}jQuery.each(j.inputs,function(C,w){var A=$("#"+C)[0];if(typeof A=="undefined")A=$("input[name='"+C+"']")[0];if(typeof A!="undefined")if(A.tagName=="TEXTAREA")u(C,w);else if(A.tagName=="INPUT"){A=$(A).attr("type");if(A=="text")u(C);else A=="radio"?x(C):t(C)}else A.tagName=="SELECT"&&t(C)});$("#button-"+h).unbind("click").click(function(){var C=o();j.submit.apply(this,[C]);if(j.update_on_submit){jQuery.extend(j.inputs,C);r()}})};ui.populate_diff=function(h,j,o){function r(){var G=
h.parent().height()-C.height();A.height(G);E.height(G);z.height(G);y.height(G)}function t(){var G;if(j.file1||typeof j.file1==="undefined"){G=E.scrollTop();A.scrollTop(G)}else G=y.scrollTop();if(j.file2||typeof j.file2==="undefined"){z.scrollTop(G);y.scrollTop(G)}}function u(G,K,J,H){var D;D=J.length>1?"replace":J[0][0]==-1&&H==="left"?"delete":J[0][0]==1&&H==="right"?"insert":"eq";var L=$('<div class="line"></div>'),N=H==="left"?1:-1;if(J.length==1&&J[0][0]==N)L.append("<pre> </pre>");else{L.append($("<pre></pre>").text(v[H]));
J.length===1&&J[0][0]===N||(v[H]+=1)}G.append(L);G=$('<div class="code"></div>').addClass(D);D=$("<pre></pre>");L=false;for(N=0;N<J.length;N++){var M=J[N],O=M[1]===""?" ":M[1];switch(M[0]){case 0:L=true;M=$('<span class="text-eq"></span>').text(O);D.append(M);break;case 1:if(H==="right"){L=true;M=$('<span class="text-add"></span>').text(O);D.append(M)}break;case -1:if(H==="left"){L=true;M=$('<span class="text-delete"></span>').text(O);D.append(M)}break}}L||D.text(" ");G.append(D);K.append(G)}function x(G){G=
G.fileid.split("/");G.pop();return G.join("/")}var C=$('<div class="diff-header-container"></div>'),w=$('<div class="diff-header"></div>'),A=$('<div class="diff-line-container"></div>'),E=$('<div class="diff-code-container"></div>'),F=$('<div class="diff-header"></div>'),z=$('<div class="diff-line-container"></div>'),y=$('<div class="diff-code-container"></div>'),v={left:1,right:1};if(j.labels&&j.labels.length){if(j.labels[0]){o=$("<h3></h3>");o.text(j.labels[0]);F.append(o);C.append(F)}if(j.labels[1]){o=
$("<h3></h3>");o.text(j.labels[1]);w.append(o);C.append(w)}}else{if(j.file2){var B=$("<h3></h3>");if(!j.file1){F.addClass("full");y.addClass("full");B.append("Delete: ")}(j.file1&&j.file2?j.file1.name!==j.file2.name:false)&&B.addClass("change");B.append(j.file2.name);x(j.file2)!==ui.get_app().get_path()&&B.append(" in "+x(j.file2));var I=$("<h3></h3>");(j.file1&&j.file2?j.file1.handler!==j.file2.handler||j.file1.content_type!==j.file2.content_type:false)&&I.addClass("change");I.append(ui.get_store().get_acre_handlers()[j.file2.handler].name);
j.file2.content_type&&I.append(" ("+j.file2.content_type+")");F.append(B).append(I);if(o==="get_file_diff"){B=$("<h3></h3>");j.file2.last_modified&&B.append("Last Mod: "+ui.get_human_timestamp(j.file2.last_modified));F.append(B)}C.append(F)}if(j.file1){F=$("<h3></h3>");if(j.file2)o=="get_file_merge"&&F.append("After Merge: ");else{w.addClass("full");E.addClass("full");F.append("Create: ")}F.append(j.file1.name);o=="get_file_diff"&&x(j.file1)!==ui.get_app().get_path()&&F.append(" in "+x(j.file1));
B=$("<h3></h3>");B.append(ui.get_store().get_acre_handlers()[j.file1.handler].name);j.file1.content_type&&B.append(" ("+j.file1.content_type+")");w.append(F).append(B);if(o==="get_file_diff"){o=$("<h3></h3>");j.file1.last_modified&&o.append("Last Mod: "+ui.get_human_timestamp(j.file1.last_modified));w.append(o)}C.append(w)}}h.append(C);if(j.message)h.append($('<div class="message"></div>').text(j.message));else if(j.file1&&j.file2&&j.file1.content_id===j.file2.content_id)h.append('<div class="message">No change in content</div>');
else if(j.file2&&j.file2.binary||j.file1&&j.file1.binary){if(j.file2&&j.file2.binary){z.append("<pre> </pre>");y.append('<div class="image"><div class="image-preview"><img src="'+j.file2.binary+'" /></div></div>');h.append(z).append(y)}if(j.file1&&j.file1.binary){A.append("<pre> </pre>");E.append('<div class="image"><div class="image-preview"><img src="'+j.file1.binary+'" /></div></div>');h.append(A).append(E)}}else if(j.diff){for(w=0;w<j.diff.length;w++){o=j.diff[w];if(j.file2||typeof j.file2===
"undefined")u(z,y,o,"left");if(j.file1||typeof j.file1==="undefined")u(A,E,o,"right")}if(j.file2||typeof j.file2==="undefined"){z.append('<div class="line"><pre> </pre></div>');h.append(z).append(y);y.scroll(t)}if(j.file1||typeof j.file1==="undefined"){A.append('<div class="line"><pre> </pre></div>');h.append(A).append(E);E.scroll(t)}if((j.file1||typeof j.file1==="undefined")&&(j.file2||typeof j.file2==="undefined"))y.css("overflow-y","hidden")}r();$(window).resize(r)};ui.MessagePanel=function(){function h(t,
u,x){if(r&&r==="error")mjt.error("MessagePanel: Already displaying error. Ignoring: "+t+": "+u);else{$("#message-panel").hide().acre(fb.acre.apps.appeditor+"/templates.mjt","message_panel",[t,u,null]);r=t;window.clearTimeout(j);o=function(){$("#message-panel").empty();r=o=null};j=window.setTimeout(o,x);$("#message-panel").slideDown(300)}}var j,o,r;return{doing:function(t,u){h("doing",t,2E6,u);return""},info:function(t,u){h("info",t,4E3,u);return""},error:function(t,u){h("error",t,6E3,u);return""},
clear:function(){window.clearTimeout(j);o&&o()}}}();ui.shortcut={};(function(){var h=[{op:"Code Assist"},{op:"Open App",key:"O",action:function(){ui.do_show_menu("apps",[true])}},{op:"Save File",key:"S",action:function(){ui.do_file_save()}},{op:"View",key:"Shift-P",action:function(){ui.do_run_view(null,false)}},{op:"View with Console",key:"P",action:function(){ui.do_run_view(null,true)}},{op:"Undo",key:"Z",action:function(){ui.do_file_editor_undo()}},{op:"Redo",key:"Shift-Z",action:function(){ui.do_file_editor_redo()}},
{op:"Redo",key:"Y",action:function(){ui.do_file_editor_redo()}},{op:"Check Syntax",key:"Shift-C",action:function(){ui.do_file_check()}},{op:"Expand Expression",key:"E",action:function(){ui.do_zen_coding()}},{op:"Indent Selection",key:"Shift-I",action:function(){ui.do_file_editor_indent()}},{op:"Jump to Line",key:"J",action:function(){$("#linenumber").focus().select()}}],j=navigator.platform.indexOf("Mac")===0?"Meta":"Ctrl";ui.shortcut.register_keys=function(o){$.each(h,function(r,t){shortcut.add(j+
"-"+t.key,t.action,{target:o})})};ui.shortcut.get_shortcuts=function(){return h};ui.shortcut.get_keys=function(o){var r;if(o=="Code Assist")r=(navigator.platform.indexOf("Mac")===0?"Alt-":"Ctrl-")+"Space";else $.each(h,function(t,u){if(u.op==o)r=(navigator.platform.indexOf("Mac")===0?"&#8984;-":"Ctrl-")+u.key});return r}})()})();
$(document).ready(function(){if($.browser.msie&&$.browser.version<"8.0")assert.critical(false,"Internet Explorer 6 and 7 are not supported.  IE8+, Firefox 3+ and Safari 3+ are.Another option is to install <a href='http://www.google.com/chromeframe'>Google Chrome Frame</a>");else{ui.set_store(new FreebaseStore);var e=ui.get_store();e.t_init().onready(function(){ui.set_user(e.get_user());ui.init();e.TestCookies(e).enqueue().onerror(function(){ui.MessagePanel.error("Your browser configuration may not always let you see your latest changes when clicking <b>View</b> (third-party cookies).<br/><br/>Hold down the <b>Shift</b> key when clicking the browser <b>Refresh</b> button to ensure you're seeing the latest.")})}).onerror(function(b,
l,a){assert.critical(false,"Error connecting to Freebase<br/>"+l);mjt.error(b,l,a)})}});
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//2a.appeditor.www.tags.svn.freebase-site.googlecode.dev/templates.mjt",source:{def:function(){var e=function(){var b=this.tpackage,l=this.exports,a=b._template_fragments,m=b.runtime.new_markuplist(),n=0;m[n++]=a[0];var i=function(){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[1];b.runtime.ondomready(function(){var s=parseInt(ui.get_editor_prefs("flw"));$(window).resize(function(){$("#list-column").width(s);$("#file-margin").css("left",
s);$("#file-column").css("left",s+$("#file-margin").width());var d=$("#fixer"),c=d.offset(),p=$("#file-column").offset(),h=Math.max(c.top+d[0].offsetHeight,$(window).height())-Math.max(p.top,$("#header").height()+1);p=Math.max(c.left+d[0].offsetWidth,$(window).width())-p.left;var j=$("#file-area").offset();d=Math.max(c.top+d[0].offsetHeight,$(window).height())-j.top;$(".row").width(p);$(".column").height(h-1);$("#file-area").height(d-1);$("#file-list").height(d-$("#app-search").height()-$("#app-edits").height());
$(".refresh-right").show();ui.dialog&&ui.dialog.css("left",($(window).width()-ui.dialog.outerWidth())/2)});$("#file-margin").draggable({axis:"x",iframeFix:true,containment:[125,,400],drag:function(){s=$("#file-margin").offset().left;$(window).trigger("resize")},stop:function(){s=$("#file-margin").offset().left;ui.set_editor_prefs({flw:s});$(window).trigger("resize")}});$("#file-area").click(ui.do_click_error)},this);f[g++]=a[2];return f};i=b.runtime.tfunc_factory("body()",i,b,undefined,false);l.body=
i;i.source_microdata=null;m[n++]=a[3];i=function(f){var g=b.runtime.new_markuplist(),s=0;g[s++]=a[4];ui.get_store();ui.get_user();var d=ui.get_app();g[s++]=a[5];if(f=="open")g[s++]=a[6];else if(f=="loading")g[s++]=a[7];else{f=b.runtime.uniqueid("onclick");mjt._eventcb[f]=function(){ui.do_show_menu("appsettings")};g[s++]=a[8];g[s++]=b.runtime.make_attr_safe(f,false);g[s++]=a[9];g[s++]=d.get_display_name();g[s++]=a[10]}g[s++]=a[11];return g};i=b.runtime.tfunc_factory("header(state)",i,b,undefined,false);
l.header=i;i.source_microdata=null;m[n++]=a[12];i=function(){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[13];var s=ui.get_app(),d=s.is_author(),c=s.is_remote(),p=ui.get_user(),h=s.get_versions(),j=s.get_released_version(),o=s.get_version_label(),r=s.get_path(),t=s.get_versioned_path();j=j?r.replace("//","//release."):null;var u=h.length;if(j&&j!=t)u-=1;f[g++]=a[14];if(o){f[g++]=a[15];f[g++]=o;f[g++]=a[16]}else{f[g++]=a[17];o="Current";f[g++]=a[18]}f[g++]=a[19];if(c){f[g++]=a[20];f[g++]=s.get_acre_host();
f[g++]=a[21]}else if(d){f[g++]=a[22];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_choose_app(ui.get_app().get_path())};f[g++]=a[23];f[g++]=b.runtime.make_attr_safe(p,false);f[g++]=a[24];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_show_dialog("new_app",[true])};f[g++]=a[25];f[g++]=b.runtime.make_attr_safe(p,false);f[g++]=a[26]}else{f[g++]=a[27];s=b.runtime.uniqueid("onclick");mjt._eventcb[s]=function(){ui.do_show_dialog("new_app",[true])};f[g++]=a[28];d=p?{}:
{disabled:"disabled"};"class"in d||(f[g++]=a[29]);"id"in d||(f[g++]=a[30]);if(!("onclick"in d)){f[g++]=a[31];f[g++]=b.runtime.make_attr_safe(s,false);f[g++]=a[32]}for(var x in d){f[g++]=" "+x;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+d[x]);f[g++]=b.runtime.bless('"')}f[g++]=a[33];if(!p){f[g++]=a[34];f[g++]=b.runtime.make_attr_safe($("#nav-signin").attr("href"),true);f[g++]=a[35]}f[g++]=a[36]}f[g++]=a[37];if(h.length){f[g++]=a[38];if(j&&j!=t){f[g++]=a[39];f[g++]=b.runtime.make_attr_safe(j,
false);f[g++]=a[40];f[g++]=b.runtime.make_attr_safe(ui.get_appeditor_url(j),true);f[g++]=a[41]}f[g++]=a[42];if(o&&o!="Current"){f[g++]=a[43];f[g++]=b.runtime.make_attr_safe(r,false);f[g++]=a[44];f[g++]=b.runtime.make_attr_safe(ui.get_appeditor_url(r),true);f[g++]=a[45]}f[g++]=a[46];if(u>0){h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){return ui.do_show_menu("appsettings",["general"])};f[g++]=a[47];f[g++]=b.runtime.make_attr_safe(h,false);f[g++]=a[48]}f[g++]=a[49]}f[g++]=a[50];return f};
i=b.runtime.tfunc_factory("about_bar()",i,b,undefined,false);l.about_bar=i;i.source_microdata=null;m[n++]=a[51];i=function(){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[52];if(ui.get_app().is_writable()){var s=b.runtime.uniqueid("onclick");mjt._eventcb[s]=function(){ui.do_show_dialog("add_file")};f[g++]=a[53];f[g++]=b.runtime.make_attr_safe(s,false);f[g++]=a[54]}f[g++]=a[55];f[g++]=q();f[g++]=a[56];f[g++]=b.runtime.make_attr_safe(ui.get_app().get_acre_host(),false);f[g++]=a[57];f[g++]=b.runtime.make_attr_safe(ui.get_app().get_path(),
false);f[g++]=a[58];return f};i=b.runtime.tfunc_factory("list_column()",i,b,undefined,false);l.list_column=i;i.source_microdata=null;m[n++]=a[59];var q=function(){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[60];var s=false,d=ui.get_app().get_last_change();if(d)if(+new Date-mjt.freebase.date_from_iso(d.timestamp)<36E5)s=true;f[g++]=a[61];if(s){f[g++]=a[62];f[g++]=d.attribution.name;f[g++]=a[63];f[g++]=mjt.freebase.mqlkey_unquote(d.file);f[g++]=a[64];f[g++]=ui.get_relative_timestamp(d.timestamp);
f[g++]=a[65]}f[g++]=a[66];return f};q=b.runtime.tfunc_factory("app_edits()",q,b,undefined,false);l.app_edits=q;q.source_microdata=null;m[n++]=a[67];i=function(){function f(h,j){var o="file-list-item",r=ui.get_file()?ui.get_file().get_relative_path():null;if(h.get_relative_path()==r)o+=" selected-file";if(h.is_dirty("to_delete"))o+=" deleted-file";if(h.is_dirty())o+=" edited-file";ui.get_editor_prefs("t_"+j)||(o+=" hidden-file");return o}var g=b.runtime.new_markuplist(),s=0;g[s++]=a[68];var d=function(h,
j,o,r,t){var u=b.runtime.new_markuplist(),x=0;u[x++]=a[69];u[x++]=b.runtime.make_attr_safe(h,false);u[x++]=a[70];if(r){u[x++]=a[71];if(ui.get_editor_prefs("t_"+h)){u[x++]=a[72];u[x++]=b.runtime.make_attr_safe(h,false);u[x++]=a[73]}else{u[x++]=a[74];u[x++]=b.runtime.make_attr_safe(h,false);u[x++]=a[75]}u[x++]=a[76];if(t){u[x++]=a[77];u[x++]=b.runtime.make_attr_safe(o.get_path(),false);u[x++]=a[78];u[x++]=b.runtime.make_attr_safe(ui.get_appeditor_url(o.get_path()),true);u[x++]=a[79];u[x++]=j;u[x++]=
a[80]}else{u[x++]=a[81];u[x++]=j;u[x++]=a[82]}u[x++]=a[83]}u[x++]=a[84];b.runtime.foreach(this,r,function(C,w){for(var A=1;A;){if(r){u[x++]=a[85];var E={"class":f(o.get_file(w),h),fname:o.get_file(w).get_relative_path()};for(var F in E){u[x++]=" "+F;u[x++]=b.runtime.bless('="');u[x++]=b.runtime.htmlencode(""+E[F]);u[x++]=b.runtime.bless('"')}u[x++]=a[86];E=b.runtime.uniqueid("onclick");mjt._eventcb[E]=function(){ui.do_show_dialog("delete_file",[w])};u[x++]=a[87];var z=o.is_writable()?{"class":"file-delete"}:
{"class":"file-nodelete"};"class"in z||(u[x++]=a[88]);if(!("onclick"in z)){u[x++]=a[89];u[x++]=b.runtime.make_attr_safe(E,false);u[x++]=a[90]}for(var y in z){u[x++]=" "+y;u[x++]=b.runtime.bless('="');u[x++]=b.runtime.htmlencode(""+z[y]);u[x++]=b.runtime.bless('"')}u[x++]=a[91];u[x++]=b.runtime.make_attr_safe(ui.get_appeditor_url(o.get_file(w)),true);u[x++]=a[92];u[x++]=w;u[x++]=a[93]}A--}return A?b.runtime._break_token:b.runtime._continue_token});u[x++]=a[94];return u};d=b.runtime.tfunc_factory("filelist_section(section_key, section_name, app, filenames, link)",
d,b,undefined,false);d.source_microdata=null;g[s++]=a[95];var c=ui.get_app(),p=ui.order_section_files(c);g[s++]=a[96];b.runtime.foreach(this,ui.get_store().get_acre_handlers(),function(h,j){for(var o=1;o;){g[s++]=a[97];g[s++]=d(h,j.plural_name,c,p[h]);g[s++]=a[98];o--}return o?b.runtime._break_token:b.runtime._continue_token});g[s++]=a[99];if(p.test&&p.test.length){g[s++]=a[100];g[s++]=d("test","Tests",c,p.test);g[s++]=a[101]}g[s++]=a[102];b.runtime.ondomready(function(){$(".file-list-section-toggle").click(function(){var h=
$(this).attr("section");if($(this).text()=="\u25bc"){$(this).text("\u25ba");ui.set_editor_prefs("t_"+h,false);$("ul[section='"+h+"'] .file-list-item").addClass("hidden-file")}else{$(this).text("\u25bc");ui.set_editor_prefs("t_"+h,true);$("ul[section='"+h+"'] .file-list-item").removeClass("hidden-file")}});$("#file-list .file-list-item").click(function(h){if(!(h.ctrlKey||h.metaKey||h.altKey||h.shiftKey)){h=$(this).attr("fname");ui.do_choose_file(h);return false}})},this);g[s++]=a[103];return g};i=
b.runtime.tfunc_factory("file_list()",i,b,undefined,false);l.file_list=i;i.source_microdata=null;m[n++]=a[104];i=function(){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[105];var s=ui.get_app(),d=ui.get_file(),c=s?s.is_writable():false,p=d?d.get_editor_supported_features():false;p=p.margin||p.softwrap||p.hotswap||p.emql;var h=$("#button-fileactions").hasClass("button-open"),j=$("#button-editoroptions").hasClass("button-open");f[g++]=a[106];if(d){f[g++]=a[107];var o=b.runtime.uniqueid("onclick");mjt._eventcb[o]=
function(){ui.do_run_view(null,false)};f[g++]=a[108];var r=d.get_editor_supported_features("inline_preview")?{disabled:"disabled"}:{};"id"in r||(f[g++]=a[109]);if(!("title"in r)){f[g++]=a[110];f[g++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View")),false);f[g++]=a[111]}if(!("onclick"in r)){f[g++]=a[112];f[g++]=b.runtime.make_attr_safe(o,false);f[g++]=a[113]}for(var t in r){f[g++]=" "+t;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+r[t]);f[g++]=b.runtime.bless('"')}f[g++]=
a[114];t=b.runtime.uniqueid("onclick");mjt._eventcb[t]=function(){ui.do_run_view(null,true)};f[g++]=a[115];o=d.get_editor_supported_features("inline_preview")?{disabled:"disabled"}:{};"class"in o||(f[g++]=a[116]);"id"in o||(f[g++]=a[117]);if(!("title"in o)){f[g++]=a[118];f[g++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View with Console")),false);f[g++]=a[119]}if(!("onclick"in o)){f[g++]=a[120];f[g++]=b.runtime.make_attr_safe(t,false);f[g++]=a[121]}for(var u in o){f[g++]=" "+u;f[g++]=
b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+o[u]);f[g++]=b.runtime.bless('"')}f[g++]=a[122];u=b.runtime.uniqueid("onclick");mjt._eventcb[u]=function(){ui.do_file_save()};f[g++]=a[123];t=d.is_dirty()?{}:{disabled:"disabled"};"class"in t||(f[g++]=a[124]);"id"in t||(f[g++]=a[125]);if(!("title"in t)){f[g++]=a[126];f[g++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Save File")),false);f[g++]=a[127]}if(!("onclick"in t)){f[g++]=a[128];f[g++]=b.runtime.make_attr_safe(u,false);f[g++]=
a[129]}for(var x in t){f[g++]=" "+x;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+t[x]);f[g++]=b.runtime.bless('"')}f[g++]=a[130];x=b.runtime.uniqueid("onclick");mjt._eventcb[x]=function(){ui.do_app_save_all()};f[g++]=a[131];s=s.is_dirty()?{}:{disabled:"disabled"};"class"in s||(f[g++]=a[132]);"id"in s||(f[g++]=a[133]);if(!("onclick"in s)){f[g++]=a[134];f[g++]=b.runtime.make_attr_safe(x,false);f[g++]=a[135]}for(var C in s){f[g++]=" "+C;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+
s[C]);f[g++]=b.runtime.bless('"')}f[g++]=a[136];C=b.runtime.uniqueid("onclick");mjt._eventcb[C]=function(){ui.do_show_dialog("save_file_as")};f[g++]=a[137];s=!ui.get_user()||d.get_acre_handler()=="binary"?{disabled:"disabled"}:{};"class"in s||(f[g++]=a[138]);"id"in s||(f[g++]=a[139]);if(!("onclick"in s)){f[g++]=a[140];f[g++]=b.runtime.make_attr_safe(C,false);f[g++]=a[141]}for(var w in s){f[g++]=" "+w;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+s[w]);f[g++]=b.runtime.bless('"')}f[g++]=
a[142];w=b.runtime.uniqueid("onclick");mjt._eventcb[w]=function(){ui.do_file_editor_undo()};f[g++]=a[143];C=ui._has_undos?{}:{disabled:"disabled"};"class"in C||(f[g++]=a[144]);"id"in C||(f[g++]=a[145]);if(!("title"in C)){f[g++]=a[146];f[g++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Undo")),false);f[g++]=a[147]}if(!("onclick"in C)){f[g++]=a[148];f[g++]=b.runtime.make_attr_safe(w,false);f[g++]=a[149]}for(var A in C){f[g++]=" "+A;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+
C[A]);f[g++]=b.runtime.bless('"')}f[g++]=a[150];A=b.runtime.uniqueid("onclick");mjt._eventcb[A]=function(){ui.do_file_editor_redo()};f[g++]=a[151];w=ui._has_redos?{}:{disabled:"disabled"};"class"in w||(f[g++]=a[152]);"id"in w||(f[g++]=a[153]);if(!("title"in w)){f[g++]=a[154];f[g++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Redo")),false);f[g++]=a[155]}if(!("onclick"in w)){f[g++]=a[156];f[g++]=b.runtime.make_attr_safe(A,false);f[g++]=a[157]}for(var E in w){f[g++]=" "+E;f[g++]=b.runtime.bless('="');
f[g++]=b.runtime.htmlencode(""+w[E]);f[g++]=b.runtime.bless('"')}f[g++]=a[158];E=b.runtime.uniqueid("onclick");mjt._eventcb[E]=function(){ui.do_file_editor_indent()};f[g++]=a[159];c=d.get_editor_supported_features("indent")&&c?{}:{disabled:"disabled"};"id"in c||(f[g++]=a[160]);if(!("title"in c)){f[g++]=a[161];f[g++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Indent Selection")),false);f[g++]=a[162]}if(!("onclick"in c)){f[g++]=a[163];f[g++]=b.runtime.make_attr_safe(E,false);f[g++]=a[164]}for(var F in c){f[g++]=
" "+F;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+c[F]);f[g++]=b.runtime.bless('"')}f[g++]=a[165];F=b.runtime.uniqueid("onclick");mjt._eventcb[F]=function(){ui.do_show_menu("fileactions")};f[g++]=a[166];h=h?{"class":"button-open"}:{};"class"in h||(f[g++]=a[167]);"id"in h||(f[g++]=a[168]);if(!("onclick"in h)){f[g++]=a[169];f[g++]=b.runtime.make_attr_safe(F,false);f[g++]=a[170]}for(var z in h){f[g++]=" "+z;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+h[z]);f[g++]=b.runtime.bless('"')}f[g++]=
a[171];z=b.runtime.uniqueid("onclick");mjt._eventcb[z]=function(){ui.do_show_menu("editoroptions")};f[g++]=a[172];p=j?{"class":"button-open"}:p?{}:{disabled:"disabled"};"class"in p||(f[g++]=a[173]);"id"in p||(f[g++]=a[174]);if(!("onclick"in p)){f[g++]=a[175];f[g++]=b.runtime.make_attr_safe(z,false);f[g++]=a[176]}for(var y in p){f[g++]=" "+y;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+p[y]);f[g++]=b.runtime.bless('"')}f[g++]=a[177];y=b.runtime.uniqueid("onclick");mjt._eventcb[y]=function(){ui.do_show_menu("help")};
f[g++]=a[178];f[g++]=b.runtime.make_attr_safe(y,false);f[g++]=a[179];if(d.get_editor_supported_features("linenumbers")){f[g++]=a[180];f[g++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Jump to Line")),false);f[g++]=a[181];f[g++]=b.runtime.make_attr_safe(ui.get_line()||"",false);f[g++]=a[182]}f[g++]=a[183]}f[g++]=a[184];b.runtime.ondomready(function(){$("#linenumber").keypress(function(v){if(v.which==13){v=parseInt($("#linenumber").val(),10);ui.do_file_editor_goto_line(v)}})},this);f[g++]=
a[185];return f};i=b.runtime.tfunc_factory("button_bar()",i,b,undefined,false);l.button_bar=i;i.source_microdata=null;m[n++]=a[186];i=function(){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[187];var s=ui.get_app().is_writable();f[g++]=a[188];var d=b.runtime.uniqueid("onclick");mjt._eventcb[d]=function(){ui.get_file()._current_editor.query_run()};f[g++]=a[189];f[g++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View")),false);f[g++]=a[190];f[g++]=b.runtime.make_attr_safe(d,false);f[g++]=
a[191];d=b.runtime.uniqueid("onclick");mjt._eventcb[d]=function(){ui.get_file()._current_editor.query_assist()};f[g++]=a[192];var c=s?{}:{disabled:"disabled"};"title"in c||(f[g++]=a[193]);if(!("onclick"in c)){f[g++]=a[194];f[g++]=b.runtime.make_attr_safe(d,false);f[g++]=a[195]}for(var p in c){f[g++]=" "+p;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+c[p]);f[g++]=b.runtime.bless('"')}f[g++]=a[196];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.get_file()._current_editor.generate_template()};
f[g++]=a[197];s=s?{}:{disabled:"disabled"};if(!("onclick"in s)){f[g++]=a[198];f[g++]=b.runtime.make_attr_safe(p,false);f[g++]=a[199]}for(var h in s){f[g++]=" "+h;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+s[h]);f[g++]=b.runtime.bless('"')}f[g++]=a[200];return f};i=b.runtime.tfunc_factory("query_button_bar()",i,b,undefined,false);l.query_button_bar=i;i.source_microdata=null;m[n++]=a[201];n=function(f,g,s){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[202];d[c++]=b.runtime.make_attr_safe(f,
false);d[c++]=a[203];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+'"');d[c++]=a[204];d[c++]=b.runtime.make_attr_safe(f,false);d[c++]=a[205];d[c++]=g;d[c++]=a[206];d[c++]=s||"";d[c++]=a[207];b.runtime.ondomready(function(){$("#message-panel-close").click(function(){ui.MessagePanel.clear()})},this);d[c++]=a[208];return d};n=b.runtime.tfunc_factory("message_panel(type, msg, tid)",n,b,undefined,false);l.message_panel=n;n.source_microdata=null;return m};e.source_microdata=null;return e}(),
info:{file:"//2a.appeditor.www.tags.svn.freebase-site.googlecode.dev/templates.mjt",stringtable:["\n\n<!-- called by ui.init --\>",'\n  <div id="message-panel"></div>\n  <div id="about-bar"></div>\n  <div id="columns">\n    <div class="refresh column" id="list-column"></div>\n    <div class="refresh column" id="file-margin"></div>\n    <div class="column row" id="file-column">\n      <div class="refresh" id="button-bar"></div>\n      <div class="refresh" id="file-area"></div>\n    </div>\n  </div>',
"","\n\n<!-- called by ui.refresh_app_templates --\>    ","","",'\n  <p>\n    <span class="app-name">Acre App Editor</span>\n  </p>','\n  <p><span class="app-name">Loading...</span></p>','\n  <div class="app-name" id="button-appsettings" onclick="return mjt._eventcb.','.apply(this, [event])">\n    <p><span class="button-menu">',"</span></p>\n  </div>","","\n\n<!-- called by ui.refresh_app_templates --\>","",'\n  <div class="column left" id="about-bar-left">',"\n      <span>\n        Version ","\n      </span>",
"\n      <span>","\n        Current \n      </span>",'\n  </div>\n  <div class="column margin" id="about-bar-margin"> </div>\n  <div class="column row" id="about-bar-middle">',"\n    <div>\n      <h2><em>This app is hosted on ","</em></h2>\n    </div>","\n    <div>",'\n      <button class="button-primary" id="button-trunk" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Edit Current</button>\n      or','\n      <button id="button-clone" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Clone this App</button>      \n    </div>',
"\n    <div>","\n      <button",' class="button-primary"',' id="button-clone"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n        Clone this App</button> ",'\n        <span>\n          <a href="','" title="Sign in to your Freebase account">Sign in</a>\n        </span>'," \n        to make an app based on this one!\n    </div>",'\n    <div class="refresh-right" id="about-bar-right">',"\n      <span><b>\n        Versions:",'\n        <a apppath="','" class="app-link" href="','">Release</a>',
"",'\n        <a apppath="','" class="app-link" href="','">Current</a>',"",'\n        <a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">more...</a>',"\n      </b></span>","\n    </div>\n  </div>","","",'\n  <button id="button-new-file" onclick="return mjt._eventcb.','.apply(this, [event])">\n    New File</button>','\n  <h1>Files</h1>\n  \n  <div id="file-list"></div>\n  <div id="app-edits-shim">\n    ','\n  </div>\n  \n  <div id="app-search">\n    <form action="http://codesearch.',
'/" id="codesearch-form" target="_blank">\n      <div class="file-list-section-title">Find code in app:</div>\n      <input id="codesearch-app" name="app" type="hidden" value="','">\n      <input name="q" type="text" value="">\n    </form>\n  </div>',"","","",'\n    <div id="app-edits">\n      <div class="content">\n        <span class="file-list-section-title">Active Author: </span>\n        <span class="change">\n          '," edited '","' ","\n        </span>\n      </div>\n    </div>","","\n\n<!-- called by ui.refresh_file_templates --\>  ",
"",'\n    <ul section="','">','\n      <li class="file-list-section-header">','\n        <span class="file-list-section-toggle" section="','">\u25bc</span>','\n        <span class="file-list-section-toggle" section="','">\u25ba</span>',"",'\n        <a apppath="','" class="file-list-section-title app-link" href="','">',"</a>",'\n        <span class="file-list-section-title">',"</span>","\n      </li>","","\n      <li",">","\n          <div",' class="file-delete"',' onclick="return mjt._eventcb.',
'.apply(this, [event])"','></div>\n          <a href="','">',"</a>\n      </li>","\n    </ul>","","","\n\n  <div>\n    ","\n  </div>","","\n  <div>\n    ","\n  </div>","","","\n\n<!-- called by ui.refresh_file_templates --\>  ","",'\n    <div id="file-buttons">','\n      <div>\n      <div class="refresh-right" id="file-buttons-right">\n        <!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>',"\n        <button",' id="button-view"',' title="','"',' onclick="return mjt._eventcb.',
'.apply(this, [event])"',">\n          View</button>","\n        <button",' class="button-primary"',' id="button-preview"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"','>\n          View with Console</button>\n      </div>\n      <span class="buttonset">\n        <!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>',"\n        <button",' class="button-left button-primary"',' id="button-save"',' title="','"',' onclick="return mjt._eventcb.',
'.apply(this, [event])"',">\n          Save\n        </button>","<button",' class="button-middle"',' id="button-saveall"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n          Save All\n        </button>","<button",' class="button-right"',' id="button-save"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n          Save As</button>","\n        <button",' class="button-left"',' id="button-undo"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"',
">\n          Undo\n        </button>","<button",' class="button-right"',' id="button-redo"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n          Redo</button>","\n        <button",' id="button-indent"',' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"','>\n          Indent\n        </button>\n      </span>\n      <span class="buttonset">',"\n       <button",' class="button-left"',' id="button-fileactions"',' onclick="return mjt._eventcb.','.apply(this, [event])"',
'>    \n          <span class="button-menu">File</span></button>',"<button",' class="button-middle"',' id="button-editoroptions"',' onclick="return mjt._eventcb.','.apply(this, [event])"','>\n          <span class="button-menu">Editor</span></button>','<button class="button-right" id="button-help" onclick="return mjt._eventcb.','.apply(this, [event])">\n          <span class="button-menu">Help</span></button>\n      </span>\n      <span class="buttoncount">\n        <!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>',
'\n        <span class=" buttonset linecount">\n          Line <input class="form-textbox" id="linenumber" title="','" type="text" value="','">\n        </span>',"\n      </span>\n    </div>","","\n  </div>","",'<div id="query-editor-buttons">',"\n  <!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>",'\n  <button class="button-primary" title="','" onclick="return mjt._eventcb.','.apply(this, [event])">\n    Run</button>',"\n  <button",' title="Tab"',' onclick="return mjt._eventcb.',
'.apply(this, [event])"',">Query Assist</button>","\n  <button",' onclick="return mjt._eventcb.','.apply(this, [event])"',">Create Template</button>\n</div>","\n\n<!-- utilities --\>  ",'<div class="message-','"','>\n  <!--<span id="message-panel-close">x</span>--\>\n  <div class="message-icon ','"></div>','\n  <span class="message-tid">',"</span>","\n</div>"],debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,18,18,18,18,18,18,18,18,18,18,18,18,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,
40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,68,68,68,68,68,70,70,70,70,70,70,71,71,72,73,74,75,76,76,78,78,78,78,78,79,79,79,79,80,80,80,80,80,80,80,81,81,81,82,82,82,83,83,83,83,83,83,86,86,86,86,86,86,87,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,103,103,104,104,104,104,105,105,105,106,107,107,107,110,110,110,110,113,113,113,113,113,114,114,114,114,115,115,115,116,117,117,117,117,117,117,117,117,120,120,120,120,120,120,120,120,120,122,122,122,122,
123,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,126,126,126,127,127,127,127,128,128,128,130,130,130,130,132,132,132,134,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,136,136,136,136,136,136,136,136,136,136,137,137,137,140,140,140,140,140,140,140,140,142,142,142,142,143,143,143,143,143,143,143,143,144,144,144,149,149,149,149,149,149,149,153,153,153,153,153,153,155,155,155,155,159,159,159,159,159,159,159,159,159,161,161,161,
161,162,162,163,164,165,166,167,168,169,170,170,174,174,174,174,174,174,174,174,174,174,174,177,177,177,177,177,178,178,178,178,178,178,181,181,181,181,181,181,183,183,183,183,184,184,184,185,185,186,186,186,186,186,186,186,186,187,187,187,187,187,187,189,189,189,189,189,189,189,189,189,189,189,190,190,190,190,190,190,191,191,191,193,193,193,193,193,193,193,193,193,193,193,193,193,193,193,194,194,194,194,194,194,194,194,194,194,194,194,194,194,194,194,194,194,194,194,195,195,195,195,195,196,196,196,
196,196,196,196,198,198,198,198,198,198,200,200,201,202,203,204,205,206,207,208,209,210,211,212,213,215,215,215,215,216,216,216,216,216,217,217,217,217,217,217,218,218,219,219,219,219,220,220,220,222,222,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,247,247,247,247,247,249,249,249,249,249,249,250,250,251,252,253,254,255,256,257,258,259,260,262,262,262,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,
266,266,266,266,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,269,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,275,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,
284,284,284,284,284,284,284,284,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,296,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,299,299,299,299,299,299,299,304,304,304,304,304,304,305,305,305,305,305,
305,306,306,306,308,308,308,308,309,309,309,310,311,312,313,314,315,316,317,319,319,319,319,319,319,319,320,320,320,320,321,321,322,323,325,325,325,325,325,325,325,325,325,325,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,331,331,331,331,331,331,331,334,334,334,334,334,334,334,334,334,334,336,336,336,336,336,336,337,337,337,338,338,338,339,340,341,342,343,344,344,344,344,344,344,344,344,344,
344],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//2a.appeditor.www.tags.svn.freebase-site.googlecode.dev/dialogs.mjt",source:{def:function(){var e=function(){var b=this.tpackage,l=this.exports,a=b._template_fragments,m=b.runtime.new_markuplist(),n=0;m[n++]=a[0];var i=function(q){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[1];var s=b.runtime.uniqueid("onclick");mjt._eventcb[s]=function(){ui.do_choose_app(q)};f[g++]=a[2];f[g++]=b.runtime.make_attr_safe(s,false);f[g++]=
a[3];return f};i=b.runtime.tfunc_factory("files_dirty(new_app)",i,b,undefined,false);l.files_dirty=i;i.source_microdata=null;m[n++]=a[4];i=function(q){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[5];if(q){f[g++]=a[6];f[g++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);f[g++]=a[7];f[g++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);f[g++]=a[8];q=b.runtime.uniqueid("onclick");mjt._eventcb[q]=function(){ui.do_show("new_app")};f[g++]=a[9];f[g++]=b.runtime.make_attr_safe(q,
false);f[g++]=a[10];q=b.runtime.uniqueid("onclick");mjt._eventcb[q]=function(){ui.do_show_menu("yourapps")};f[g++]=a[11];f[g++]=b.runtime.make_attr_safe(q,false);f[g++]=a[12]}else{f[g++]=a[13];f[g++]=b.runtime.make_attr_safe($("#nav-signin").attr("href"),true);f[g++]=a[14];f[g++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);f[g++]=a[15];f[g++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);f[g++]=a[16]}f[g++]=a[17];return f};i=b.runtime.tfunc_factory("welcome(is_user)",
i,b,undefined,false);l.welcome=i;i.source_microdata=null;m[n++]=a[18];i=function(q){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[19];var s=q?ui.get_app().get_display_name()+" copy":"",d=q?ui.get_app().get_name()+"-copy":"";f[g++]=a[20];var c=q?{}:{checked:"checked"};"id"in c||(f[g++]=a[21]);"name"in c||(f[g++]=a[22]);"type"in c||(f[g++]=a[23]);"value"in c||(f[g++]=a[24]);for(var p in c){f[g++]=" "+p;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+c[p]);f[g++]=b.runtime.bless('"')}f[g++]=
a[25];c=q?{checked:"checked"}:{};"id"in c||(f[g++]=a[26]);"name"in c||(f[g++]=a[27]);"type"in c||(f[g++]=a[28]);"value"in c||(f[g++]=a[29]);for(var h in c){f[g++]=" "+h;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+c[h]);f[g++]=b.runtime.bless('"')}f[g++]=a[30];h=q?{}:{style:"display:none"};"id"in h||(f[g++]=a[31]);for(var j in h){f[g++]=" "+j;f[g++]=b.runtime.bless('="');f[g++]=b.runtime.htmlencode(""+h[j]);f[g++]=b.runtime.bless('"')}f[g++]=a[32];f[g++]=b.runtime.make_attr_safe(q?
ui.get_app().get_versioned_path():"",false);f[g++]=a[33];f[g++]=b.runtime.make_attr_safe(s,false);f[g++]=a[34];f[g++]=b.runtime.make_attr_safe(d,false);f[g++]=a[35];f[g++]=ui.get_user().get_new_app_host();f[g++]=a[36];b.runtime.ondomready(function(){$("#new-app-dialog-name").focus().select();$("#dialog-new_app input[name='new-app']").change(function(){$("#new-app-clone-field").toggle()});$("#new-app-clone-id").suggest({type:"/freebase/apps/acre_app"}).bind("fb-select",function(o,r){$(this).val(ui.id_to_path(r.id))});
$("#button-new-app").click(function(){var o=[ui.get_user().get_new_app_path($.trim($("#new-app-dialog-key").val())),$.trim($("#new-app-dialog-name").val())],r=$("#dialog-new_app input[name='new-app']:checked").val(),t=$("#new-app-clone-id").val();r=="clone"&&t!==""&&o.push(t);ui.do_app_create_new.apply(this,o)})},this);f[g++]=a[37];return f};i=b.runtime.tfunc_factory("new_app(clone)",i,b,undefined,false);l.new_app=i;i.source_microdata=null;m[n++]=a[38];i=function(){var q=b.runtime.new_markuplist(),
f=0;q[f++]=a[39];q[f++]=ui.get_app().get_display_name();q[f++]=a[40];var g=b.runtime.uniqueid("onclick");mjt._eventcb[g]=function(){ui.do_app_delete()};q[f++]=a[41];q[f++]=b.runtime.make_attr_safe(g,false);q[f++]=a[42];return q};i=b.runtime.tfunc_factory("delete_app()",i,b,undefined,false);l.delete_app=i;i.source_microdata=null;m[n++]=a[43];i=function(){var q=b.runtime.new_markuplist(),f=0;q[f++]=a[44];var g=function(s){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[45];ui.app_keys={};$.each(s,function(){ui.app_keys[this.appid]=
this.files});d[c++]=a[46];d[c++]=b.runtime.make_attr_safe(ui.get_file().get_name(),false);d[c++]=a[47];b.runtime.foreach(this,s,function(p,h){for(var j=1;j;){d[c++]=a[48];var o=ui.get_app().get_path()==h.path?{selected:true}:{};if(!("value"in o)){d[c++]=a[49];d[c++]=b.runtime.make_attr_safe(h.path,false);d[c++]=a[50]}for(var r in o){d[c++]=" "+r;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+o[r]);d[c++]=b.runtime.bless('"')}d[c++]=a[51];d[c++]=h.name;d[c++]=a[52];j--}return j?b.runtime._break_token:
b.runtime._continue_token});d[c++]=a[53];b.runtime.ondomready(function(){$("#clone-filename").focus().select();$("#button-clone").click(function(){var p=$.trim($("#clone-filename").val()),h=$.trim($("#clone-file-app :selected").val());if($.inArray(p,ui.app_keys[h])==-1){ui.do_file_save_as(h,p);ui.do_hide_overlays()}else ui.MessagePanel.error("File exists!  Try a different file name.")})},this);d[c++]=a[54];return d};g=b.runtime.tfunc_factory("save_file_applist(applist)",g,b,undefined,false);g.source_microdata=
null;q[f++]=a[55];b.runtime.ondomready(function(){ui.get_store().XhrGet("list_user_apps",{include_filenames:true}).enqueue().onready(function(s){$("#applist").acre(g(s))})},this);q[f++]=a[56];return q};i=b.runtime.tfunc_factory("save_file_as()",i,b,undefined,false);l.save_file_as=i;i.source_microdata=null;m[n++]=a[57];i=function(){var q=b.runtime.new_markuplist(),f=0;q[f++]=a[58];var g=ui.get_app().get_untitled_file_name();q[f++]=a[59];var s=function(d){var c=b.runtime.new_markuplist(),p=0;c[p++]=
a[60];var h=ui.get_store().get_supported_mime_types(d);c[p++]=a[61];c[p++]=b.runtime.make_attr_safe(g,false);c[p++]=a[62];if(h.length>1&&d!="binary"){c[p++]=a[63];b.runtime.foreach(this,h,function(j,o){for(var r=1;r;){c[p++]=a[64];var t=o=="text/plain"?{selected:""}:{};if(!("value"in t)){c[p++]=a[65];c[p++]=b.runtime.make_attr_safe(o,false);c[p++]=a[66]}for(var u in t){c[p++]=" "+u;c[p++]=b.runtime.bless('="');c[p++]=b.runtime.htmlencode(""+t[u]);c[p++]=b.runtime.bless('"')}c[p++]=a[67];c[p++]=o;
c[p++]=a[68];r--}return r?b.runtime._break_token:b.runtime._continue_token});c[p++]=a[69]}c[p++]=a[70];b.runtime.ondomready(function(){$("#add-file-name").select().keydown(function(j){j.which==13&&$("#button-add-file").click()});ui.watch_inputs(null,{inputs:{"add-file-name":null},change:function(j){g=j["add-file-name"]}})},this);c[p++]=a[71];return c};s=b.runtime.tfunc_factory("show_handler(handler)",s,b,undefined,false);s.source_microdata=null;q[f++]=a[72];b.runtime.foreach(this,ui.get_store().get_acre_handlers(),
function(d,c){for(var p=1;p;){q[f++]=a[73];q[f++]=b.runtime.make_attr_safe(c.key,false);q[f++]=a[74];q[f++]=b.runtime.make_attr_safe(c.key,false);q[f++]=a[75];q[f++]=c.name;q[f++]=a[76];q[f++]=c.description;q[f++]=a[77];p--}return p?b.runtime._break_token:b.runtime._continue_token});q[f++]=a[78];b.runtime.ondomready(function(){ui.watch_inputs("add-file",{inputs:{"new-file-handler":null},change:function(d){d=d["new-file-handler"];$(".handler-new").empty();$("#handler-"+d+" .handler-new").acre(s(d));
$(".handler-section-active").removeClass("handler-section-active");$("#handler-"+d).addClass("handler-section-active")},submit:function(d){var c=$.trim($("#add-file-name").val());if(ui.get_store().validate_filename(c)){d={acre_handler:d["new-file-handler"]};if($("#add-file-mimetype :selected").val())d.content_type=$("#add-file-mimetype :selected").val();ui.do_file_create_new(c,d);ui.do_hide_overlays()}else ui.MessagePanel.error("Invalid filename.  Only alphanumeric characters, '-', '_' and '.' are allowed.")}});
$("input[name='new-file-handler'][value='mjt']").attr("checked","checked").trigger("click")},this);q[f++]=a[79];return q};i=b.runtime.tfunc_factory("add_file()",i,b,undefined,false);l.add_file=i;i.source_microdata=null;m[n++]=a[80];i=function(q){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[81];f[g++]=q;f[g++]=a[82];f[g++]=q;f[g++]=a[83];var s=b.runtime.uniqueid("onclick");mjt._eventcb[s]=function(){ui.do_file_delete(q)};f[g++]=a[84];f[g++]=b.runtime.make_attr_safe(s,false);f[g++]=a[85];return f};
i=b.runtime.tfunc_factory("delete_file(filename)",i,b,undefined,false);l.delete_file=i;i.source_microdata=null;m[n++]=a[86];i=function(q,f){var g=b.runtime.new_markuplist(),s=0;g[s++]=a[87];var d=function(z,y){var v=b.runtime.new_markuplist(),B=0;v[B++]=a[88];if(this.subst_id)v[B++]=b.runtime.bless(' id="'+this.subst_id+'"');v[B++]=a[89];var I=z[0]||{},G=false,K=false,J=false;if(I.revision)if(I.file)K=true;else J=true;else G=true;I=ui.get_file().get_based_on();v[B++]=a[90];if(J&&I){v[B++]=a[91];v[B++]=
ui.get_file().get_name();v[B++]=a[92];v[B++]=b.runtime.make_attr_safe(ui.get_store().get_url(),true);v[B++]=a[93];v[B++]=b.runtime.make_attr_safe(I.id,false);v[B++]=a[94];v[B++]=I.id;v[B++]=a[95]}v[B++]=a[96];if(G)v[B++]=a[97];v[B++]=a[98];if(K)v[B++]=a[99];v[B++]=a[100];if(J)v[B++]=a[101];v[B++]=a[102];if(K||J)v[B++]=a[103];v[B++]=a[104];if(G)v[B++]=a[105];v[B++]=a[106];if(K)v[B++]=a[107];v[B++]=a[108];if(J)v[B++]=a[109];v[B++]=a[110];if(K||J)v[B++]=a[111];v[B++]=a[112];b.runtime.foreach(this,z,
function(H,D){for(var L=1;L;){v[B++]=a[113];var N;if(G)N=D.as_of_time;if(K||J)N=D.timestamp;v[B++]=a[114];v[B++]=b.runtime.make_attr_safe(N,false);v[B++]=a[115];v[B++]=b.runtime.make_attr_safe(N,false);v[B++]=a[116];if(G){v[B++]=a[117];v[B++]=D.name;v[B++]=a[118]}v[B++]=a[119];if(K){v[B++]=a[120];v[B++]=mjt.freebase.mqlkey_unquote(D.file);v[B++]=a[121]}v[B++]=a[122];v[B++]=mjt.freebase.date_from_iso(D.as_of_time||D.timestamp).toLocaleString();v[B++]=a[123];if(J){v[B++]=a[124];v[B++]=D.length;v[B++]=
a[125]}v[B++]=a[126];if(K||J){v[B++]=a[127];v[B++]=D.attribution.name;v[B++]=a[128]}v[B++]=a[129];L--}return L?b.runtime._break_token:b.runtime._continue_token});v[B++]=a[130];b.runtime.ondomready(function(){function H(){$("input[name='diff-from'], input[name='diff-to']").removeAttr("disabled");var D=$("input[name='diff-to']").index($("input[name='diff-to']:checked")[0]),L=$("input[name='diff-from']").index($("input[name='diff-from']:checked")[0]);$("input[name='diff-to']").slice(0,L+1).attr("disabled",
"disabled");$("input[name='diff-from']").slice(D).attr("disabled","disabled")}$("#dialog-diff_patch input, .show-revision, .revert-revision, .diff-button").unbind("click");H();$("input[name='diff-from'], input[name='diff-to']").click(function(){$(".button-patch").attr("disabled","disabled");var D={timestamp1:$("input[name='diff-to']:checked").val(),timestamp2:$("input[name='diff-from']:checked").val()};if(G||K){$("#diff-filelist-shim").acre(p(true));$("#diff-view-shim").acre(j());D.appid1=y;D.appid2=
y;ui.get_store().XhrGet("get_app_diff",D).enqueue().onready(function(L){$("#diff-filelist-shim").acre(p(L))})}if(J){D.fileid1=y;D.fileid2=y;ui.get_store().XhrGet("get_file_diff",D).enqueue().onready(function(L){$("#diff-view-shim").acre(j(L,"get_file_diff"));$("#button-file-revert, #button-file-revert-save").removeAttr("disabled").unbind("click");$("#button-file-revert").click(function(){ui.do_file_apply_change(L)});$("#button-file-revert-save").click(function(){ui.do_file_apply_change(L,true)})})}H()})},
this);v[B++]=a[131];return v};d=b.runtime.tfunc_factory("revision_list(history, id)",d,b,undefined,false);d.source_microdata=null;g[s++]=a[132];var c=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[133];y[v++]=p(z);y[v++]=a[134];return y};c=b.runtime.tfunc_factory("filelist_shim(patch)",c,b,undefined,false);c.source_microdata=null;g[s++]=a[135];var p=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[136];if(z&&z.files){y[v++]=a[137];ui.get_app().get_path();var B=[];if($.isArray(z.files))B=
z.files;else for(key in z.files)B.push(key);B.sort(function(K,J){return K.localeCompare(J)});y[v++]=a[138];var I=function(K,J){var H=b.runtime.new_markuplist(),D=0;H[D++]=a[139];if(J){H[D++]=a[140];if(q!=="app_diff"){H[D++]=a[141];var L=J==="update"?{checked:"checked"}:{};"type"in L||(H[D++]=a[142]);for(var N in L){H[D++]=" "+N;H[D++]=b.runtime.bless('="');H[D++]=b.runtime.htmlencode(""+L[N]);H[D++]=b.runtime.bless('"')}H[D++]=a[143]}H[D++]=a[144];L=q==="app_diff"?{"class":"diff-filelist-stub"}:{};
"href"in L||(H[D++]=a[145]);for(var M in L){H[D++]=" "+M;H[D++]=b.runtime.bless('="');H[D++]=b.runtime.htmlencode(""+L[M]);H[D++]=b.runtime.bless('"')}H[D++]=a[146];H[D++]=mjt.freebase.mqlkey_unquote(K);H[D++]=a[147]}else{H[D++]=a[148];H[D++]=mjt.freebase.mqlkey_unquote(K);H[D++]=a[149]}H[D++]=a[150];switch(J){case "add":H[D++]=a[151];break;case "delete":H[D++]=a[152];break;case "conflict":H[D++]=a[153];break;case "update":H[D++]=a[154];break}H[D++]=a[155];return H};I=b.runtime.tfunc_factory("diff_file(fn, status)",
I,b,undefined,false);I.source_microdata=null;y[v++]=a[156];var G=b.runtime.uniqueid("onclick");mjt._eventcb[G]=function(){$("#diff-filelist input").attr("checked","checked")};y[v++]=a[157];y[v++]=b.runtime.make_attr_safe(G,false);y[v++]=a[158];G=b.runtime.uniqueid("onclick");mjt._eventcb[G]=function(){$("#diff-filelist input").removeAttr("checked")};y[v++]=a[159];y[v++]=b.runtime.make_attr_safe(G,false);y[v++]=a[160];b.runtime.foreach(this,B,function(K,J){for(var H=1;H;){y[v++]=a[161];y[v++]=b.runtime.make_attr_safe(J,
false);y[v++]=a[162];y[v++]=mjt.freebase.mqlkey_unquote(J);y[v++]=a[163];H--}return H?b.runtime._break_token:b.runtime._continue_token});y[v++]=a[164];b.runtime.ondomready(function(){var K=$("#diff-filelist .file-list-item").length;$("#diff-filelist .file-list-item").each(function(){function J(M,O,P){$(H).acre(I(D,M)).click(function(){$("#diff-filelist .file-list-item").removeClass("selected-file");$(H).addClass("selected-file");$("#diff-view-shim").acre(O.apply(this,P))});K-=1;if(K===0){$(".button-patch").removeAttr("disabled");
$("#diff-filelist .file-list-item input").click(function(Q){Q.stopPropagation()})}}var H=$(this),D=$(H).attr("data-fn"),L,N={};switch(q){case "app_history":case "app_diff":L="get_file_diff";N={fileid1:z.files[D].file1?z.files[D].file1.fileid:undefined,fileid2:z.files[D].file2?z.files[D].file2.fileid:undefined,timestamp1:z.app1?z.app1.timestamp:undefined,timestamp2:z.app2?z.app2.timestamp:undefined};break;case "merge_changes":L="get_file_merge";N={fileid1:z.files[D].file1?z.files[D].file1.fileid:undefined,
fileid2:z.files[D].file2?z.files[D].file2.fileid:undefined};break}ui.get_store().XhrGet(L,N).enqueue().onready(function(M){z.files[D]=M;status=M.file1?M.file2?M.patch&&M.patch.conflict==true?"conflict":"update":"add":"delete";J(status,j,[z.files[D],L])}).onerror(function(M,O,P){J(false,o,[O,P])})})},this);y[v++]=a[165]}else if(z)y[v++]=a[166];else y[v++]=a[167];y[v++]=a[168];b.runtime.ondomready(function(){$(".patch-apply, .patch-apply-save").unbind("click");$(".patch-apply, .patch-apply-save").click(function(){var K=
[];$("#diff-filelist input:checked").each(function(){var J=$(this).closest(".file-list-item").attr("data-fn");K.push(J)});ui.do_app_apply_changes(z,K,$(this).hasClass("patch-apply-save"))})},this);y[v++]=a[169];return y};p=b.runtime.tfunc_factory("filelist(patch)",p,b,undefined,false);p.source_microdata=null;g[s++]=a[170];var h=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[171];y[v++]=j(z);y[v++]=a[172];return y};h=b.runtime.tfunc_factory("diff_view_shim(diff)",h,b,undefined,false);h.source_microdata=
null;g[s++]=a[173];var j=function(z,y){var v=b.runtime.new_markuplist(),B=0;v[B++]=a[174];if(z){v[B++]=a[175];b.runtime.ondomready(function(){ui.populate_diff($("#diff-view"),z,y)},this);v[B++]=a[176]}else v[B++]=a[177];v[B++]=a[178];return v};j=b.runtime.tfunc_factory("diff_view(data, method)",j,b,undefined,false);j.source_microdata=null;g[s++]=a[179];var o=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[180];y[v++]=z;y[v++]=a[181];return y};o=b.runtime.tfunc_factory("merge_error(msg, info)",
o,b,undefined,false);o.source_microdata=null;g[s++]=a[182];var r=function(){var z=b.runtime.new_markuplist(),y=0;z[y++]=a[183];var v=function(){var B=b.runtime.new_markuplist(),I=0;B[I++]=a[184];B[I++]=c();B[I++]=a[185];B[I++]=h();B[I++]=a[186];return B};v=b.runtime.tfunc_factory("history_diff()",v,b,undefined,false);v.source_microdata=null;z[y++]=a[187];if(w)z[y++]=a[188];z[y++]=a[189];if(w)z[y++]=a[190];z[y++]=a[191];b.runtime.ondomready(function(){function B(I){$("#revision-list-shim").empty().addClass("loader-square");
(I=="versions"?mjt.Succeed(ui.get_app().get_versions()):ui.get_app().t_get_history()).enqueue().onready(function(G){$("#revision-list-shim").removeClass("loader-square").acre(d(G.history||G,ui.get_app().get_path()));$("#history-diff").acre(v());$(".button-patch").attr("disabled","disabled")})}$('input[name="app-history"]').change(function(){B($(this).val())});B("versions")},this);z[y++]=a[192];return z};r=b.runtime.tfunc_factory("app_history(t)",r,b,undefined,false);r.source_microdata=null;g[s++]=
a[193];var t=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[194];y[v++]=c(z);y[v++]=a[195];y[v++]=h();y[v++]=a[196];return y};t=b.runtime.tfunc_factory("app_diff(diff)",t,b,undefined,false);t.source_microdata=null;g[s++]=a[197];var u=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[198];y[v++]=d(z.history,z.fileid);y[v++]=a[199];y[v++]=h();y[v++]=a[200];if(w)y[v++]=a[201];y[v++]=a[202];if(w)y[v++]=a[203];y[v++]=a[204];return y};u=b.runtime.tfunc_factory("file_history(t)",u,b,undefined,
false);u.source_microdata=null;g[s++]=a[205];var x=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[206];y[v++]=c(z);y[v++]=a[207];y[v++]=h();y[v++]=a[208];if(w)y[v++]=a[209];y[v++]=a[210];if(w)y[v++]=a[211];y[v++]=a[212];return y};x=b.runtime.tfunc_factory("merge_changes(patch)",x,b,undefined,false);x.source_microdata=null;g[s++]=a[213];var C=function(z){var y=b.runtime.new_markuplist(),v=0;y[v++]=a[214];z.labels=["Saved Copy","Your Local Version"];y[v++]=a[215];y[v++]=j(z,"get_file_diff");
y[v++]=a[216];z=b.runtime.uniqueid("onclick");mjt._eventcb[z]=function(){ui.do_file_save(true)};y[v++]=a[217];y[v++]=b.runtime.make_attr_safe(z,false);y[v++]=a[218];return y};C=b.runtime.tfunc_factory("save_conflict(diff)",C,b,undefined,false);C.source_microdata=null;g[s++]=a[219];var w=ui.get_app().is_writable(),A,E,F;switch(q){case "app_history":A="App History";E=mjt.Succeed(ui.get_app().get_versions());F=r;break;case "app_diff":r=ui.get_app().get_versions()[0];A="View changes since version "+r.name;
E=ui.get_store().XhrGet("get_app_diff",{appid1:ui.get_app().get_path(),appid2:ui.get_app().get_path(),timestamp2:r.as_of_time});F=t;break;case "file_history":A="File History";E=ui.get_file().t_get_history();F=u;break;case "merge_changes":A="View changes from "+f.appid;E=ui.get_store().XhrGet("get_app_diff",{appid1:f.appid,appid2:ui.get_app().get_path()});F=x;break;case "save_conflict":A="File Save Conflict";E=mjt.Succeed(f);F=C;break}g[s++]=a[220];g[s++]=A;g[s++]=a[221];b.runtime.ondomready(function(){E.enqueue().onready(function(z){$("#diff-dialog").acre(F(z))})},
this);g[s++]=a[222];return g};i=b.runtime.tfunc_factory("diff_patch(mode, opts)",i,b,undefined,false);l.diff_patch=i;i.source_microdata=null;m[n++]=a[223];i=function(){var q=b.runtime.new_markuplist(),f=0;q[f++]=a[224];b.runtime.foreach(this,ui.shortcut.get_shortcuts(),function(g,s){for(var d=1;d;){q[f++]=a[225];q[f++]=mjt.bless(ui.shortcut.get_keys(s.op));q[f++]=a[226];q[f++]=s.op;q[f++]=a[227];d--}return d?b.runtime._break_token:b.runtime._continue_token});q[f++]=a[228];return q};i=b.runtime.tfunc_factory("keyboard_shortcuts()",
i,b,undefined,false);l.keyboard_shortcuts=i;i.source_microdata=null;m[n++]=a[229];i=function(){var q=b.runtime.new_markuplist(),f=0;q[f++]=a[230];q[f++]=fb.acre.appeditor.version;q[f++]=a[231];q[f++]=ui.get_store().get_acre_version();q[f++]=a[232];return q};i=b.runtime.tfunc_factory("about_appeditor()",i,b,undefined,false);l.about_appeditor=i;i.source_microdata=null;m[n++]=a[233];i=function(q){var f=b.runtime.new_markuplist(),g=0;f[g++]=a[234];var s=b.runtime.uniqueid("onclick");mjt._eventcb[s]=function(){ui.do_hide_overlays()};
f[g++]=a[235];f[g++]=b.runtime.make_attr_safe(q,true);f[g++]=a[236];f[g++]=b.runtime.make_attr_safe(s,false);f[g++]=a[237];f[g++]=b.runtime.make_attr_safe(q,false);f[g++]=a[238];return f};i=b.runtime.tfunc_factory("documentation(url)",i,b,undefined,false);l.documentation=i;i.source_microdata=null;m[n++]=a[239];return m};e.source_microdata=null;return e}(),info:{file:"//2a.appeditor.www.tags.svn.freebase-site.googlecode.dev/dialogs.mjt",stringtable:["\n\n<!-- Dirty files dialog --\>",'\n  <h3 class="dialog-title">Abandon Changes?</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <p>You haven\'t saved all the changes you made to the app you currently have open. <b>Abandon these changes?</b></p>\n    </div>\n  </div>\n  <div class="button-bar">\n    <button class="button-primary exit">No</button>',
'\n    <button class="exit" onclick="return mjt._eventcb.','.apply(this, [event])">\n      Yes, abandon changes and switch apps</button>\n  </div>',"\n\n\n<!-- New user dialog --\>",'\n  <div id="welcome-panel">\n    <div class="acre-logo">\n      <img alt="Acre: Open Code for Open Data" border="0" height="47" src="/static/2a.appeditor.www.tags/logo-acre.png" width="211">\n    </div>\n    <div>','\n      <ul>\n        <li><em>See what you can build!</em><br>\n          <small>Check out <a class="exit" href="',
'/apps" target="_new">the App Directory</a> or <a class="exit" href="','/docs/acre" target="_new">the documentation</a>.</small>\n        </li>\n        <li><em>Ready to go?</em><br>\n          <small></small>','<button id="button-newapp" onclick="return mjt._eventcb.','.apply(this, [event])"><small>Create a New App</small></button> ','<button id="button-yourapps" onclick="return mjt._eventcb.','.apply(this, [event])">\n            <span class="button-menu">Choose from Your Apps</span></button>\n        </li>\n      </ul>',
'\n      <ul>  \n        <li><em>Create your own Acre app</em><br>\n          <small><a href="','" title="Sign in to your Freebase account">Sign in or Sign Up</a>\n          for Freebase to get started.</small>\n        </li>\n        <li><em>See what you can build!</em><br>\n          <small>Check out <a class="exit" href="','/apps" target="_new">the App Directory</a> or <a class="exit" href="','/docs/acre" target="_new">the documentation</a>.</small>\n        </li>\n      </ul>',"\n    </div>\n  </div>",
"\n\n\n<!-- App action dialogs --\>","",'\n  <h3 class="dialog-title">Create New App</h3>\n  <div class="dialog-content">\n    <fieldset>\n      <div class="dialog-inset">\n        <div class="dialog-inset-header">\n          <input',' id="new-app-create"',' name="new-app"',' type="radio"',' value="create"','>\n          <label for="new-app-create">Create a new app</label>\n          <input',' id="new-app-clone"',' name="new-app"',' type="radio"',' value="clone"','>\n          <label for="new-app-clone">Clone an existing app</label>\n          <span',
' id="new-app-clone-field"','>: \n            <input class="longfield" id="new-app-clone-id" type="text" value="','">\n          </span>\n        </div>\n        <div class="form-row">\n          <label for="new-app-dialog-name">Name your App: </label>\n          <input id="new-app-dialog-name" maxlength="50" type="text" value="','">\n        </div>\n        <div class="form-row wide">\n          <label for="new-app-dialog-key">Choose a URL: </label>      \n          <span class="url">http://<input class="shortfield" id="new-app-dialog-key" maxlength="20" minlength="5" size="15" type="text" value="',
'">.','</span>\n        </div>\n        <div class="form-tip">      \n          This URL points to the development version of your code.\n          Later you can choose a shorter Release URL to share with others.\n        </div>\n      </div>\n    </fieldset>\n\n    <div class="cc-callout">\n      <a class="cc-logo" href="http://creativecommons.org/licenses/BSD/"><img alt="CC-BSD" src="/static/2a.appeditor.www.tags/cc-bsd.png"></a>\n      <div class="cc-about">\n        All Acre apps are published on Freebase under the\n        <a href="http://creativecommons.org/licenses/BSD/">BSD license</a>\n        so everyone can "view source", clone code, and learn from each other.\n      </div>\n    </div>\n  </div>\n\n  <div class="button-bar">\n    <button class="button-primary exit" id="button-new-app">Create</button>\n    <button class="exit">Cancel</button>\n  </div>',
"","",'\n  <h3 class="dialog-title">Delete app \u201c','\u201d?</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <p>\n        Are you sure you want to <b>delete this entire app</b>?\n      </p>\n      <p>\n        This can\'t be undone!\n      </p>\n    </div>\n  </div>\n  <div class="button-bar">','\n    <button class="button-primary exit" onclick="return mjt._eventcb.','.apply(this, [event])">Delete App</button>\n    <button class="exit">Cancel</button>\n  </div>',"  \n\n\n<!-- File action dialogs --\>",
'\n  <h3 class="dialog-title">Save File As</h3>\n  <div class="dialog-content" id="applist">\n    <span class="loader-square"></span>\n  </div>',"",'\n    <div class="dialog-inset">\n      <fieldset>\n        <div class="form-row">\n          <label for="clone-filename">New file name: </label>\n          <input id="clone-filename" type="text" value="','">\n        </div>\n        <div class="form-row">\n          <label for="clone-file-app">In app: </label>\n          <select id="clone-file-app">',
"\n            <option",' value="','"',">\n              ","\n            </option>",'\n          </select>\n        </div>\n      </fieldset>\n    </div>\n    <div class="button-bar">\n      <button class="button-primary" id="button-clone">Save</button>\n      <button class="exit">Cancel</button>\n    </div>',"","","","","",'\n  <h3 class="dialog-title">Create a New...</h3>',"",'\n  \n    <div class="form-row">\n      <label for="add-file-name">New file name:</label>\n      <input id="add-file-name" type="text" value="',
'">\n    </div>','\n  \n    <div>\n      <div class="form-row">\n        <label for="add-file-mimetype">MIME type: </label>\n        <select id="add-file-mimetype">',"\n          <option",' value="','"',">\n            ","</option>","\n        </select>\n      </div>\n    </div>","","",'\n  \n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <fieldset>\n        <ul>','\n          <li class="handler-section" id="handler-','">\n            <h4><input name="new-file-handler" type="radio" value="',
'"> ',"</h4>\n            <p>",'</p>\n            <div class="handler-new"></div>\n          </li>','\n        </ul>\n      </fieldset>\n    </div>\n  </div>\n  <div class="button-bar">\n    <button class="button-primary" id="button-add-file">Create New File</button>\n    <button class="exit">Cancel</button>\n  </div>',"","",'\n  <h3 class="dialog-title">Delete file \u201c','\u201d?</h3>\n  <div class="dialog-content">\n  <div class="dialog-inset">\n    <p>\n      Are you sure you want to delete the file \u201c<b>',
'</b>\u201d?\n    </p>\n    <p>\n      This can\'t be undone!\n    </p>\n  </div>\n  </div>\n  <div class="button-bar">','\n    <button class="button-primary exit" onclick="return mjt._eventcb.','.apply(this, [event])">Delete File</button>\n    <button class="exit">Cancel</button>\n  </div>',"  \n  \n\n<!-- Diff/Patch dialogs --\>","","<div",'>\n    <div class="revision-list">',"","\n      <p>\n        <b>",'</b> is based on:\n        <a class="external-link" href="',"/view",'" target="_blank">',
"</a>\n      </p>",'              \n      <table class="item-list">\n        <thead>\n          <tr>\n            <th>Compare</th>','\n            <th class="left">Version</th>',"",'\n            <th class="left">File</th>','\n            <th class="left">Date</th>',"\n            <th>Length</th>","",'\n            <th class="left">By</th>','\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td class="center">\n              <span>\n                <input checked="checked" name="diff-from" type="radio" value=""> |\n                <input checked="checked" name="diff-to" type="radio" value="">\n              </span>\n            </td>\n            <td><b><i>Current</i></b></td>',
"\n            <td></td>","","\n            <td></td>","","\n            <td></td>","","\n            <td></td>","\n          </tr>",'\n          <tr>\n            <td class="center">\n              <span>','\n                <input name="diff-from" type="radio" value="','"> |\n                <input name="diff-to" type="radio" value="','">\n              </span>\n            </td>',"\n            <td>","</td>","","\n            <td>","</td>",'\n            <td>\n              <span class="last_mod">\n                ',
"\n              </span>\n            </td>",'\n            <td class="center">',"</td>","","\n            <td>","</td>","\n          </tr>","\n        </tbody>\n      </table>\n    </div>","\n  </div>","\n      \n  <!-- Used when the filelist needs to be dynamically updated --\>",'<div id="diff-filelist-shim">\n    ',"\n  </div>","",'<div id="diff-filelist">',"","","","\n        <span>","\n          <input",' type="checkbox"',">","\n          <a",' href="#0"',">\n            ","</a>\n        </span>",
'\n        <span class="diff-filelist-stub">\n          <i>',"</i>\n        </span>","",'<span class="file-merge-status">+</span>','<span class="file-merge-status">-</span>','<span class="file-merge-status error-alert">!</span>','<span class="file-merge-status"></span>',"","\n      <p>\n        Select: ",'<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">All</a> | ','\n        <a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">None</a>\n      </p>\n      <ul>','\n        <li class="file-list-item" data-fn="',
'">\n          <span class="diff-filelist-stub">',"</span>\n        </li>","\n      </ul>","",'\n    <span class="loader-square"></span>',"\n    <p>Pick revisions above to see changed files</p>","","\n  </div>","\n\n  <!-- Used when the diff view needs to be dynamically updated --\>",'<div id="diff-view-shim">\n    ',"\n  </div>","",'<div class="diff" id="diff-view">',"","","\n    <p>Click on a file or revision to see the changes.</p>","\n  </div>","",'<div id="diff-error-view">\n    <div class="message">',
"</div>\n  </div>","\n      \n  <!-- Main content for each mode --\>    ",'\n    <div class="dialog-content">\n      <fieldset id="apphistory-mode">\n        <div class="radiogroup">\n          <h5>\n            <input checked="checked" name="app-history" type="radio" value="versions">\n            Versions\n          </h5>\n        </div>\n        <div class="radiogroup">\n          <h5>\n            <input name="app-history" type="radio" value="all-changes">\n            Edits\n          </h5>\n        </div>\n      </fieldset>\n      <div class="diff-top">\n        <div id="revision-list-shim"></div>\n      </div>\n      <div class="diff-bottom-short" id="history-diff"></div>',
"\n        ",'\n        <div class="diff-area-files">',"</div>",'\n    </div>\n    <div class="button-bar">','\n      <button class="button-patch patch-apply button-primary exit" disabled="disabled">Revert to Right</button>',"        ",'\n      <button class="button-patch patch-apply-save exit" disabled="disabled">Revert &amp; Save</button>','\n      <button class="exit">Done</button>\n    </div>',"","",'\n    <div class="dialog-content">\n      <div class="diff-bottom-tall">\n        ','\n        <div class="diff-area-files">',
'</div>\n      </div>\n    </div>\n    <div class="button-bar">\n      <button class="exit">Done</button>\n    </div>',"",'\n    <div class="dialog-content">\n      <div class="diff-top">\n        ','\n      </div>\n      <div class="diff-bottom-short">\n        <div class="diff-area-full diff-area-short">','</div>\n      </div>\n    </div>\n    <div class="button-bar">','\n      <button class="button-primary exit" disabled="disabled" id="button-file-revert">Revert to Right</button>',"",'\n      <button class="exit" disabled="disabled" id="button-file-revert-save">Revert &amp; Save</button>',
'        <button class="exit">Done</button>\n    </div>',"",'\n    <div class="dialog-content">\n      <div class="diff-bottom-tall">\n        ','\n        <div class="diff-area-files">','</div>\n      </div>\n    </div>\n    <div class="button-bar">','\n      <button class="button-patch patch-apply button-primary exit" disabled="disabled">Apply Selected Changes</button>',"",'\n      <button class="button-patch patch-apply-save exit" disabled="disabled">Apply &amp; Save</button>','\n      <button class="exit">Done</button>\n    </div>',
"","",'\n    <div class="dialog-content">\n      <div class="diff-top">\n        <p>\n          The saved version of this file has changed since it was loaded, likely because \n          it was edited by another user or by you in another browser or tab.  \n        </p>\n        <p>\n          Decide how to proceed or view the details of the conflict.\n        </p>\n      </div>\n      <div class="diff-bottom-short">\n        <div class="diff-area-full">','</div>\n      </div>\n    </div>\n    <div class="button-bar">',
'\n      <button class="button exit" onclick="return mjt._eventcb.','.apply(this, [event])">Save Anyway</button>\n      <button class="button-primary exit">Cancel</button>\n    </div>',"\n   \n  <!-- Setup the dialog for all modes --\>",'\n  \n  <h3 class="dialog-title">','</h3>\n  <div id="diff-dialog">\n    <span class="loader-square"></span>\n  </div>',"","\n\n\n<!-- Help dialogs --\>",'\n  <h3 class="dialog-title">App Editor Keyboard Shortcuts</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <table>',
"\n        <tr>\n          <!-- mjt.bless is being used so HTML entities for system control characters \n              can be printed. These are all declared in ui.shortcut --\>\n          <th>","</th>\n          <td>","</td>\n        </tr>","\n      </table>\n    </div>\n  </div>","",'\n  <h3 class="dialog-title">About App Editor</h3>\n  <iframe class="dialog-content" id="dialog-aboutappeditor" src="/appeditor/license.html"></iframe>\n  <div class="button-bar">\n    <b>Version: </b>\n    <span>',
"</span>\n    <span>- ","</span>\n  </div>","","",'\n  <a class="doc-view-link" href="','" target="_blank" onclick="return mjt._eventcb.','.apply(this, [event])">Open in a new window</a>\n  <iframe class="dialog-content" src="','"></iframe>',""],debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,19,19,19,19,19,19,19,19,23,23,23,23,23,23,23,29,29,29,29,29,29,29,31,31,31,31,31,31,31,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,37,37,37,37,37,38,40,40,40,40,40,44,44,44,
44,44,44,44,44,46,46,46,46,49,49,49,49,49,49,49,49,53,53,53,53,53,53,53,54,54,55,56,57,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,67,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,73,73,73,73,73,73,73,77,77,77,77,77,77,77,77,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,
125,126,127,127,127,127,127,127,128,128,128,128,129,129,129,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,144,144,144,144,144,144,144,144,148,148,148,148,148,148,148,154,154,154,154,154,154,154,154,155,155,156,157,158,159,160,165,165,165,165,165,165,165,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,172,172,172,173,173,173,173,173,173,182,182,182,182,182,182,182,182,182,182,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,
197,198,198,198,198,198,199,199,199,200,201,202,203,204,205,206,207,208,208,208,208,208,208,209,209,209,209,210,210,211,212,215,215,215,215,215,216,216,217,218,222,222,222,222,222,222,225,225,225,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,231,231,231,231,231,231,231,231,234,234,234,234,234,236,236,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,253,253,253,253,258,258,258,258,258,258,258,258,258,258,258,258,259,259,259,259,259,
260,260,260,262,262,262,262,262,262,262,272,272,272,272,272,272,272,272,272,272,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,304,304,304,304,304,305,305,305,305,306,306,306,310,310,310,310,310,310,318,318,318,318,318,318,318,318,318,318,318,318,318,318,321,321,321,321,321,321,321,321,326,326,326,326,326,326,326,328,328,328,328,328,328,330,330,330,331,332,333,334,335,336,337,338,339,339,340,340,340,340,341,341,341,
341,341,341,341,342,342,342,347,347,347,347,347,347,347,347,347,348,348,348,348,348,350,350,350,350,350,350,351,351,351,351,351,363,363,363,363,363,363,363,363,363,363,363,363,363,363,363,363,364,364,364,364,364,365,365,365,365,365,366,366,366,366,366,368,368,368,368,368,371,371,371,371,371,372,373,374,375,376,376,376,377,377,377,380,380,380,380,380,380,380,380,380,381,381,381,381,381,381,381,384,384,384,384,384,387,387,387,387,387,387,387,387,387,388,388,388,388,388,388,388,389,389,389,389,389,389,
393,393,393,393,393,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,446,446,446,446,446,448,448,448,448,448,448,449,449,449,450,450,450,450,450,450,452,452,452,452,453,453,454,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,468,468,468,469,469,470,470,470,470,470,470,470,470,470,470,470,470,470,470,470,470,470,471,471,471,
471,471,471,471,471,471,471,471,471,472,472,472,473,473,473,474,475,475,475,475,476,476,476,477,477,477,478,478,478,479,479,479,480,480,480,481,481,481,482,482,482,482,482,485,485,485,485,485,485,485,485,486,486,486,486,486,486,486,489,489,489,489,489,489,489,489,489,490,490,490,491,491,491,491,491,491,493,493,493,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,
540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,556,556,556,556,556,557,557,557,557,558,558,558,559,560,561,562,563,564,565,566,567,568,569,570,570,570,570,570,570,572,572,572,572,572,572,573,573,573,574,574,574,574,574,574,576,576,576,576,577,577,578,578,578,579,580,581,582,582,582,582,582,582,583,583,583,583,583,583,585,585,585,585,586,586,586,587,587,587,587,587,587,590,590,590,590,590,590,610,610,610,610,610,610,610,610,610,610,610,610,610,610,610,610,610,610,610,610,610,610,
610,611,611,611,612,612,612,613,613,613,613,613,616,616,616,616,616,616,616,617,617,617,617,617,620,620,620,620,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,640,640,640,640,641,641,641,641,644,644,644,644,644,645,645,645,651,651,651,651,651,651,651,651,651,651,653,653,653,653,656,656,656,656,656,659,659,659,659,659,663,663,663,663,663,663,663,663,664,664,664,664,664,666,666,666,666,666,666,668,668,668,668,671,671,671,671,671,672,672,672,676,676,676,676,676,676,
676,676,677,677,677,677,677,680,680,680,680,680,680,680,682,682,682,682,683,683,684,685,697,697,697,697,697,697,697,697,697,697,697,697,697,697,701,701,701,701,701,701,701,701,701,701,704,704,704,704,704,704,704,707,707,707,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,740,740,740,740,744,744,744,744,744,744,745,746,747,748,749,751,751,751,751,751,751,754,754,754,754,754,754,754,759,759,759,759,759,759,759,759,762,762,
762,762,762,762,763,763,763,764,764,764,764,764,764,768,768,768,768,768,768,768,768,768,770,770,770,770,775,775,775,775,775,775,775,776,776,776,778,778,778,778,778,778,778,780,780,780,780,781,781,781,781,781,781,781,781,781,782,782,782,783,783,783,783,783,783,784,784,784,784],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//2a.appeditor.www.tags.svn.freebase-site.googlecode.dev/menus.mjt",source:{def:function(){var e=function(){var b=this.tpackage,l=this.exports,a=b._template_fragments,m=b.runtime.new_markuplist(),n=0;m[n++]=a[0];var i=function(d){var c=b.runtime.new_markuplist(),p=0;c[p++]=a[1];var h=ui.get_user(),j=ui.get_recents("apps"),o=Math.min(j.length,10);c[p++]=a[2];if(h){h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_show_dialog("new_app")};
c[p++]=a[3];c[p++]=b.runtime.make_attr_safe(h,false);c[p++]=a[4]}c[p++]=a[5];h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_acre_home_link("/apps")};c[p++]=a[6];c[p++]=b.runtime.make_attr_safe(h,false);c[p++]=a[7];if(ui.get_user())c[p++]=a[8];else{c[p++]=a[9];c[p++]=b.runtime.make_attr_safe($("#nav-signin").attr("href"),true);c[p++]=a[10]}c[p++]=a[11];if(o>0){c[p++]=a[12];for(h=0;h<o;h++){c[p++]=a[13];var r=j[h],t=r.path.match(/\.dev\.([a-z0-9\.\-]*)\.$/);t=t?t[1]:null;c[p++]=a[14];
c[p++]=b.runtime.make_attr_safe(r.path,false);c[p++]=a[15];c[p++]=b.runtime.make_attr_safe(ui.get_appeditor_url(r.path),true);c[p++]=a[16];c[p++]=b.runtime.make_attr_safe(r.path,false);c[p++]=a[17];c[p++]=r.name;c[p++]=a[18];if(t){c[p++]=a[19];c[p++]=t;c[p++]=a[20]}c[p++]=a[21]}c[p++]=a[22]}else c[p++]=a[23];c[p++]=a[24];b.runtime.ondomready(function(){ui.do_setup_submenu("your-apps-menu-item","yourapps");d&&$("#your-apps-menu-item").trigger("mouseenter")},this);c[p++]=a[25];return c};i=b.runtime.tfunc_factory("apps(auto_open)",
i,b,undefined,false);l.apps=i;i.source_microdata=null;m[n++]=a[26];i=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[27];var p=ui.get_store().get_user_apps();ui.get_store().t_refresh_user_apps();d[c++]=a[28];if(p.length===0)d[c++]=a[29];else{d[c++]=a[30];b.runtime.foreach(this,p,function(h,j){for(var o=1;o;){d[c++]=a[31];d[c++]=b.runtime.make_attr_safe(j.path,false);d[c++]=a[32];d[c++]=b.runtime.make_attr_safe(ui.get_appeditor_url(j.path),true);d[c++]=a[33];d[c++]=b.runtime.make_attr_safe(j.path,
false);d[c++]=a[34];d[c++]=j.name;d[c++]=a[35];o--}return o?b.runtime._break_token:b.runtime._continue_token});d[c++]=a[36]}d[c++]=a[37];b.runtime.ondomready(function(){var h=$("#menu-yourapps"),j=Math.min(h.height(),$(window).height()-h.offset().top-25);h.height(j).css("visibility","visible");$("#your-apps-loader").hide()},this);d[c++]=a[38];return d};i=b.runtime.tfunc_factory("yourapps()",i,b,undefined,false);l.yourapps=i;i.source_microdata=null;m[n++]=a[39];i=function(){var d=b.runtime.new_markuplist(),
c=0;d[c++]=a[40];var p=ui.get_app(),h=ui.get_file();ui.get_user();p=p?p.is_writable():false;d[c++]=a[41];if(p){d[c++]=a[42];d[c++]=b.runtime.make_attr_safe(ui.get_file().get_name(),false);d[c++]=a[43];if(p)d[c++]=a[44];d[c++]=a[45]}d[c++]=a[46];if(p){d[c++]=a[47];var j=function(){var w=b.runtime.new_markuplist(),A=0;w[A++]=a[48];if(this.subst_id)w[A++]=b.runtime.bless(' id="'+this.subst_id+'"');w[A++]=a[49];var E=ui.get_store().get_acre_handlers(),F=[];for(var z in E)$.inArray(h.get_mime_type(),ui.get_store().get_supported_mime_types(z))!=
-1&&F.push(E[z]);E=ui.get_store().get_supported_mime_types(h.get_acre_handler());w[A++]=a[50];z=F.length>1?{}:{disabled:"disabled"};"id"in z||(w[A++]=a[51]);for(var y in z){w[A++]=" "+y;w[A++]=b.runtime.bless('="');w[A++]=b.runtime.htmlencode(""+z[y]);w[A++]=b.runtime.bless('"')}w[A++]=a[52];b.runtime.foreach(this,F,function(B,I){for(var G=1;G;){w[A++]=a[53];var K=I.key===h.get_acre_handler()?{selected:""}:{};if(!("value"in K)){w[A++]=a[54];w[A++]=b.runtime.make_attr_safe(I.key,false);w[A++]=a[55]}for(var J in K){w[A++]=
" "+J;w[A++]=b.runtime.bless('="');w[A++]=b.runtime.htmlencode(""+K[J]);w[A++]=b.runtime.bless('"')}w[A++]=a[56];w[A++]=I.name;w[A++]=a[57];G--}return G?b.runtime._break_token:b.runtime._continue_token});w[A++]=a[58];F=!h.get_editor_supported_features("mimetype_change")||E.length<2?{}:{};"id"in F||(w[A++]=a[59]);for(var v in F){w[A++]=" "+v;w[A++]=b.runtime.bless('="');w[A++]=b.runtime.htmlencode(""+F[v]);w[A++]=b.runtime.bless('"')}w[A++]=a[60];b.runtime.foreach(this,E,function(B,I){for(var G=1;G;){w[A++]=
a[61];var K=I===h.get_mime_type()?{selected:""}:{};if(!("value"in K)){w[A++]=a[62];w[A++]=b.runtime.make_attr_safe(I,false);w[A++]=a[63]}for(var J in K){w[A++]=" "+J;w[A++]=b.runtime.bless('="');w[A++]=b.runtime.htmlencode(""+K[J]);w[A++]=b.runtime.bless('"')}w[A++]=a[64];w[A++]=I;w[A++]=a[65];G--}return G?b.runtime._break_token:b.runtime._continue_token});w[A++]=a[66];b.runtime.ondomready(function(){$("#file-handler").change(function(){ui.do_file_set_acre_handler($(":selected",this).val());$("#metadata-section").acre(j())});
$("#file-mimetype").change(function(){ui.do_file_set_mime_type($(":selected",this).val());$("#metadata-section").acre(j())})},this);w[A++]=a[67];return w};j=b.runtime.tfunc_factory("metadata_section()",j,b,undefined,false);j.source_microdata=null;d[c++]=a[68];d[c++]=j();d[c++]=a[69]}else{d[c++]=a[70];d[c++]=h.get_acre_handler();d[c++]=a[71];d[c++]=h.get_mime_type();d[c++]=a[72]}d[c++]=a[73];var o=b.runtime.uniqueid("onclick");mjt._eventcb[o]=function(){ui.do_file_check()};d[c++]=a[74];var r=ui.get_file_check_options().useful===
1?{}:{disabled:"disabled"};if(!("title"in r)){d[c++]=a[75];d[c++]=b.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Check Syntax")),false);d[c++]=a[76]}if(!("onclick"in r)){d[c++]=a[77];d[c++]=b.runtime.make_attr_safe(o,false);d[c++]=a[78]}for(var t in r){d[c++]=" "+t;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+r[t]);d[c++]=b.runtime.bless('"')}d[c++]=a[79];if(p){t=b.runtime.uniqueid("onclick");mjt._eventcb[t]=function(){ui.do_file_revert_to_saved()};d[c++]=a[80];o=!h.is_dirty()?
{disabled:"disabled"}:{};"class"in o||(d[c++]=a[81]);if(!("onclick"in o)){d[c++]=a[82];d[c++]=b.runtime.make_attr_safe(t,false);d[c++]=a[83]}for(var u in o){d[c++]=" "+u;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+o[u]);d[c++]=b.runtime.bless('"')}d[c++]=a[84]}d[c++]=a[85];u=b.runtime.uniqueid("onclick");mjt._eventcb[u]=function(){ui.do_show_dialog("diff_patch",["file_history",ui.get_file().get_name()])};d[c++]=a[86];d[c++]=b.runtime.make_attr_safe(u,false);d[c++]=a[87];u=b.runtime.uniqueid("onclick");
mjt._eventcb[u]=function(){ui.do_show_dialog("save_file_as")};d[c++]=a[88];t=ui.get_user()?{}:{disabled:"disabled"};if(!("onclick"in t)){d[c++]=a[89];d[c++]=b.runtime.make_attr_safe(u,false);d[c++]=a[90]}for(var x in t){d[c++]=" "+x;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+t[x]);d[c++]=b.runtime.bless('"')}d[c++]=a[91];x=b.runtime.uniqueid("onclick");mjt._eventcb[x]=function(){ui.do_show_dialog("delete_file",[ui.get_file().get_name()])};d[c++]=a[92];p=p?{}:{disabled:"disabled"};
if(!("onclick"in p)){d[c++]=a[93];d[c++]=b.runtime.make_attr_safe(x,false);d[c++]=a[94]}for(var C in p){d[c++]=" "+C;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+p[C]);d[c++]=b.runtime.bless('"')}d[c++]=a[95];b.runtime.ondomready(function(){ui.watch_inputs("name",{inputs:{"file-name":ui.get_file().get_name()},change:function(w){return w["file-name"]!==""?w:false},submit:function(w){ui.do_file_move(w["file-name"])}})},this);d[c++]=a[96];return d};i=b.runtime.tfunc_factory("fileactions()",
i,b,undefined,false);l.fileactions=i;i.source_microdata=null;m[n++]=a[97];i=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[98];var p=false;ui.get_store();var h=ui.get_app(),j=ui.get_file();ui.get_user()&&h.is_writable();d[c++]=a[99];if(j.get_editor_supported_features("hotswap")){d[c++]=a[100];p=true;d[c++]=a[101];b.runtime.foreach(this,EDITORS,function(E,F){for(var z=1;z;){if(F.supports.hotswap){d[c++]=a[102];var y=ui.get_editor_prefs("texteditor")===E?{checked:"checked"}:{};if(!("id"in
y)){d[c++]=a[103];d[c++]=b.runtime.make_attr_safe(E,false);d[c++]=a[104]}"name"in y||(d[c++]=a[105]);"type"in y||(d[c++]=a[106]);if(!("value"in y)){d[c++]=a[107];d[c++]=b.runtime.make_attr_safe(E,false);d[c++]=a[108]}for(var v in y){d[c++]=" "+v;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+y[v]);d[c++]=b.runtime.bless('"')}d[c++]=a[109];d[c++]=b.runtime.make_attr_safe(E,false);d[c++]=a[110];d[c++]=F.name;d[c++]=a[111]}z--}return z?b.runtime._break_token:b.runtime._continue_token});
d[c++]=a[112]}d[c++]=a[113];if(j.get_editor_supported_features("margin")){d[c++]=a[114];p=true;d[c++]=a[115];h=ui.get_editor_prefs("margin")?{checked:"checked"}:{};"id"in h||(d[c++]=a[116]);"name"in h||(d[c++]=a[117]);"type"in h||(d[c++]=a[118]);"value"in h||(d[c++]=a[119]);for(var o in h){d[c++]=" "+o;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+h[o]);d[c++]=b.runtime.bless('"')}d[c++]=a[120];o=ui.get_editor_prefs("margin")?{}:{checked:"checked"};"id"in o||(d[c++]=a[121]);"name"in
o||(d[c++]=a[122]);"type"in o||(d[c++]=a[123]);"value"in o||(d[c++]=a[124]);for(var r in o){d[c++]=" "+r;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+o[r]);d[c++]=b.runtime.bless('"')}d[c++]=a[125]}d[c++]=a[126];if(j.get_editor_supported_features("softwrap")){d[c++]=a[127];p=true;d[c++]=a[128];r=ui.get_editor_prefs("softwrap")?{checked:"checked"}:{};"id"in r||(d[c++]=a[129]);"name"in r||(d[c++]=a[130]);"type"in r||(d[c++]=a[131]);"value"in r||(d[c++]=a[132]);for(var t in r){d[c++]=
" "+t;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+r[t]);d[c++]=b.runtime.bless('"')}d[c++]=a[133];t=ui.get_editor_prefs("softwrap")?{}:{checked:"checked"};"id"in t||(d[c++]=a[134]);"name"in t||(d[c++]=a[135]);"type"in t||(d[c++]=a[136]);"value"in t||(d[c++]=a[137]);for(var u in t){d[c++]=" "+u;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+t[u]);d[c++]=b.runtime.bless('"')}d[c++]=a[138]}d[c++]=a[139];if(j.get_editor_supported_features("codeassist")){d[c++]=a[140];p=true;
d[c++]=a[141];u=ui.get_editor_prefs("dotTrigger")?{checked:"checked"}:{};"id"in u||(d[c++]=a[142]);"name"in u||(d[c++]=a[143]);"type"in u||(d[c++]=a[144]);"value"in u||(d[c++]=a[145]);for(var x in u){d[c++]=" "+x;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+u[x]);d[c++]=b.runtime.bless('"')}d[c++]=a[146];x=ui.get_editor_prefs("dotTrigger")?{}:{checked:"checked"};"id"in x||(d[c++]=a[147]);"name"in x||(d[c++]=a[148]);"type"in x||(d[c++]=a[149]);"value"in x||(d[c++]=a[150]);for(var C in x){d[c++]=
" "+C;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+x[C]);d[c++]=b.runtime.bless('"')}d[c++]=a[151]}d[c++]=a[152];if(j.get_editor_supported_features("emql")){d[c++]=a[153];p=true;d[c++]=a[154];j=ui.get_editor_prefs("emql")?{checked:"checked"}:{};"id"in j||(d[c++]=a[155]);"name"in j||(d[c++]=a[156]);"type"in j||(d[c++]=a[157]);"value"in j||(d[c++]=a[158]);for(var w in j){d[c++]=" "+w;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+j[w]);d[c++]=b.runtime.bless('"')}d[c++]=
a[159];w=ui.get_editor_prefs("emql")?{}:{checked:"checked"};"id"in w||(d[c++]=a[160]);"name"in w||(d[c++]=a[161]);"type"in w||(d[c++]=a[162]);"value"in w||(d[c++]=a[163]);for(var A in w){d[c++]=" "+A;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+w[A]);d[c++]=b.runtime.bless('"')}d[c++]=a[164]}d[c++]=a[165];p||(d[c++]=a[166]);d[c++]=a[167];b.runtime.ondomready(function(){$("#menu-editoroptions input[type='radio']").click(function(){var E=$(this).attr("name").split("edopt-")[1],F={};F[E]=
$(this).val();ui.set_editor_prefs(F);ui.do_refresh_file();ui.do_hide_overlays()})},this);d[c++]=a[168];return d};i=b.runtime.tfunc_factory("editoroptions()",i,b,undefined,false);l.editoroptions=i;i.source_microdata=null;m[n++]=a[169];i=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[170];var p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("keyboard_shortcuts")};d[c++]=a[171];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[172];p=b.runtime.uniqueid("onclick");
mjt._eventcb[p]=function(){return ui.do_show_dialog("documentation",[ui.get_store().get_freebase_url()+"/docs/iframe/acre_api"])};d[c++]=a[173];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[174];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("documentation",[ui.get_store().get_freebase_url()+"/docs/iframe/acre_templates"])};d[c++]=a[175];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[176];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("documentation",
[ui.get_store().get_freebase_url()+"/docs/iframe/js_reference"])};d[c++]=a[177];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[178];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("documentation",[ui.get_store().get_freebase_url()+"/docs/iframe/mql"])};d[c++]=a[179];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[180];d[c++]=b.runtime.make_attr_safe(ui.get_store().get_freebase_url(),true);d[c++]=a[181];d[c++]=b.runtime.make_attr_safe(ui.get_store().get_acre_host(),
false);d[c++]=a[182];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){return ui.do_show_dialog("about_appeditor")};d[c++]=a[183];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[184];b.runtime.ondomready(function(){$("#help-menu-content a").click(function(){ui.do_hide_overlays()})},this);d[c++]=a[185];return d};i=b.runtime.tfunc_factory("help()",i,b,undefined,false);l.help=i;i.source_microdata=null;m[n++]=a[186];i=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[187];var p=ui.get_app().is_writable();
d[c++]=a[188];var h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_hide_overlays()};d[c++]=a[189];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[190];if(p)d[c++]=a[191];d[c++]=a[192];if(ui.get_app().is_remote()){d[c++]=a[202];if(ui.get_user()){p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_show_dialog("new_app",[true])};d[c++]=a[203];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[204]}d[c++]=a[205]}else{d[c++]=a[193];if(ui.get_app().is_author())d[c++]=a[194];
d[c++]=a[195];if(ui.get_user()){h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_show_dialog("new_app",[true])};d[c++]=a[196];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[197]}d[c++]=a[198];if(p){p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_show_dialog("delete_app")};d[c++]=a[199];d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[200]}d[c++]=a[201]}d[c++]=a[206];p=b.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_hide_overlays()};d[c++]=a[207];
d[c++]=b.runtime.make_attr_safe(p,false);d[c++]=a[208];b.runtime.ondomready(function(){$("#button-appsettings").addClass("button-open");$("#settings-tabs").tabs("#settings-tab-content > div",{api:true,initialIndex:0,onBeforeClick:function(j,o){var r=$(this.getPanes()[o]).attr("id");setTimeout(function(){$("#"+r).acre(fb.acre.apps.appeditor+"/menus.mjt",r)},0)}});$("#app-general-listing").click(function(){window.open(ui.get_app().get_edit_url());return false})},this);d[c++]=a[209];return d};i=b.runtime.tfunc_factory("appsettings()",
i,b,undefined,false);l.appsettings=i;i.source_microdata=null;m[n++]=a[210];i=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[211];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+'"');d[c++]=a[212];var p=ui.get_app().is_writable();d[c++]=a[213];if(p){d[c++]=a[214];var h=b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_app_add_version($("#add-version-key").val())};d[c++]=a[215];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[216];if(ui.get_app().get_versions().length){h=
b.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.do_show_dialog("diff_patch",["app_diff"])};d[c++]=a[217];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[218]}d[c++]=a[219]}d[c++]=a[220];d[c++]=f();d[c++]=a[221];var j=ui.get_app();h=j.get_name();var o=j.get_base_url().replace("http://"+h,"").replace("."+j.get_store().get_acre_host(),"");d[c++]=a[222];if(p){d[c++]=a[223];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[224];d[c++]=o;d[c++]=a[225];d[c++]=j.get_acre_host();d[c++]=a[226]}else{d[c++]=
a[227];d[c++]=b.runtime.make_attr_safe(j.get_base_url(),true);d[c++]=a[228];d[c++]=j.get_base_url();d[c++]=a[229]}d[c++]=a[230];p&&b.runtime.ondomready(function(){ui.watch_inputs("devurl",{inputs:{devurl:j.get_name()},update_on_submit:true,submit:function(r){ui.do_app_move("//"+r.devurl+o)}})},this);d[c++]=a[231];d[c++]=q();d[c++]=a[232];return d};i=b.runtime.tfunc_factory("app_general()",i,b,undefined,false);l.app_general=i;i.source_microdata=null;m[n++]=a[233];var q=function(){var d=b.runtime.new_markuplist(),
c=0;d[c++]=a[234];for(var p=ui.get_app(),h=p.is_writable(),j=p.get_hosts(),o=p.get_released_version()||"current",r=/([^.]*)\.freebaseapps\.com$/,t=null,u=0;u<j.length;u++){var x=j[u];if(x.version==o)if(x=r.exec(x.host)){t=x[1];break}}d[c++]=a[235];if(h){d[c++]=a[236];d[c++]=b.runtime.make_attr_safe(t||"",false);d[c++]=a[237];d[c++]=p.get_acre_host();d[c++]=a[238];if(t)d[c++]=a[239];else d[c++]=a[240];d[c++]=a[241];if(t?j.length>1:j.length>0){d[c++]=a[242];b.runtime.foreach(this,j,function(C,w){for(var A=
1;A;){if(w.host!==t+".freebaseapps.com"){d[c++]=a[243];d[c++]=b.runtime.make_attr_safe(w.host,false);d[c++]=a[244];d[c++]=w.host;d[c++]=a[245];if(w.version!=o){d[c++]=a[246];d[c++]=w.version;d[c++]=a[247]}d[c++]=a[248]}A--}return A?b.runtime._break_token:b.runtime._continue_token});d[c++]=a[249]}d[c++]=a[250];b.runtime.ondomready(function(){ui.watch_inputs("puburl",{inputs:{puburl:$("#puburl").val()},text_delay:1E3,update_on_submit:true,change:function(C){$("#button-puburl").attr("disabled","disabled");
$("#puburl-status").removeClass().html("").addClass("puburl-wait");ui.get_store().XhrGet("check_host_availability",{host:C.puburl}).enqueue().onready(function(w){$("#button-puburl").removeAttr("disabled");$("#puburl-status").removeClass().addClass("puburl-success").html(w.message)}).onerror(function(w,A){$("#puburl-status").removeClass().addClass("puburl-fail").html(A)})},submit:function(C){$("#puburl-status").removeClass().empty();ui.do_app_set_host(C.puburl)}})},this);d[c++]=a[251]}else{d[c++]=
a[252];if(t){d[c++]=a[253];if(t){d[c++]=a[254];d[c++]=b.runtime.make_attr_safe(t+"."+ui.get_app().get_acre_host(),false);d[c++]=a[255];d[c++]=t;d[c++]=a[256];d[c++]=ui.get_app().get_acre_host();d[c++]=a[257]}d[c++]=a[258]}d[c++]=a[259]}d[c++]=a[260];return d};q=b.runtime.tfunc_factory("app_hosts_list()",q,b,undefined,false);l.app_hosts_list=q;q.source_microdata=null;m[n++]=a[261];var f=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[262];for(var p=ui.get_app(),h=p.get_path(),j=p.is_writable(),
o=p.get_released_version(),r=o?h.replace("//","//"+o+"."):h,t=p.get_versions(),u=/(\d+)/,x=1,C=0;C<t.length;C++){var w=u.exec(t[C].name);if(w&&w.length){w=parseInt(w[1],10);if(x<=w)x=w+1}}var A=true;d[c++]=a[263];if(o||j)d[c++]=a[264];d[c++]=a[265];if(j)d[c++]=a[266];d[c++]=a[267];if(j)d[c++]=a[268];d[c++]=a[269];if(o||j){d[c++]=a[270];if(j){d[c++]=a[271];u=r==h?{checked:"checked"}:{};"name"in u||(d[c++]=a[272]);"type"in u||(d[c++]=a[273]);"value"in u||(d[c++]=a[274]);for(var E in u){d[c++]=" "+E;
d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+u[E]);d[c++]=b.runtime.bless('"')}d[c++]=a[275]}else{d[c++]=a[276];if(r==h)d[c++]=a[277];d[c++]=a[278]}d[c++]=a[279]}d[c++]=a[280];d[c++]=b.runtime.make_attr_safe(h,false);d[c++]=a[281];d[c++]=b.runtime.make_attr_safe(ui.get_appeditor_url(h),true);d[c++]=a[282];if(j)d[c++]=a[283];d[c++]=a[284];d[c++]=b.runtime.make_attr_safe(p.get_base_url(),true);d[c++]=a[285];if(j)d[c++]=a[286];d[c++]=a[287];b.runtime.foreach(this,t,function(F,z){for(var y=
1;y;){d[c++]=a[288];var v=h.replace("//","//"+z.name+"."),B=p.get_base_url().replace("//","//"+z.name+"."),I=false;if(/\d+/.test(z.name)){if(A){I=true;A=false}}else I=true;d[c++]=a[289];if(o||j){d[c++]=a[290];if(j){d[c++]=a[291];var G=r!=v?{}:{checked:"checked"};"name"in G||(d[c++]=a[292]);"type"in G||(d[c++]=a[293]);if(!("value"in G)){d[c++]=a[294];d[c++]=b.runtime.make_attr_safe(z.name,false);d[c++]=a[295]}for(var K in G){d[c++]=" "+K;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+
G[K]);d[c++]=b.runtime.bless('"')}d[c++]=a[296]}else{d[c++]=a[297];if(r==v)d[c++]=a[298];d[c++]=a[299]}d[c++]=a[300]}d[c++]=a[301];d[c++]=b.runtime.make_attr_safe(v,false);d[c++]=a[302];d[c++]=b.runtime.make_attr_safe(ui.get_appeditor_url(v),true);d[c++]=a[303];d[c++]=z.name;d[c++]=a[304];if(z.as_of_time){d[c++]=a[305];d[c++]=ui.get_relative_timestamp(z.as_of_time);d[c++]=a[306];if(j&&I){d[c++]=a[307];I=b.runtime.uniqueid("onclick");mjt._eventcb[I]=function(){ui.do_app_add_version(z.name,"__now__")};
d[c++]=a[308];d[c++]=b.runtime.make_attr_safe(I,false);d[c++]=a[309]}d[c++]=a[310]}d[c++]=a[311];if(j){d[c++]=a[312];I=z.service_url=="http://www.sandbox-freebase.com"?{checked:"checked"}:{};"class"in I||(d[c++]=a[313]);if(!("key"in I)){d[c++]=a[314];d[c++]=b.runtime.make_attr_safe(z.name,false);d[c++]=a[315]}"type"in I||(d[c++]=a[316]);for(var J in I){d[c++]=" "+J;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+I[J]);d[c++]=b.runtime.bless('"')}d[c++]=a[317]}d[c++]=a[318];d[c++]=b.runtime.make_attr_safe(B,
true);d[c++]=a[319];if(j){d[c++]=a[320];if(r!=v){d[c++]=a[321];d[c++]=b.runtime.make_attr_safe(z.name,false);d[c++]=a[322]}d[c++]=a[323]}d[c++]=a[324];y--}return y?b.runtime._break_token:b.runtime._continue_token});d[c++]=a[325];j&&b.runtime.ondomready(function(){$("#add-version-key").val(x);$(".remove-version-button").click(function(){$(this).parents("tr").fadeOut("slow");ui.do_app_remove_version($(this).attr("key"));return false});$("input[name='version-release']").click(function(){var F=$(this).val();
ui.do_app_set_release(F);return false});$(".version-service-url").click(function(){service_url=$(this).attr("checked")?"http://www.sandbox-freebase.com":false;ui.do_app_add_version($(this).attr("key"),null,service_url)})},this);d[c++]=a[326];return d};f=b.runtime.tfunc_factory("app_versions_list()",f,b,undefined,false);l.app_versions_list=f;f.source_microdata=null;m[n++]=a[327];i=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[328];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+
'"');d[c++]=a[329];var p=ui.get_app();p.is_writable();var h=ui.id_to_path("/freebase/apps/seed");d[c++]=a[330];var j=b.runtime.uniqueid("onclick");mjt._eventcb[j]=function(){ui.do_show_dialog("diff_patch",["app_history"])};d[c++]=a[331];d[c++]=b.runtime.make_attr_safe(j,false);d[c++]=a[332];if(!p.get_parent()&&!p.get_children().length||p.get_parent()&&p.get_parent().path===h)d[c++]=a[333];d[c++]=a[334];if(p.get_parent()&&p.get_parent().path!==h){d[c++]=a[335];d[c++]=b.runtime.make_attr_safe(p.get_parent().path,
false);d[c++]=a[336];d[c++]=p.get_parent().path;d[c++]=a[337];d[c++]=b.runtime.make_attr_safe(p.get_parent().path,false);d[c++]=a[338]}d[c++]=a[339];if(p.get_children().length){d[c++]=a[340];b.runtime.foreach(this,p.get_children(),function(o,r){for(var t=1;t;){d[c++]=a[341];d[c++]=b.runtime.make_attr_safe(r.path,false);d[c++]=a[342];d[c++]=r.path;d[c++]=a[343];d[c++]=b.runtime.make_attr_safe(r.path,false);d[c++]=a[344];t--}return t?b.runtime._break_token:b.runtime._continue_token});d[c++]=a[345]}d[c++]=
a[346];b.runtime.ondomready(function(){$("#merge-app").suggest({type:"/freebase/apps/acre_app"}).bind("fb-select",function(o,r){var t=ui.id_to_path(r.id);$(this).val(t);$("#button-merge").removeAttr("disabled").val(t)});$(".button-get-changes").click(function(){ui.do_show_dialog("diff_patch",["merge_changes",{appid:$(this).val()}])})},this);d[c++]=a[347];return d};i=b.runtime.tfunc_factory("app_changes()",i,b,undefined,false);l.app_changes=i;i.source_microdata=null;m[n++]=a[348];i=function(){var d=
b.runtime.new_markuplist(),c=0;d[c++]=a[349];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+'"');d[c++]=a[350];if(ui.get_app().is_writable()){d[c++]=a[351];d[c++]=g(ui.get_app().get_authors());d[c++]=a[352];b.runtime.ondomready(function(){$("#add-author-input").suggest({type:"/type/user"}).bind("fb-select",function(p,h){$(this).val("");ui.do_app_add_author(h.name)}).focus()},this);d[c++]=a[353]}else{d[c++]=a[354];d[c++]=g(ui.get_app().get_authors());d[c++]=a[355]}d[c++]=a[356];return d};
i=b.runtime.tfunc_factory("app_authors()",i,b,undefined,false);l.app_authors=i;i.source_microdata=null;m[n++]=a[357];var g=function(d){var c=b.runtime.new_markuplist(),p=0;c[p++]=a[358];var h=function(){var j=0;for(var o in d)j++;return j==1}();c[p++]=a[359];b.runtime.foreach(this,d,function(j,o){for(var r=1;r;){c[p++]=a[360];c[p++]=b.runtime.make_attr_safe(o.get_view_url(),true);c[p++]=a[361];c[p++]=b.runtime.make_attr_safe(o.get_full_name()||o.get_name(),false);c[p++]=a[362];c[p++]=b.runtime.make_attr_safe(o.get_view_url(),
true);c[p++]=a[363];c[p++]=b.runtime.make_attr_safe(o.get_full_name()||o.get_name(),false);c[p++]=a[364];c[p++]=o.get_name();c[p++]=a[365];if(!h&&ui.get_app().is_writable()&&o.is_admin()){c[p++]=a[366];c[p++]=b.runtime.make_attr_safe(o.get_name(),false);c[p++]=a[367]}c[p++]=a[368];r--}return r?b.runtime._break_token:b.runtime._continue_token});c[p++]=a[369];b.runtime.ondomready(function(){$("#add-author-input").focus();$(".remove-user-button").click(function(){$(this).parents("tr").fadeOut("slow");
ui.do_app_remove_author($(this).attr("user"));return false})},this);c[p++]=a[370];return c};g=b.runtime.tfunc_factory("app_authors_list(user_dict)",g,b,undefined,false);l.app_authors_list=g;g.source_microdata=null;m[n++]=a[371];i=function(){var d=b.runtime.new_markuplist(),c=0;d[c++]=a[372];if(this.subst_id)d[c++]=b.runtime.bless(' id="'+this.subst_id+'"');d[c++]=a[373];var p=ui.get_app().get_write_user(),h=p&&p.get_name()==ui.get_user().get_name()?true:false,j=ui.get_app().is_oauth_enabled(),o={},
r={};if(p){o.checked="checked";if(!h)o.disabled="disabled"}if(j)r.checked="checked";d[c++]=a[374];"id"in r||(d[c++]=a[375]);"type"in r||(d[c++]=a[376]);for(var t in r){d[c++]=" "+t;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+r[t]);d[c++]=b.runtime.bless('"')}d[c++]=a[377];"id"in o||(d[c++]=a[378]);"type"in o||(d[c++]=a[379]);for(var u in o){d[c++]=" "+u;d[c++]=b.runtime.bless('="');d[c++]=b.runtime.htmlencode(""+o[u]);d[c++]=b.runtime.bless('"')}d[c++]=a[380];d[c++]=p?p.get_name():
ui.get_user().get_name();d[c++]=a[381];if(window.location.protocol=="https:"){d[c++]=a[382];(p=this.tasks&&this.tasks.apikeys)||(p=this.mktask("apikeys",ui.get_app().t_get_apikeys()));d[c++]=a[383];d[c++]=a[384];switch(p.state){case "ready":d[c++]=a[385];p=p.result.keys;d[c++]=a[386];d[c++]=s(p);d[c++]=a[387];break;case "wait":d[c++]=a[388];break;case "error":d[c++]=a[389];break}d[c++]=a[390]}else{d[c++]=a[391];d[c++]=b.runtime.make_attr_safe(window.location.host+window.location.pathname+window.location.hash,
false);d[c++]=a[392]}d[c++]=a[393];b.runtime.ondomready(function(){$("#permission-oauth").change(function(){ui.do_app_set_oauth(!!$(this).attr("checked"))});$("#permission-writeuser").change(function(){ui.do_app_set_writeuser(!!$(this).attr("checked"))})},this);d[c++]=a[394];return d};i=b.runtime.tfunc_factory("app_services()",i,b,true,false);l.app_services=i;i.source_microdata=null;m[n++]=a[395];var s=function(d){var c=b.runtime.new_markuplist(),p=0;c[p++]=a[396];if(d.length){c[p++]=a[397];b.runtime.foreach(this,
d,function(h,j){for(var o=1;o;){c[p++]=a[398];c[p++]=j.key_id;c[p++]=a[399];c[p++]=j.token;c[p++]=a[400];c[p++]=j.secret;c[p++]=a[401];if(j.key_id!=="freebase.com"){c[p++]=a[402];c[p++]=b.runtime.make_attr_safe(j.key_id,false);c[p++]=a[403]}c[p++]=a[404];o--}return o?b.runtime._break_token:b.runtime._continue_token});c[p++]=a[405]}else c[p++]=a[406];c[p++]=a[407];b.runtime.ondomready(function(){ui.watch_inputs("apikey-add",{inputs:{"apikey-name":null,"apikey-token":null,"apikey-secret":null},submit:function(h){ui.do_app_add_apikey(h["apikey-name"],
h["apikey-token"],h["apikey-secret"])}});$(".remove-key-button").click(function(){$(this).parents("tr").fadeOut("slow");ui.do_app_remove_apikey($(this).attr("key"));return false})},this);c[p++]=a[408];return c};s=b.runtime.tfunc_factory("app_apikeys_list(keys)",s,b,undefined,false);l.app_apikeys_list=s;s.source_microdata=null;return m};e.source_microdata=null;return e}(),info:{file:"//2a.appeditor.www.tags.svn.freebase-site.googlecode.dev/menus.mjt",stringtable:["\n\n<!-- Your Apps Menu --\>","",
"",'\n  <div class="section selectable" onclick="return mjt._eventcb.','.apply(this, [event])">\n    New App...\n  </div>',"",'\n  <div class="section selectable" onclick="return mjt._eventcb.','.apply(this, [event])">      \n    App Directory...     \n  </div>','\n  <div class="section selectable" id="your-apps-menu-item">      \n    <div id="your-apps-opener"><img id="your-apps-loader" src="/static/2a.appeditor.www.tags/loader-tinyorange.gif" style="display:none;"></div>\n    Your Apps \n  </div>',
'\n  <div class="section">\n    <h3>Your Apps</h3>\n    <a href="','" title="Sign in to your Freebase account">Sign in</a> to show your apps here.\n  </div>','\n\n  <div class="section last"> \n    <h3>Recent Apps</h3>',"\n    <ul>","\n      <li>",'\n        <a apppath="','" class="app-link" href="','" title="','">',"</a>","\n        <em>on ","</em>","\n      </li>","\n    </ul>","\n    <div>If you work on multiple apps, recently opened ones will appear here.</div>","\n  </div>","","","","",'\n    <p class="menu-message">Apps you create or clone will appear here.</p>',
"\n    <ul>",'\n      <li>\n        <a apppath="','" class="app-link" href="','" title="','">\n          ',"\n        </a>\n      </li>","\n    </ul>","","","\n\n\n<!-- File Menu --\>","","",'\n  <div class="section">\n    <h3>Name</h3>\n    <fieldset class="center">\n      <label for="file-name">File name </label>\n      <input class="form-textbox" id="file-name" type="text" value="','">','\n      <button class="exit" disabled="disabled" id="button-name">Rename</button>',"\n    </fieldset>\n  </div>",
"",'\n  <div class="section">\n    <h3>Type</h3>\n    <fieldset id="fieldset-metadata">',"<div",">",'\n        <div class="form-row">\n          <label for="file-handler">Acre type </label>\n          <select',' id="file-handler"',">","\n            <option",' value="','"',">\n                ","\n            </option>",'\n          </select>\n        </div>\n        <div class="form-row">\n          <label for="file-mimetype">MIME type </label>\n          <select',' id="file-mimetype"',">","\n            <option",
' value="','"',">\n              ","\n            </option>","\n          </select>\n        </div>","\n      </div>",'\n      <div id="metadata-section">',"</div>\n    </fieldset>\n  </div>",'\n  <div class="section">\n    <h3>Type</h3>\n    <fieldset id="fieldset-metadata">\n      <div class="form-row">\n        <label for="file-handler">Acre type:</label>\n        <span class="form-static">','</span>\n      </div>            \n      <div class="form-row">            \n        <label for="file-mimetype">MIME type: </label>\n        <span class="form-static">',
"</span>\n      </div>              \n    </fieldset>\n  </div>",'\n  <div class="section">\n    <h3>Validate</h3>\n    <!-- mjt.bless is being used so HTML entities for system control characters \n        can be printed. These are all declared in ui.shortcut --\>',"\n    <button",' title="','"',' onclick="return mjt._eventcb.','.apply(this, [event])"','>\n      Check Syntax</button>\n  </div>\n  <div class="section">\n    <h3>History</h3>\n    <fieldset>',"\n      <button",' class="exit"',' onclick="return mjt._eventcb.',
'.apply(this, [event])"',">\n        Revert to Saved</button>"," ",'\n      <button onclick="return mjt._eventcb.','.apply(this, [event])">\n        Review Older Versions</button>\n    </fieldset>\n  </div>\n  <div class="section last">\n    <h3>Actions</h3>',"\n    <button",' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n      Clone this File</button>","\n    <button",' onclick="return mjt._eventcb.','.apply(this, [event])"',">\n      Delete this File</button>\n  </div>","","\n\n\n<!-- Editor Menu --\>",
"","",'\n  <div class="section">',"\n    <h3>Text Editor</h3>\n    <fieldset>",'\n      <div class="line">\n        <input',' id="edopt-texteditor-','"',' name="edopt-texteditor"',' type="radio"',' value="','"','>\n        <label for="edopt-texteditor-','">',"</label><br>\n      </div>","\n    </fieldset>\n  </div>","",'\n  <div class="section">'," \n    <h3>Line Numbers</h3>\n    <fieldset>\n      <input",' id="edopt-margin-y"',' name="edopt-margin"',' type="radio"',' value="1"','> <label for="edopt-margin-y">yes</label>\n      <input',
' id="edopt-margin-n"',' name="edopt-margin"',' type="radio"',' value="0"','> <label for="edopt-margin-y">no</label>\n    </fieldset>\n  </div>',"",'\n  <div class="section">',"\n    <h3>Soft Wrap</h3>\n    <fieldset>\n      <input",' id="edopt-softwrap-y"',' name="edopt-softwrap"',' type="radio"',' value="1"','> <label for="edopt-softwrap-y">yes</label>\n      <input',' id="edopt-softwrap-n"',' name="edopt-softwrap"',' type="radio"',' value="0"','> <label for="edopt-softwrap-n">no</label>\n    </fieldset>\n  </div>',
"",'\n  <div class="section last">',"\n    <h3>Automatic Code Assist</h3>\n    <fieldset>\n      <input",' id="edopt-dotTrigger-y"',' name="edopt-dotTrigger"',' type="radio"',' value="1"','> <label for="edopt-dotTrigger-y">yes</label>\n      <input',' id="edopt-dotTrigger-n"',' name="edopt-dotTrigger"',' type="radio"',' value="0"','> <label for="edopt-dotTrigger-n">no</label>\n    </fieldset>\n  </div>',"",'\n  <div class="section last">',"\n    <h3>Enable MQL Extensions (experimental)</h3>\n    <fieldset>\n      <input",
' id="edopt-emql-y"',' name="edopt-emql"',' type="radio"',' value="1"','> <label for="edopt-emql-y">yes</label>\n      <input',' id="edopt-emql-n"',' name="edopt-emql"',' type="radio"',' value="0"','> <label for="edopt-emql-n">no</label>\n    </fieldset>\n  </div>',"",'\n  <div>\n    <p style="margin:10px">\n      No configuration options for this file type. \n    </p>\n  </div>',"","","\n\n\n<!-- Help Menu --\>",'\n  <div id="help-menu-content">\n  <div class="section">\n    <h3>Documentation</h3>\n    <ul>\n      <li>',
'<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Keyboard Shortcuts</a></li>\n      <li>','<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Acre API Reference</a></li>\n      <li>','<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Acre Template Tag Reference</a></li>\n      <li>','<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Javascript Reference</a></li>\n      <li>','<a href="#0" onclick="return mjt._eventcb.',
'.apply(this, [event])">\n        MQL Reference Guide</a></li>\n      <li><a href="','/docs/" target="_new">\n        Freebase Documentation Hub</a></li>\n    </ul>\n  </div>\n  <div class="section">\n    <h3>Code Search</h3>\n    <p>\n      Not sure how to use a particular method or template tag?  See how someone else did!\n    </p>\n    <form action="http://codesearch.','/" id="codesearch-form" target="_blank">\n      <fieldset>\n          <input id="code-search" name="q" type="text">\n          <button id="button-codesearch">Find Code</button>\n      </fieldset>\n    </form>\n  </div>\n  <div class="section last">',
'\n    <a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">About App Editor</a>\n  </div>\n  </div>',"","\n\n\n<!-- App  menu --\>","","",'\n  <div class="dialog-close" onclick="return mjt._eventcb.','.apply(this, [event])"></div>\n  <div class="clear" id="app-settings-section">\n    <div id="settings-tabs">\n      <ul id="settings-tabs-bar">\n        <li class="tab"><a class="settings-tab-link" href="#app_general">Versions</a></li>\n        <li class="tab"><a class="settings-tab-link" href="#app_changes">Changes</a></li>\n        <li class="tab"><a class="settings-tab-link" href="#app_authors">Authors</a></li>',
'\n        <li class="tab"><a class="settings-tab-link" href="#app_services">Web Services</a></li>','\n      </ul>\n      <div class="tabbed-content" id="settings-tab-content">\n        <div id="app_general"></div>\n        <div id="app_changes"></div>\n        <div id="app_authors"></div>\n        <div id="app_services"></div>\n      </div>\n    </div>\n  </div>\n  <div class="button-bar">','\n    <fieldset id="app-clonedelete">','\n      <button class="button-primary" id="app-general-listing">\n        Edit Name &amp; Directory Listing</button>',
"",'\n      <button id="app-general-clone" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Clone this App</button>',"",'\n      <button id="app-general-delete" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Delete this App</button>',"\n    </fieldset>",'\n    <fieldset id="app-clonedelete">','\n      <button id="app-general-clone" onclick="return mjt._eventcb.','.apply(this, [event])">\n        Clone this App</button>',"\n    </fieldset>","",'\n    <button onclick="return mjt._eventcb.',
'.apply(this, [event])">Done</button>\n  </div>',"","",'<div class="tab-body"',">",'\n        \n    <div class="tab-section">\n      <h3>Versions</h3>\n      <div class="sidebar">\n        <p>\n          App authors can create and release new versions of their app any time.\n        </p>\n        <p>\n          <em>Current</em> is always the latest version; all edits are made to Current.  Other versions are read only.\n        </p>\n        <p>\n          <em>Release</em> is the version the app author wants people to use.  Any version can be released, but it\'s good practice to create and release a version other than Current to prevent development from impacting users. \n        </p>\n      </div>',
'\n      <fieldset id="add-version">\n        <label for="add-version-key">Create a new version: </label>\n        <input id="add-version-key" maxlength="10" type="text">','\n        <button id="button-version" onclick="return mjt._eventcb.','.apply(this, [event])">\n          Add Version</button>','\n        <button onclick="return mjt._eventcb.','.apply(this, [event])">\n          View Changes</button>',"\n      </fieldset>",'\n      <div id="app-versions-add">','</div>\n    </div>\n\n    <div class="tab-section">',
"",'\n      <div class="app-url">\n        <p>\n          Your <strong>Dev URL</strong> points to <em>Current:</em>\n        </p>\n        <fieldset>\n            http://<input class="shortfield" id="devurl" maxlength="20" minlength="5" type="text" value="','">',".",'\n          <button disabled="disabled" id="button-devurl">Change URL</button>\n        </fieldset>\n      </div>','\n      <div class="app-url">\n        <p>URL to <em>Current</em> version:</p>\n        <p><a href="','" target="current">',
"</a></p>\n      </div>","",'\n    </div>\n    <div class="tab-section last">\n      <div class="app-url">\n        ',"\n      </div>\n    </div>\n  </div>","","","",'\n      <div>\n        <p>Your <strong>Release URL</strong> points to <em>Release:</em></p>\n        <fieldset>\n          http://<input id="puburl" maxlength="20" minlength="5" type="text" value="','">.',' \n          <button disabled="disabled" id="button-puburl">',"\n            <span>Change URL</span>","\n            <span>Choose URL</span>",
'\n          </button>\n          <span id="puburl-status"></span>\n        </fieldset>','\n        <div>\n          <h4 class="list-title">Other URLs:</h4>\n          <table class="edit-list">','\n            <tr>\n              <td><a href="http://','" target="_blank">',"</a></td>\n              <td>",'<span class="version-bad">',"</span>","</td>\n            </tr>","\n          </table>\n        </div>","","\n      </div>","\n      <div>","\n        <div>\n          <p>URL to <em>Release</em> version:</p>",
'\n          <p><a href="http://','" target="release">http://',".","</a>\n          </p>","\n        </div>","\n      </div>","","","",'\n\n      <div id="app-versions-list">\n        <table class="edit-list">\n          <thead>\n            <tr>','\n              <th class="center">release</th>','\n              <th class="left">version</th>\n              <th class="left">snapshot time</th>','\n              <th class="center">run on<br>sandbox</th>',"\n              <th></th>","\n              <th></th>",
'\n            </tr>\n          </thead>\n          <tbody>\n            <tr class="version-listitem">','\n              <td class="center">',"\n                <input",' name="version-release"',' type="radio"',' value="current"',">","\n                <span>","<em>\u2713</em>","</span>","\n              </td>",'\n              <td>\n                <a apppath="','" class="app-link" href="','">Current</a>\n              </td>\n              <td></td>',"\n              <td></td>",'\n              <td><a href="',
'" target="_blank">view</a></td>',"\n              <td></td>","\n            </tr>",'\n            <tr class="version-listitem">',"",'\n              <td class="center">',"\n                <input",' name="version-release"',' type="radio"',' value="','"',">","\n                <span>","<em>\u2713</em>","</span>","\n              </td>",'\n              <td>\n                <a apppath="','" class="app-link" href="','">',"</a>\n              </td>     \n              <td>","\n                <span>\n                  ",
"","\n                  <span>\n                    [",'<a href="#0" onclick="return mjt._eventcb.','.apply(this, [event])">set to now</a>]\n                  </span>',"\n                </span>","\n              </td>",'\n              <td class="center">\n                <input',' class="version-service-url"',' key="','"',' type="checkbox"',">\n              </td>",'\n              <td><a href="','" target="_blank">view</a></td>','\n              <td class="remove">','\n                <a class="remove-version-button" href="#0" key="',
'">x</a>',"\n              </td>","\n            </tr>","\n          </tbody>\n        </table>\n      </div>","","",'<div class="tab-body"',">",'\n    <div class="tab-section">\n      <div class="sidebar">\n        <p>\n          View the changes between versions or even individual edits.\n        </p>\n        <p>\n          If you\'re an author, you can also <em>revert</em> the changes.\n        </p>\n      </div>\n      <h3>App History</h3>','\n      <button id="button-app-history" onclick="return mjt._eventcb.',
'.apply(this, [event])">\n        Diff Versions &amp; Edits</button>\n    </div>\n    <div class="tab-section">\n      <div class="sidebar">\n        <p>\n          View the changes between this app and it\'s parents or children.\n        </p>\n        <p>\n          If you\'re an author, you can also <em>merge</em> the changes.\n        </p>\n        \n      </div>\n      <h3>View Changes from Clones</h3>\n      <div id="clone-list">',"\n        <p>\n          <i>\n            This app does not have either parent or children apps.  <br>\n            Choose any app to view changes from below.\n          </i>\n        </p>",
"",'\n        <table class="edit-list">\n          <thead>\n            <tr colspan="2"><th class="left">Parent:</th></tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td class="left">\n                <a apppath="','" class="app-link" href="#0">','</a>\n              </td>\n              <td class="right">\n                <button class="button-get-changes" value="','">View Changes</button>\n              </td>\n            </tr>\n          </tbody>\n        </table>',
"",'\n        <table class="edit-list">\n          <thead>\n            <tr colspan="2"><th class="left">Children:</th></tr>\n          </thead>\n          <tbody>','\n            <tr>\n              <td class="left">\n                <a apppath="','" class="app-link" href="#0">','</a>\n              </td>\n              <td class="right">\n                <button class="button-get-changes" value="','">View Changes</button>\n              </td>\n            </tr>',"\n          </tbody>\n        </table>",
'\n      </div>\n    </div>\n    <div class="tab-section last">\n      <div class="sidebar">\n        <p>\n          Select any app you\'d like to view changes from.\n        </p>\n      </div>\n      <h3>View Changes from any App</h3>\n      <fieldset id="add-patch">\n        <label for="merge-app">Choose app: </label>\n        <input id="merge-app" maxlength="60" type="text">\n        <button class="button-get-changes" disabled="disabled" id="button-merge">\n          View Changes</button>\n      </fieldset>\n    </div>',
"\n  </div>","",'<div class="tab-body"','>\n    <div class="tab-section last">','\n      <div>\n        <div class="sidebar">\n          <p>\n            You can add other Freebase users as <em>Authors</em>\n            to your app.  Choose authors carefully! They can edit code, release versions, \n            and delete files.\n          </p>\n        </div>\n        <h3>Add an Author</h3>\n        <fieldset class="form-indent">\n          <label for="add-author-input">Find a user to add</label>\n          <input id="add-author-input" type="text">\n        </fieldset>\n    \n        <div id="app-authors-list">\n          ',
"\n        </div>","\n      </div>",'\n      <div>\n        <h3>Authors</h3>\n        <div id="app-authors-list">\n          ',"\n        </div>\n      </div>","\n    </div>\n  </div>","","",'\n    \n      <h4 class="list-title">These authors can edit this app:</h4>\n  \n      <table class="edit-list">','\n        <tr class="user-listitem">\n          <td class="user-image-cell">\n            <div class="user-image">\n              <a href="','" target="user" title="View profile for ','">\n                <!-- dummy but valid img src --\>\n                <img alt="mugshot" src="#">\n              </a>\n            </div>\n          </td>\n          <td>\n            <a class="user-name" href="',
'" target="user" title="View profile for ','">','</a>\n          </td>\n          <td class="remove">','\n            <a class="remove-user-button" href="#0" user="','">x</a>',"\n          </td>\n        </tr>","\n      </table>","","",'<div class="tab-body"',">",'\n    <div class="tab-section">\n      <fieldset id="permissions-settings">\n        <h3>Writing to Freebase</h3>\n        <div class="radiogroup">\n          <h5>\n            <input',' id="permission-oauth"',' type="checkbox"','>\n            Allow your users to write as themselves\n          </h5>\n          <p>\n            <small>Writes will be attributed to the user making them. Users will be asked to allow your app \n            to use their Freebase account. <strong>This is usually is the best choice</strong>.</small>\n          </p>\n        </div>\n        <div class="radiogroup">\n          <h5>\n            <input',
' id="permission-writeuser"',' type="checkbox"',">\n            Allow <strong>",'</strong> to write on behalf of any user\n          </h5>\n          <p>\n            <small>\n              Writes will all be attributed to this user. Be careful, however, as you may quickly exceed \n              Freebase\'s daily single-user write limit if you have a lot of users!<br>\n              <strong>\n                NOTE: If you\'ve also enabled your users to write, you will need to set the <em>http_sign</em>\n                option to <em>false</em> for any Freebase call you want written by this user\n              </strong>\n            </small>\n          </p>\n        </div>\n      </fieldset>\n    </div>\n    <div class="tab-section last">\n      <div class="sidebar">\n        <p>\n          <em>API keys</em> authorize information exchange with other web applications or services. Register your app with the <strong>service domain</strong> you want to use.  Each service handles this differently, so follow their instructions.  Once registered, enter the <strong>API key</strong> and <strong>secret</strong> (if required) provided by the service here.\n        </p>\n      </div>\n      <h3>Add an API Key</h3>',
"\n      <div>","","\n        <div>","<div>",'\n            <div id="app-apikeys-add">',"</div>\n          </div>",'<p><span class="loader-square hidden" id="version-loader"></span></p>',"<p>Error loading API keys.</p>","</div>\n      </div>",'\n      <div>\n        <p>\n          For your security, please <a href="https://','">switch to App Editor over SSL</a> to add or edit your API keys.\n        </p>\n      </div>',"\n    </div>","\n  </div>","",'\n      <fieldset>\n        <div class="form-row">\n          <label for="apikey-name">Service domain:</label>\n          <input id="apikey-name" type="text">\n        </div>\n        <div class="form-row">          \n          <label for="apikey-token">Key:</label>\n          <input id="apikey-token" type="text">\n        </div>\n        <div class="form-row">\n          <label for="apikey-secret">Secret:</label>\n          <input id="apikey-secret" type="text"><br>\n        </div>\n        <div class="form-row">\n          <button disabled="disabled" id="button-apikey-add">Add API Key</button>\n        </div>\n      </fieldset>',
'\n      <div id="api-key-list">\n      <h3>API Keys</h3>\n        <table class="edit-list">\n          <thead>\n            <tr class="key-listitem">\n              <th>Service Domain</th>\n              <th>Key</th>\n              <th>Secret</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>','\n            <tr class="key-listitem">\n              <td>',"</td>\n              <td>","</td>\n              <td>",'</td>\n              <td class="remove">','\n                <a class="remove-key-button" href="#0" key="',
'">x</a>',"\n              </td>\n            </tr>","\n          </tbody>\n        </table>\n      </div>",'\n      <h4 class="list-title">You haven\'t added any API keys.</h4>',"",""],debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,8,8,9,10,11,12,13,13,13,13,13,13,13,13,15,15,15,15,16,16,16,16,16,16,16,19,19,19,19,22,22,22,22,22,22,23,25,25,25,25,25,26,26,26,30,30,30,30,30,31,31,31,32,32,32,33,34,35,36,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,39,39,39,40,40,40,41,41,41,41,43,43,43,43,44,45,46,47,48,
49,50,50,50,50,50,50,51,51,51,51,52,52,53,54,55,56,57,57,57,57,57,58,59,59,59,59,59,60,60,60,60,60,60,60,60,61,61,61,63,63,63,63,63,63,63,64,64,64,65,65,65,66,67,68,69,70,71,72,73,73,73,73,73,73,76,76,76,76,76,76,76,77,77,78,79,80,81,82,83,83,87,87,87,87,87,87,87,88,88,88,88,88,90,90,90,90,91,91,94,94,94,94,94,94,94,94,94,95,95,96,97,98,99,100,101,102,103,104,105,108,108,108,108,108,108,108,108,108,108,108,108,108,108,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,111,111,
111,112,112,112,112,112,112,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,121,121,121,122,122,122,122,122,122,125,125,125,125,125,126,127,128,129,130,131,132,133,134,135,136,137,137,137,137,137,137,137,137,137,139,139,139,139,140,145,145,145,145,145,145,145,145,149,149,149,149,149,149,152,152,152,152,152,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,165,
165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,166,166,166,167,167,167,167,167,167,167,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,180,180,180,180,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,194,194,194,194,194,197,197,197,197,197,197,197,198,198,199,200,201,202,203,204,205,206,207,207,208,208,208,211,211,211,
211,211,211,211,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,212,213,213,213,213,213,214,214,214,214,214,214,214,216,216,216,216,217,217,218,218,218,221,221,221,221,221,221,221,221,221,221,221,221,221,221,221,221,221,221,221,221,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,224,224,224,224,225,225,226,226,226,229,229,229,229,229,229,229,229,229,229,229,229,229,229,229,229,229,229,229,229,230,230,230,230,230,230,230,230,230,230,230,
230,230,230,230,230,230,230,232,232,232,232,233,233,234,234,234,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,237,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,240,240,240,240,241,241,242,242,242,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,248,248,248,248,249,249,253,253,253,253,253,253,253,254,254,254,255,256,257,258,259,260,261,262,263,
264,265,265,265,265,265,265,268,268,268,268,268,268,268,273,273,273,273,273,273,273,273,273,273,273,275,275,275,275,275,275,275,275,277,277,277,277,277,277,277,277,279,279,279,279,279,279,279,279,281,281,281,281,281,281,281,281,283,283,283,283,292,292,292,292,292,292,292,292,292,292,292,300,300,300,300,300,300,300,300,300,300,300,300,300,300,303,303,303,303,303,304,305,306,307,308,309,309,309,309,309,309,312,312,312,312,312,312,312,313,313,314,315,316,316,316,316,316,316,316,323,323,323,323,323,323,
323,323,323,323,323,334,334,334,334,334,334,334,334,334,334,334,334,335,335,335,336,336,336,336,337,337,337,337,337,337,337,337,338,338,338,339,339,339,339,339,339,339,339,340,340,340,341,341,341,342,343,343,343,343,343,343,343,343,343,344,344,344,345,345,345,346,346,346,346,346,346,346,348,348,348,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,366,366,366,366,366,367,367,367,367,367,367,368,368,369,370,385,385,385,385,385,385,385,385,385,385,385,385,385,385,385,385,388,
388,388,388,388,388,388,388,388,388,391,391,391,391,391,391,391,391,391,392,392,392,393,393,393,394,394,394,398,398,398,398,398,399,400,401,402,403,403,408,408,408,408,408,408,408,408,408,408,408,408,411,411,411,411,411,412,414,414,414,414,414,414,414,415,415,415,416,416,416,416,417,418,419,420,421,422,423,424,425,426,427,427,430,430,430,430,430,430,433,433,433,433,433,433,433,433,433,435,435,435,435,436,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,455,458,458,458,
458,458,458,458,458,460,460,460,460,460,460,461,461,461,461,465,465,465,465,465,468,468,468,468,468,468,468,468,469,469,469,469,469,469,470,470,470,470,470,470,470,471,471,471,471,471,471,471,473,473,473,473,474,474,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,501,501,501,502,502,502,504,504,504,504,504,504,504,504,504,504,504,505,505,505,506,506,506,507,507,507,508,508,508,508,508,508,510,510,510,510,511,511,512,513,514,515,516,517,
518,519,520,521,522,523,524,525,526,527,528,529,530,536,536,536,536,536,536,536,536,536,536,539,539,539,539,539,539,539,541,541,541,541,541,541,546,546,546,546,546,546,547,547,547,547,547,547,547,547,547,547,547,547,547,547,547,547,547,547,547,547,547,548,548,548,548,548,548,548,548,549,549,549,551,551,551,551,551,551,554,554,554,554,554,554,554,555,555,555,556,556,556,556,556,558,558,558,558,558,559,559,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,573,575,575,575,575,575,575,575,575,
575,575,575,575,575,575,575,575,575,575,575,575,575,575,575,576,576,576,576,576,576,576,576,577,577,577,579,579,579,579,579,579,579,579,582,582,582,582,583,583,583,583,584,584,585,585,585,585,585,585,585,585,586,586,586,587,587,587,589,589,589,591,591,591,591,591,591,591,591,591,591,591,591,591,591,591,591,591,591,591,592,592,592,593,593,593,594,594,595,595,595,595,595,595,595,595,596,596,596,597,597,597,597,597,597,601,601,601,601,601,601,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,
616,617,618,619,620,621,621,622,622,622,622,622,622,624,624,624,624,624,624,625,625,626,627,628,629,640,640,640,640,640,640,640,640,640,640,640,640,640,640,640,640,640,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,660,660,660,660,660,660,660,660,661,661,668,668,668,668,668,668,668,668,668,668,668,668,671,671,671,671,671,675,675,675,675,675,675,676,676,681,681,681,681,681,681,681,681,681,683,683,683,683,683,683,683,686,686,686,686,686,688,688,688,688,688,688,688,690,690,690,690,707,
707,707,707,707,707,707,707,707,707,707,707,707,707,707,707,707,707,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,721,721,721,721,721,721,722,722,722,722,722,722,724,724,724,739,739,739,739,739,739,739,739,739,739,739,739,739,739,739,739,739,739,741,741,741,741,742,743,744,745,746,747,748,749,750,750,750,750,753,753,753,753,753,753,755,755,755,755,757,757,757,757,757,757,757,757,759,759,759,759,760,760,761,762,767,767,767,767,767,767,767,767,770,770,770,770,770,770,770,770,777,777,777,
777,777,777,777,777,777,777,777,777,777,780,780,780,780,780,780,780,780,780,782,782,782,782,782,782,782,784,784,784,784,785,786,787,788,789,790,791,792,793,793,793,793,793,793,794,794,794,794,794,794,795,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,817,817,817,817,817,817,817,817,817,817,817,817,817,817,817,817,817,817,817,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,827,828,828,828,850,850,850,850,850,850,850,850,850,850,850,850,850,
850,850,850,850,850,850,850,850,850,850,851,851,851,851,851,851,851,854,854,854,854,854,856,856,857,858,859,859,859,860,860,860,860,861,861,861,862,862,862,863,863,863,865,867,867,867,867,867,869,869,869,869,871,871,871,871,872,873,874,875,876,877,878,879,880,880,880,880,880,880,880,881,881,881,881,899,899,899,899,899,899,899,899,899,899,899,899,899,899,899,899,899,899,899,911,911,911,911,911,911,911,911,911,911,911,911,911,911,911,911,912,912,912,912,913,913,913,914,914,914,916,916,916,916,916,916,
916,916,918,918,918,918,918,918,918,921,921,921,921,921,922,922,922,922,923,923,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,942,942,942,942,942,942,942,942],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
