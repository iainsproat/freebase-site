
/*
 * Copyright 2012, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Additional Licenses for Third Party components can be found here:
 * http://wiki.freebase.com/wiki/Freebase_Site_License
 *
 */
/*
 
 jQuery Tools @VERSION Tabs- The basics of UI design.

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/tabs/

 Since: November 2008
 Date: @DATE 
*/
(function(a){function c(b,c,e){var m=this,j=b.add(this),l=b.find(e.tabs),q=c.jquery?c:b.children(c),h;l.length||(l=b.children());q.length||(q=b.parent().find(c));q.length||(q=a(c));a.extend(this,{click:function(b,c){var g=l.eq(b);"string"==typeof b&&b.replace("#","")&&(b=b.replace(/([\"\#\$\%\&\'\(\)\*\+\,\.\/\:\;\<\=\>\?\@\[\\\]\^\`\{\|\}\~])/g,"\\$1"),g=l.filter("[href*="+b.replace("#","")+"]"),b=Math.max(l.index(g),0));if(e.rotate){var i=l.length-1;if(0>b)return m.click(i,c);if(b>i)return m.click(0,
c)}if(!g.length){if(0<=h)return m;b=e.initialIndex;g=l.eq(b)}if(b===h)return m;c=c||a.Event();c.type="onBeforeClick";j.trigger(c,[b]);if(!c.isDefaultPrevented())return d[e.effect].call(m,b,function(){c.type="onClick";j.trigger(c,[b])}),h=b,l.removeClass(e.current),g.addClass(e.current),m},getConf:function(){return e},getTabs:function(){return l},getPanes:function(){return q},getCurrentPane:function(){return q.eq(h)},getCurrentTab:function(){return l.eq(h)},getIndex:function(){return h},next:function(){return m.click(h+
1)},prev:function(){return m.click(h-1)},destroy:function(){l.unbind(e.event).removeClass(e.current);q.find("a[href^=#]").unbind("click.T");return m}});a.each(["onBeforeClick","onClick"],function(b,c){a.isFunction(e[c])&&a(m).bind(c,e[c]);m[c]=function(b){a(m).bind(c,b);return m}});e.history&&a.fn.history&&(a.tools.history.init(l),e.event="history");l.each(function(b){a(this).bind(e.event,function(c){m.click(b,c);return c.preventDefault()})});q.find("a[href^=#]").bind("click.T",function(b){m.click(a(this).attr("href"),
b)});location.hash?m.click(location.hash):(0===e.initialIndex||0<e.initialIndex)&&m.click(e.initialIndex)}a.tools=a.tools||{version:"@VERSION"};a.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialIndex:0,event:"click",rotate:!1,history:!1},addEffect:function(b,c){d[b]=c}};var d={"default":function(b,c){this.getPanes().hide().eq(b).show();c.call()},fade:function(b,c){var a=this.getConf(),d=a.fadeOutSpeed,j=this.getPanes();d?j.fadeOut(d):j.hide();j.eq(b).fadeIn(a.fadeInSpeed,
c)},slide:function(b,c){this.getPanes().slideUp(200);this.getPanes().eq(b).slideDown(400,c)},ajax:function(b,c){this.getPanes().eq(0).load(this.getTabs().eq(b).attr("href"),c)}},b;a.tools.tabs.addEffect("horizontal",function(c,d){b||(b=this.getPanes().eq(0).width());this.getCurrentPane().animate({width:0},function(){a(this).hide()});this.getPanes().eq(c).animate({width:b},function(){a(this).show();d.call()})});a.fn.tabs=function(b,d){var e=this.data("tabs");e&&(e.destroy(),this.removeData("tabs"));
a.isFunction(d)&&(d={onBeforeClick:d});d=a.extend({},a.tools.tabs.conf,d);this.each(function(){e=new c(a(this),b,d);a(this).data("tabs",e)});return d.api?e:this}})(jQuery);
(function(a,c){function d(b){return!a(b).parents().andSelf().filter(function(){return"hidden"===a.curCSS(this,"visibility")||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.10",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return"number"===typeof b?this.each(function(){var d=this;setTimeout(function(){a(d).focus();c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;b=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,
"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(b){if(b!==c)return this.css("zIndex",b);if(this.length)for(var b=a(this[0]),d;b.length&&b[0]!==document;){d=b.css("position");if("absolute"===
d||"relative"===d||"fixed"===d)if(d=parseInt(b.css("zIndex"),10),!isNaN(d)&&0!==d)return d;b=b.parent()}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(b){b.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(b,d){function i(b,c,h,f){a.each(e,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0;h&&(c-=parseFloat(a.curCSS(b,"border"+
this+"Width",!0))||0);f&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)});return c}var e="Width"===d?["Left","Right"]:["Top","Bottom"],m=d.toLowerCase(),j={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(b){return b===c?j["inner"+d].call(this):this.each(function(){a(this).css(m,i(this,b)+"px")})};a.fn["outer"+d]=function(b,c){return"number"!==typeof b?j["outer"+d].call(this,b):this.each(function(){a(this).css(m,
i(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){var c=b.nodeName.toLowerCase(),i=a.attr(b,"tabindex");if("area"===c){c=b.parentNode;i=c.name;if(!b.href||!i||"map"!==c.nodeName.toLowerCase())return!1;b=a("img[usemap=#"+i+"]")[0];return!!b&&d(b)}return(/input|select|textarea|button|object/.test(c)?!b.disabled:"a"==c?b.href||!isNaN(i):!isNaN(i))&&d(b)},tabbable:function(b){var c=a.attr(b,"tabindex");return(isNaN(c)||0<=c)&&a(b).is(":focusable")}}),
a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=100===c.offsetHeight;a.support.selectstart="onselectstart"in c;b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var b=a.ui[b].prototype,e;for(e in d)b.plugins[e]=b.plugins[e]||[],b.plugins[e].push([c,d[e]])},call:function(b,c,a){if((c=b.plugins[c])&&b.element[0].parentNode)for(var d=0;d<c.length;d++)b.options[c[d][0]]&&
c[d][1].apply(b.element,a)}},contains:function(b,c){return document.compareDocumentPosition?b.compareDocumentPosition(c)&16:b!==c&&b.contains(c)},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;if(0<b[d])return!0;b[d]=1;e=0<b[d];b[d]=0;return e},isOverAxis:function(b,c,a){return b>c&&b<c+a},isOver:function(b,c,d,e,m,j){return a.ui.isOverAxis(b,d,m)&&a.ui.isOverAxis(c,e,j)}}))})(jQuery);
(function(a,c){if(a.cleanData){var d=a.cleanData;a.cleanData=function(b){for(var c=0,e;null!=(e=b[c]);c++)a(e).triggerHandler("remove");d(b)}}else{var b=a.fn.remove;a.fn.remove=function(c,d){return this.each(function(){d||(!c||a.filter(c,[this]).length)&&a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")});return b.call(a(this),c,d)})}}a.widget=function(b,c,d){var m=b.split(".")[0],j,b=b.split(".")[1];j=m+"-"+b;d||(d=c,c=a.Widget);a.expr[":"][j]=function(c){return!!a.data(c,
b)};a[m]=a[m]||{};a[m][b]=function(b,c){arguments.length&&this._createWidget(b,c)};c=new c;c.options=a.extend(!0,{},c.options);a[m][b].prototype=a.extend(!0,c,{namespace:m,widgetName:b,widgetEventPrefix:a[m][b].prototype.widgetEventPrefix||b,widgetBaseClass:j},d);a.widget.bridge(b,a[m][b])};a.widget.bridge=function(b,d){a.fn[b]=function(e){var m="string"===typeof e,j=Array.prototype.slice.call(arguments,1),l=this,e=!m&&j.length?a.extend.apply(null,[!0,e].concat(j)):e;if(m&&"_"===e.charAt(0))return l;
m?this.each(function(){var d=a.data(this,b),h=d&&a.isFunction(d[e])?d[e].apply(d,j):d;if(h!==d&&h!==c)return l=h,!1}):this.each(function(){var c=a.data(this,b);c?c.option(e||{})._init():a.data(this,b,new d(e,this))});return l}};a.Widget=function(b,c){arguments.length&&this._createWidget(b,c)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this);this.element=a(c);this.options=a.extend(!0,{},this.options,this._getCreateOptions(),
b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},
option:function(b,d){var e=b;if(0===arguments.length)return a.extend({},this.options);if("string"===typeof b){if(d===c)return this.options[b];e={};e[b]=d}this._setOptions(e);return this},_setOptions:function(b){var c=this;a.each(b,function(b,a){c._setOption(b,a)});return this},_setOption:function(b,c){this.options[b]=c;"disabled"===b&&this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",c);return this},enable:function(){return this._setOption("disabled",
!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var m=this.options[b],c=a.Event(c);c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();d=d||{};if(c.originalEvent)for(var b=a.event.props.length,j;b;)j=a.event.props[--b],c[j]=c.originalEvent[j];this.element.trigger(c,d);return!(a.isFunction(m)&&!1===m.call(this.element[0],c,d)||c.isDefaultPrevented())}}})(jQuery);
(function(a){a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var c=this;this.element.bind("mousedown."+this.widgetName,function(a){return c._mouseDown(a)}).bind("click."+this.widgetName,function(d){if(!0===a.data(d.target,c.widgetName+".preventClickEvent"))return a.removeData(d.target,c.widgetName+".preventClickEvent"),d.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(c){c.originalEvent=
c.originalEvent||{};if(!c.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(c);this._mouseDownEvent=c;var d=this,b=1==c.which,g="string"==typeof this.options.cancel?a(c.target).parents().add(c.target).filter(this.options.cancel).length:!1;if(!b||g||!this._mouseCapture(c))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=
!1!==this._mouseStart(c),!this._mouseStarted))return c.preventDefault(),!0;this._mouseMoveDelegate=function(b){return d._mouseMove(b)};this._mouseUpDelegate=function(b){return d._mouseUp(b)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);c.preventDefault();return c.originalEvent.mouseHandled=!0}},_mouseMove:function(c){if(a.browser.msie&&!(9<=document.documentMode)&&!c.button)return this._mouseUp(c);if(this._mouseStarted)return this._mouseDrag(c),
c.preventDefault();this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&((this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,c))?this._mouseDrag(c):this._mouseUp(c));return!this._mouseStarted},_mouseUp:function(c){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,c.target==this._mouseDownEvent.target&&a.data(c.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(c));
return!1},_mouseDistanceMet:function(c){return Math.max(Math.abs(this._mouseDownEvent.pageX-c.pageX),Math.abs(this._mouseDownEvent.pageY-c.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(a){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,b=a.fn.position,g=a.fn.offset;a.fn.position=function(i){if(!i||!i.of)return b.apply(this,arguments);var i=a.extend({},i),e=a(i.of),m=e[0],j=(i.collision||"flip").split(" "),l=i.offset?i.offset.split(" "):[0,0],g,h,f;9===m.nodeType?(g=e.width(),h=e.height(),f={top:0,left:0}):m.setTimeout?(g=e.width(),h=e.height(),f={top:e.scrollTop(),left:e.scrollLeft()}):m.preventDefault?(i.at="left top",g=h=0,f={top:i.of.pageY,left:i.of.pageX}):
(g=e.outerWidth(),h=e.outerHeight(),f=e.offset());a.each(["my","at"],function(){var b=(i[this]||"").split(" ");b.length===1&&(b=c.test(b[0])?b.concat(["center"]):d.test(b[0])?["center"].concat(b):["center","center"]);b[0]=c.test(b[0])?b[0]:"center";b[1]=d.test(b[1])?b[1]:"center";i[this]=b});1===j.length&&(j[1]=j[0]);l[0]=parseInt(l[0],10)||0;1===l.length&&(l[1]=l[0]);l[1]=parseInt(l[1],10)||0;"right"===i.at[0]?f.left+=g:"center"===i.at[0]&&(f.left+=g/2);"bottom"===i.at[1]?f.top+=h:"center"===i.at[1]&&
(f.top+=h/2);f.left+=l[0];f.top+=l[1];return this.each(function(){var b=a(this),c=b.outerWidth(),d=b.outerHeight(),e=parseInt(a.curCSS(this,"marginLeft",true))||0,m=parseInt(a.curCSS(this,"marginTop",true))||0,r=c+e+(parseInt(a.curCSS(this,"marginRight",true))||0),o=d+m+(parseInt(a.curCSS(this,"marginBottom",true))||0),p=a.extend({},f),w;if(i.my[0]==="right")p.left=p.left-c;else if(i.my[0]==="center")p.left=p.left-c/2;if(i.my[1]==="bottom")p.top=p.top-d;else if(i.my[1]==="center")p.top=p.top-d/2;
p.left=Math.round(p.left);p.top=Math.round(p.top);w={left:p.left-e,top:p.top-m};a.each(["left","top"],function(b,f){if(a.ui.position[j[b]])a.ui.position[j[b]][f](p,{targetWidth:g,targetHeight:h,elemWidth:c,elemHeight:d,collisionPosition:w,collisionWidth:r,collisionHeight:o,offset:l,my:i.my,at:i.at})});a.fn.bgiframe&&b.bgiframe();b.offset(a.extend(p,{using:i.using}))})};a.ui.position={fit:{left:function(b,c){var d=a(window),d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();b.left=
0<d?b.left-d:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=a(window),d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=0<d?b.top-d:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if("center"!==c.at[0]){var d=a(window),d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),j="left"===c.my[0]?-c.elemWidth:"right"===c.my[0]?c.elemWidth:0,l="left"===c.at[0]?c.targetWidth:-c.targetWidth,g=-2*c.offset[0];b.left+=
0>c.collisionPosition.left?j+l+g:0<d?j+l+g:0}},top:function(b,c){if("center"!==c.at[1]){var d=a(window),d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),j="top"===c.my[1]?-c.elemHeight:"bottom"===c.my[1]?c.elemHeight:0,l="top"===c.at[1]?c.targetHeight:-c.targetHeight,g=-2*c.offset[1];b.top+=0>c.collisionPosition.top?j+l+g:0<d?j+l+g:0}}}};a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),j=d.offset(),
l=parseInt(a.curCSS(b,"top",!0),10)||0,g=parseInt(a.curCSS(b,"left",!0),10)||0,j={top:c.top-j.top+l,left:c.left-j.left+g};"using"in c?c.using.call(b,j):d.css(j)},a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?this.each(function(){a.offset.setOffset(this,b)}):g.call(this)})})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(c){var d=this.options;if(this.helper||d.disabled||a(c.target).is(".ui-resizable-handle"))return!1;
this.handle=this._getHandle(c);return!this.handle?!1:!0},_mouseStart:function(c){var d=this.options;this.helper=this._createHelper(c);this._cacheHelperProportions();a.ui.ddmanager&&(a.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:c.pageX-
this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(c);this.originalPageX=c.pageX;this.originalPageY=c.pageY;d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt);d.containment&&this._setContainment();if(!1===this._trigger("start",c))return this._clear(),!1;this._cacheHelperProportions();a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,c);this.helper.addClass("ui-draggable-dragging");
this._mouseDrag(c,!0);return!0},_mouseDrag:function(c,d){this.position=this._generatePosition(c);this.positionAbs=this._convertPositionTo("absolute");if(!d){var b=this._uiHash();if(!1===this._trigger("drag",c,b))return this._mouseUp({}),!1;this.position=b.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,c);return!1},
_mouseStop:function(c){var d=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,c));this.dropped&&(d=this.dropped,this.dropped=!1);if((!this.element[0]||!this.element[0].parentNode)&&"original"==this.options.helper)return!1;if("invalid"==this.options.revert&&!d||"valid"==this.options.revert&&d||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var b=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,
10),function(){b._trigger("stop",c)!==false&&b._clear()})}else!1!==this._trigger("stop",c)&&this._clear();return!1},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(c){var d=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==c.target&&(d=!0)});return d},_createHelper:function(c){var d=this.options,c=a.isFunction(d.helper)?a(d.helper.apply(this.element[0],
[c])):"clone"==d.helper?this.element.clone():this.element;c.parents("body").length||c.appendTo("parent"==d.appendTo?this.element[0].parentNode:d.appendTo);c[0]!=this.element[0]&&!/(fixed|absolute)/.test(c.css("position"))&&c.css("position","absolute");return c},_adjustOffsetFromHelper:function(c){"string"==typeof c&&(c=c.split(" "));a.isArray(c)&&(c={left:+c[0],top:+c[1]||0});"left"in c&&(this.offset.click.left=c.left+this.margins.left);"right"in c&&(this.offset.click.left=this.helperProportions.width-
c.right+this.margins.left);"top"in c&&(this.offset.click.top=c.top+this.margins.top);"bottom"in c&&(this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();"absolute"==this.cssPosition&&(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))&&(c.left+=this.scrollParent.scrollLeft(),c.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==
document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.browser.msie)c={top:0,left:0};return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var c=this.element.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),
10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var c=this.options;"parent"==c.containment&&(c.containment=this.helper[0].parentNode);if("document"==c.containment||"window"==c.containment)this.containment=
[("document"==c.containment?0:a(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,("document"==c.containment?0:a(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,("document"==c.containment?0:a(window).scrollLeft())+a("document"==c.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==c.containment?0:a(window).scrollTop())+(a("document"==c.containment?document:window).height()||document.body.parentNode.scrollHeight)-
this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(c.containment)&&c.containment.constructor!=Array){var d=a(c.containment)[0];if(d){var c=a(c.containment).offset(),b="hidden"!=a(d).css("overflow");this.containment=[c.left+(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0)-this.margins.top,c.left+(b?Math.max(d.scrollWidth,
d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}}else c.containment.constructor==Array&&(this.containment=c.containment)},_convertPositionTo:function(c,d){d||(d=this.position);var b=
"absolute"==c?1:-1,g="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,i=/(html|body)/i.test(g[0].tagName);return{top:d.top+this.offset.relative.top*b+this.offset.parent.top*b-(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():i?0:g.scrollTop())*b),left:d.left+this.offset.relative.left*b+this.offset.parent.left*b-(a.browser.safari&&
526>a.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():i?0:g.scrollLeft())*b)}},_generatePosition:function(c){var d=this.options,b="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(b[0].tagName),i=c.pageX,e=c.pageY;if(this.originalPosition&&(this.containment&&(c.pageX-this.offset.click.left<this.containment[0]&&(i=
this.containment[0]+this.offset.click.left),c.pageY-this.offset.click.top<this.containment[1]&&(e=this.containment[1]+this.offset.click.top),c.pageX-this.offset.click.left>this.containment[2]&&(i=this.containment[2]+this.offset.click.left),c.pageY-this.offset.click.top>this.containment[3]&&(e=this.containment[3]+this.offset.click.top)),d.grid))e=this.originalPageY+Math.round((e-this.originalPageY)/d.grid[1])*d.grid[1],e=this.containment?!(e-this.offset.click.top<this.containment[1]||e-this.offset.click.top>
this.containment[3])?e:!(e-this.offset.click.top<this.containment[1])?e-d.grid[1]:e+d.grid[1]:e,i=this.originalPageX+Math.round((i-this.originalPageX)/d.grid[0])*d.grid[0],i=this.containment?!(i-this.offset.click.left<this.containment[0]||i-this.offset.click.left>this.containment[2])?i:!(i-this.offset.click.left<this.containment[0])?i-d.grid[0]:i+d.grid[0]:i;return{top:e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?
0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():g?0:b.scrollTop()),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():g?0:b.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},
_trigger:function(c,d,b){b=b||this._uiHash();a.ui.plugin.call(this,c,[d,b]);"drag"==c&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,c,d,b)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.10"});a.ui.plugin.add("draggable","connectToSortable",{start:function(c,d){var b=a(this).data("draggable"),g=b.options,i=a.extend({},
d,{item:b.element});b.sortables=[];a(g.connectToSortable).each(function(){var d=a.data(this,"sortable");d&&!d.options.disabled&&(b.sortables.push({instance:d,shouldRevert:d.options.revert}),d._refreshItems(),d._trigger("activate",c,i))})},stop:function(c,d){var b=a(this).data("draggable"),g=a.extend({},d,{item:b.element});a.each(b.sortables,function(){this.instance.isOver?(this.instance.isOver=0,b.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=
!0),this.instance._mouseStop(c),this.instance.options.helper=this.instance.options._helper,"original"==b.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",c,g))})},drag:function(c,d){var b=a(this).data("draggable"),g=this;a.each(b.sortables,function(){this.instance.positionAbs=b.positionAbs;this.instance.helperProportions=b.helperProportions;this.instance.offset.click=b.offset.click;this.instance._intersectsWith(this.instance.containerCache)?
(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(g).clone().appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return d.helper[0]},c.target=this.instance.currentItem[0],this.instance._mouseCapture(c,!0),this.instance._mouseStart(c,!0,!0),this.instance.offset.click.top=b.offset.click.top,this.instance.offset.click.left=b.offset.click.left,this.instance.offset.parent.left-=
b.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=b.offset.parent.top-this.instance.offset.parent.top,b._trigger("toSortable",c),b.dropped=this.instance.element,b.currentItem=b.element,this.instance.fromOutside=b),this.instance.currentItem&&this.instance._mouseDrag(c)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",c,this.instance._uiHash(this.instance)),this.instance._mouseStop(c,
!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),b._trigger("fromSortable",c),b.dropped=!1)})}});a.ui.plugin.add("draggable","cursor",{start:function(){var c=a("body"),d=a(this).data("draggable").options;c.css("cursor")&&(d._cursor=c.css("cursor"));c.css("cursor",d.cursor)},stop:function(){var c=a(this).data("draggable").options;c._cursor&&a("body").css("cursor",c._cursor)}});a.ui.plugin.add("draggable",
"iframeFix",{start:function(){var c=a(this).data("draggable").options;a(!0===c.iframeFix?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")})},stop:function(){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});a.ui.plugin.add("draggable","opacity",{start:function(c,
d){var b=a(d.helper),g=a(this).data("draggable").options;b.css("opacity")&&(g._opacity=b.css("opacity"));b.css("opacity",g.opacity)},stop:function(c,d){var b=a(this).data("draggable").options;b._opacity&&a(d.helper).css("opacity",b._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var c=a(this).data("draggable");c.scrollParent[0]!=document&&"HTML"!=c.scrollParent[0].tagName&&(c.overflowOffset=c.scrollParent.offset())},drag:function(c){var d=a(this).data("draggable"),b=d.options,
g=!1;if(d.scrollParent[0]!=document&&"HTML"!=d.scrollParent[0].tagName){if(!b.axis||"x"!=b.axis)d.overflowOffset.top+d.scrollParent[0].offsetHeight-c.pageY<b.scrollSensitivity?d.scrollParent[0].scrollTop=g=d.scrollParent[0].scrollTop+b.scrollSpeed:c.pageY-d.overflowOffset.top<b.scrollSensitivity&&(d.scrollParent[0].scrollTop=g=d.scrollParent[0].scrollTop-b.scrollSpeed);if(!b.axis||"y"!=b.axis)d.overflowOffset.left+d.scrollParent[0].offsetWidth-c.pageX<b.scrollSensitivity?d.scrollParent[0].scrollLeft=
g=d.scrollParent[0].scrollLeft+b.scrollSpeed:c.pageX-d.overflowOffset.left<b.scrollSensitivity&&(d.scrollParent[0].scrollLeft=g=d.scrollParent[0].scrollLeft-b.scrollSpeed)}else{if(!b.axis||"x"!=b.axis)c.pageY-a(document).scrollTop()<b.scrollSensitivity?g=a(document).scrollTop(a(document).scrollTop()-b.scrollSpeed):a(window).height()-(c.pageY-a(document).scrollTop())<b.scrollSensitivity&&(g=a(document).scrollTop(a(document).scrollTop()+b.scrollSpeed));if(!b.axis||"y"!=b.axis)c.pageX-a(document).scrollLeft()<
b.scrollSensitivity?g=a(document).scrollLeft(a(document).scrollLeft()-b.scrollSpeed):a(window).width()-(c.pageX-a(document).scrollLeft())<b.scrollSensitivity&&(g=a(document).scrollLeft(a(document).scrollLeft()+b.scrollSpeed))}!1!==g&&(a.ui.ddmanager&&!b.dropBehaviour)&&a.ui.ddmanager.prepareOffsets(d,c)}});a.ui.plugin.add("draggable","snap",{start:function(){var c=a(this).data("draggable"),d=c.options;c.snapElements=[];a(d.snap.constructor!=String?d.snap.items||":data(draggable)":d.snap).each(function(){var b=
a(this),d=b.offset();this!=c.element[0]&&c.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:d.top,left:d.left})})},drag:function(c,d){for(var b=a(this).data("draggable"),g=b.options,i=g.snapTolerance,e=d.offset.left,m=e+b.helperProportions.width,j=d.offset.top,l=j+b.helperProportions.height,q=b.snapElements.length-1;0<=q;q--){var h=b.snapElements[q].left,f=h+b.snapElements[q].width,n=b.snapElements[q].top,t=n+b.snapElements[q].height;if(h-i<e&&e<f+i&&n-i<j&&j<t+i||h-i<
e&&e<f+i&&n-i<l&&l<t+i||h-i<m&&m<f+i&&n-i<j&&j<t+i||h-i<m&&m<f+i&&n-i<l&&l<t+i){if("inner"!=g.snapMode){var u=Math.abs(n-l)<=i,x=Math.abs(t-j)<=i,v=Math.abs(h-m)<=i,r=Math.abs(f-e)<=i;u&&(d.position.top=b._convertPositionTo("relative",{top:n-b.helperProportions.height,left:0}).top-b.margins.top);x&&(d.position.top=b._convertPositionTo("relative",{top:t,left:0}).top-b.margins.top);v&&(d.position.left=b._convertPositionTo("relative",{top:0,left:h-b.helperProportions.width}).left-b.margins.left);r&&
(d.position.left=b._convertPositionTo("relative",{top:0,left:f}).left-b.margins.left)}var o=u||x||v||r;if("outer"!=g.snapMode&&(u=Math.abs(n-j)<=i,x=Math.abs(t-l)<=i,v=Math.abs(h-e)<=i,r=Math.abs(f-m)<=i,u&&(d.position.top=b._convertPositionTo("relative",{top:n,left:0}).top-b.margins.top),x&&(d.position.top=b._convertPositionTo("relative",{top:t-b.helperProportions.height,left:0}).top-b.margins.top),v&&(d.position.left=b._convertPositionTo("relative",{top:0,left:h}).left-b.margins.left),r))d.position.left=
b._convertPositionTo("relative",{top:0,left:f-b.helperProportions.width}).left-b.margins.left;!b.snapElements[q].snapping&&(u||x||v||r||o)&&b.options.snap.snap&&b.options.snap.snap.call(b.element,c,a.extend(b._uiHash(),{snapItem:b.snapElements[q].item}));b.snapElements[q].snapping=u||x||v||r||o}else b.snapElements[q].snapping&&b.options.snap.release&&b.options.snap.release.call(b.element,c,a.extend(b._uiHash(),{snapItem:b.snapElements[q].item})),b.snapElements[q].snapping=!1}}});a.ui.plugin.add("draggable",
"stack",{start:function(){var c=a(this).data("draggable").options,c=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(c.length){var d=parseInt(c[0].style.zIndex)||0;a(c).each(function(b){this.style.zIndex=d+b});this[0].style.zIndex=d+c.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(c,d){var b=a(d.helper),g=a(this).data("draggable").options;b.css("zIndex")&&(g._zIndex=b.css("zIndex"));b.css("zIndex",g.zIndex)},
stop:function(c,d){var b=a(this).data("draggable").options;b._zIndex&&a(d.helper).css("zIndex",b._zIndex)}})})(jQuery);
shortcut={all_shortcuts:{},add:function(a,c,d){var b={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1};if(d)for(var g in b)"undefined"==typeof d[g]&&(d[g]=b[g]);else d=b;b=d.target;"string"==typeof d.target&&(b=document.getElementById(d.target));a=a.toLowerCase();g=function(b){b=b||window.event;if(d.disable_in_input){var e;b.target?e=b.target:b.srcElement&&(e=b.srcElement);3==e.nodeType&&(e=e.parentNode);if("INPUT"==e.tagName||"TEXTAREA"==e.tagName)return}b.keyCode?code=
b.keyCode:b.which&&(code=b.which);e=String.fromCharCode(code).toLowerCase();188==code&&(e=",");190==code&&(e=".");var g=a.split("-"),j=0,l={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},q={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,
end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},h=!1,f=!1,n=!1,t=!1,u=!1,x=!1,v=!1,r=!1;b.ctrlKey&&(t=!0);b.shiftKey&&(f=!0);b.altKey&&(x=!0);b.metaKey&&(r=!0);for(var o=0;k=g[o],o<g.length;o++)"ctrl"==k||"control"==k?(j++,n=!0):"shift"==k?(j++,h=!0):"alt"==k?(j++,u=!0):"meta"==k?(j++,v=!0):1<k.length?q[k]==code&&j++:d.keycode?d.keycode==code&&j++:e==k?j++:l[e]&&
b.shiftKey&&(e=l[e],e==k&&j++);if(j==g.length&&(t==n&&f==h&&x==u&&r==v)&&(c(b),!d.propagate))return b.cancelBubble=!0,b.returnValue=!1,b.stopPropagation&&(b.stopPropagation(),b.preventDefault()),!1};this.all_shortcuts[a]={callback:g,target:b,event:d.type};b.addEventListener?b.addEventListener(d.type,g,!1):b.attachEvent?b.attachEvent("on"+d.type,g):b["on"+d.type]=g},remove:function(a){var a=a.toLowerCase(),c=this.all_shortcuts[a];delete this.all_shortcuts[a];if(c){var a=c.event,d=c.target,c=c.callback;
d.detachEvent?d.detachEvent("on"+a,c):d.removeEventListener?d.removeEventListener(a,c,!1):d["on"+a]=!1}}};
var assert={critical:function(a,c){a||("undefined"!==typeof mjt&&mjt.error?mjt.error("Internal Error: "+c):"undefined"!==typeof console&&console.error&&console.error("Internal Error: "+c),document.getElementById("error-dialog")||assert.error_dialog('<div style="font-weight:bold;">Internal Error</div>'+c))},error_dialog:function(a){var c=document.createElement("div");c.style.cssText="position: absolute; top: 30px; left: 50%; width: 350px; margin: 0 0 0 -175px; padding: 15px; background-color: #fce2db; border: 1px solid #f3c5ac; color: #676767; font-size: 12px; z-index: 100;";c.innerHTML=
'<div id="error-dialog" style="float:right; color: #1170a3; margin: -10px -5px 0 0; cursor: pointer;" onclick="document.body.removeChild(this.parentNode);">x</div>'+a;document.body.appendChild(c)}},unicode={escape_char:function(a){a=a.charCodeAt(0).toString(16).toUpperCase();return 1===a.length?"\\u000"+a:2===a.length?"\\u00"+a:3===a.length?"\\u0"+a:4===a.length?"\\u"+a:null},escape_str:function(a){return a.replace(/[^\u0020-\u007F]/g,unicode.escape_char)}},zen=function(){function a(j,q){if(!j||!j.length)return"";
var h=j.shift().split("+"),f=h.length-1,n=a(j,q+1);return h.map(function(a,h){var j=h===f?n:"";m.newTag();var l=a.replace(d,m.tag).replace(b,m.id).replace(g,m.className).replace(i,m.attr).replace(e,m.mult);l.length&&!c.length&&(c=l);return m.html(j,q)}).join("\n")}var c="",d=/^[\w:]+/,b=/^\#[:\w\$]+/,g=/^(\.[\w\$]+)+/,i=/^\[.+\]/,e=/^\*\d+/,m,j;m={newTag:function(){return j={tagName:"div"}},tag:function(b){j.tagName=b;return""},id:function(b){j.id=b.slice(1);return""},className:function(b){j.className=
b.slice(1).replace(/\./g," ");return""},attr:function(b){j.attrs=b.slice(1,-1);return""},mult:function(b){j.multiplier=parseInt(b.slice(1),10);return""},html:function(b,c){for(var a="<"+j.tagName+(j.id?' id="'+j.id+'"':"")+(j.className?' class="'+j.className+'"':"")+(j.attrs?" "+j.attrs:"")+">"+(b?"\n"+b+"\n"+Array(c+1).join("  "):"")+"</"+j.tagName+">",f=[],d=0,e=j.multiplier||1;d<e;d++)f[d]=a.replace(/\$/g,d+1);return Array(c+1).join("  ")+f.join("\n"+Array(c+1).join("  "))}};return{convert:function(b,
j){c="";var h=b.split("|"),f=h[0].split(">"),h=h[1],f=a(f,j||0);h&&("e"===h?f=f.replace(/</g,"&lt;").replace(/>/g,"&gt;"):c="Unknown filter "+h);/^[\.\#\[\*]$/.test(c)&&(c="");return{out:f,error:c}}}}(),FreebaseStore;
(function(){FreebaseStore=function(c,a){this._url=c||fb.acre.freebase.service_url;this._site_url=fb.acre.freebase.site_host;this._acre_server=a||fb.acre.host.name+(80===fb.acre.host.port?"":":"+fb.acre.host.port);this._handlers=[];this._user=null;return this};FreebaseStore.prototype.set_user=function(c){c?(this._user=new AcreUser(this,c),c.apps&&(this._user_apps=c.apps),mjt.freebase.freebase_user={name:c.name,id:"/user/"+c.name}):(this._user_apps=this._user=null,mjt.freebase.freebase_user=null)};
FreebaseStore.prototype.set_csrf_token=function(c){this._csrf_token=c};FreebaseStore.prototype.t_init=function(){var c=this;c._service_path=fb.acre.appeditor.service_path;var a=mjt.define_task(mjt.freebase.FreebaseJsonPTask,[{name:"service"},{name:"args"}]);a.prototype.request=function(){return this.service_request(c.get_service_path()+this.service,this.args)};a.prototype.response=function(b){return this.ready(b.result)};var b=mjt.define_task(mjt.freebase.FreebaseXhrTask,[{name:"service"},{name:"args"}]);
b.prototype.request=function(){var b=c.get_service_path()+this.service;this.args&&(b+="?"+mjt.formencode(this.args));return this.xhr_request("GET",b).onready(function(b){b.csrf_token&&(c.set_csrf_token(b.csrf_token),delete b.csrf_token)})};var g=mjt.define_task(mjt.freebase.FreebaseXhrTask,[{name:"service"},{name:"args"}]);g.prototype.request=function(){this.args.ACRE_CSRF_TOKEN=c.get_csrf_token();return this.xhr_form_post(c.get_service_path()+this.service,this.args)};var i=mjt.define_task(null,[{name:"service"},
{name:"form"},{name:"args"}]);i.prototype.dynamic_iframe=function(b){var c=document.createElement("iframe");"string"===typeof b&&(c.id=b,c.name=b);c.style.display="none";c.className="mjt_dynamic";return c};i.prototype.request=function(){function b(){var c=d.contentWindow||d.contentDocument;return c.document?c.document:c}function a(){window.setTimeout(function(){$(d).remove()},1)}this.domid=mjt.uniqueid("mjt_iframe");var d=this.dynamic_iframe(this.domid);$("body").append(d);var e=this.form,h=this,
f=window.setTimeout(function(){h.error("timeout","Upload timed out - no response from server.");a()},3E4);d.onload=function(){window.clearTimeout(f);var c=$(b(d).body).text(),c=JSON.parse(c);"/api/status/ok"===c.code?(h.result=c.result,h.ready(h.result)):h.error(c.code,c.messages[0].message);a()};this.args.ACRE_CSRF_TOKEN=c.get_csrf_token();e.attr({target:this.domid,action:mjt.form_url(c.get_service_path()+this.service,this.args),method:"POST",enctype:"multipart/form-data"}).submit()};var e=mjt.define_task(mjt.freebase.FreebaseJsonPTask,
[{name:"service_url","default":null}]);e.prototype.request=function(){this.jsonp.cache_controller={is_fresh:function(){return!1}};return this.service_request("/acre/touch?_="+ +new Date)};e.prototype.response=function(){return this.ready(null)};c.Jsonp=a;c.XhrGet=b;c.XhrPost=g;c.FileUpload=i;c.AppTouch=e;mjt.app=new mjt.App;mjt.freebase.service_url=window.location.protocol+"//"+window.location.host;mjt.freebase.xhr_ok=!0;return this.XhrGet("init_store").onready(function(b){c._csrf_token=b.csrf_token;
c._acre_server=b.host.name+(80===b.host.port?"":":"+b.host.port);c._handlers=b.acre_handlers;c._version=b.version;c.set_user(b.user)}).enqueue()};FreebaseStore.prototype.destroy=function(){};var a=mjt.define_task(null,[{name:"store"}]);a.prototype.request=function(){this.url=window.location.protocol+fb.acre.apps.appeditor+"."+this.store.get_acre_host()+"/services/check_thirdparty_cookies";var c=this;this.jsonp=mjt.JsonP();this.jsonp.set_timeout().jsonp_request_form(this.url,null,"callback").onready(function(a){"success"===
a.result?c.ready():c.error()}).onerror("error",c)};FreebaseStore.prototype.TestCookies=a;FreebaseStore.prototype.get_service_path=function(){return this._service_path};FreebaseStore.prototype.get_acre_version=function(){return this._version};FreebaseStore.prototype.get_user=function(){return this._user};FreebaseStore.prototype.get_csrf_token=function(){return this._csrf_token};FreebaseStore.prototype.get_user_apps=function(c){if(c){for(var a=0;a<this._user_apps.length;a++)if(this._user_apps[a].appid==
c)return this._user_apps[a].appid;return null}return this._user_apps};FreebaseStore.prototype.set_user_apps=function(c){this._user_apps=c};FreebaseStore.prototype.t_refresh_user_apps=function(){var c=this;c.XhrGet("list_user_apps").enqueue().onready(function(a){c._user_apps=a})};FreebaseStore.prototype.get_url=function(){return this._url};FreebaseStore.prototype.get_service_path=function(){return this._service_path};FreebaseStore.prototype.get_name=function(){var c=this._name?this._name:"???";"OTG"===
c&&(c="");return c};FreebaseStore.prototype.get_acre_handlers=function(){return this._handlers};FreebaseStore.prototype.get_acre_host=function(){return this._acre_server};FreebaseStore.prototype.get_freebase_url=function(){return this._site_url};FreebaseStore.prototype.get_user_new_app_path=function(c,a){return"//"+a+"."+c.get_name()+".user.dev"};FreebaseStore.prototype.get_user_default_app_host=function(c){return c.get_name()+".user.dev."+this.get_acre_host()};FreebaseStore.prototype.get_user_view_url=
function(c){return this.get_freebase_url()+"/user/"+c.get_name()};FreebaseStore.prototype.get_user_image_url=function(c){return fb.h.image_url("/user/"+c.get_name(),{maxwidth:30,maxheight:30,mode:"fillcrop"})};FreebaseStore.prototype.validate_filename=function(c){return!/^[A-Za-z][\-_0-9A-Za-z\.\/]+$/.test(c)||c in{acre:!0,status:"",api:!0}?!1:!0};mjt.label_package("FreebaseStore")})();var AcreDoc;
(function(){AcreDoc=function(a,c,d,b){assert.critical(a,"Must specify app when creating a file");this._app=a;this._name=c&&this._app.get_store().validate_filename(c)?c:this._app.get_untitled_file_name();this._acre_handler=d.handler;this._mime_type=d.media_type||"text/plain";this._revision=d.content_id||null;this._based_on=d.based_on||null;this._has_been_saved=d.has_been_saved||!1;this._dom_element=document.createElement("div");this._dom_element.className="file";this._event_handlers={};this._initial_state=
b||null;a=!this.has_been_saved();this._dirty_state={name:a,content:a,metadata:a,to_delete:!1,revision:!1,editor:!1};this._loaded_editors={};this._current_editor=null;this._app.register_file(this);return this};AcreDoc.prototype.t_get_history=function(){var a={fileid:this.get_fileid()};return this.get_store().XhrGet("get_file_history",a).enqueue()};AcreDoc.prototype.t_get_revision=function(a){var c={fileid:this.get_fileid()};return this.get_app().get_repository_capability("versioned")?(c.revision=a||
this.get_revision(),c.revision?this.get_store().XhrGet("get_file_revision",c):mjt.Succeed({text:""})):this.get_store().XhrGet("get_file_revision",c)};AcreDoc.prototype.hide=function(){this._current_editor&&this._current_editor.hide();$(this._dom_element).hide()};AcreDoc.prototype.destroy=function(){for(var a in this._loaded_editors){var c=this._loaded_editors[a];c.destroy&&c.destroy()}$(this._dom_element).remove()};AcreDoc.prototype.is_writable=function(){return this.get_app().is_writable()};AcreDoc.prototype.has_been_saved=
function(){return!!this._has_been_saved};AcreDoc.prototype.is_dirty=function(a){if(a)return this._dirty_state[a];for(var c in this._dirty_state)if(!0===this._dirty_state[c])return!0;return!1};AcreDoc.prototype.get_element=function(){return this._dom_element};AcreDoc.prototype.get_store=function(){return this.get_app().get_store()};AcreDoc.prototype.get_app=function(){return this._app};AcreDoc.prototype.get_name=function(){return this._name};AcreDoc.prototype.get_fileid=function(){var a=this._old_name||
this._name;return this.get_app().get_path()+"/"+a};AcreDoc.prototype.get_relative_path=function(){return this.get_name()};AcreDoc.prototype.get_revision=function(){return this._revision};AcreDoc.prototype.get_acre_handler=function(){return this._acre_handler?this._acre_handler:this.get_app().get_extension_metadata(this._name).handler||"acre_script"};AcreDoc.prototype.get_mime_type=function(){return this.get_app().get_extension_metadata(this._name).media_type||this._mime_type};AcreDoc.prototype.is_library=
function(){return this._library};AcreDoc.prototype.get_based_on=function(){return this._based_on};AcreDoc.prototype.get_acre_url=function(a){return this.get_app().get_base_url()+"/"+this.get_name()+(a?"?acre.console=1":"")};AcreDoc.prototype.set_name=function(a){if(a!==this.get_name()){if(!/^[\-_0-9A-Za-z\.]+$/.test(a))throw"File names can only contain alphanumeric characters, ., - and _";if(!/^[A-Za-z]/.test(a))throw"File names must be begin with a letter";if(!/[0-9A-Za-z]$/.test(a))throw"File names cannot end with a special character";
this._old_name=this.get_name();this.get_app().unregister_file(this._old_name);this._name=a;this.get_app().register_file(this);this.set_dirty("name")}};AcreDoc.prototype.set_acre_handler=function(a){a!==this._acre_handler&&(this._acre_handler=a,this.set_dirty("metadata"),this.set_dirty("editor"))};AcreDoc.prototype.set_mime_type=function(a){a!==this._mime_type&&(this._mime_type=a,this.set_dirty("content"),this.set_dirty("editor"))};AcreDoc.prototype.set_revision=function(a){if(this.is_dirty("content")||
a!==this._revision)this._revision=a,this.set_dirty("revision"),this.set_dirty("editor");this.set_dirty("content",!1);this.set_dirty("to_delete",!1)};AcreDoc.prototype.set_dirty=function(a,c){var d=a||"content",b="undefined"==typeof c?!0:c;if("all"===d)for(var g in this._dirty_state)this._dirty_state[g]=b;else this._dirty_state[d]=b};AcreDoc.prototype.t_save=function(a){var c=this;if(c.is_dirty("to_delete"))return c.t_delete();var d={fileid:c.get_fileid()},b=c.get_store().XhrPost("save_text_file",
d);!c.has_been_saved()&&c.get_based_on()&&(d.based_on=c.get_based_on().id);c.is_dirty("name")&&(d.name=c.get_name());if(c.is_dirty("metadata")||!c.has_been_saved()){var g=c.get_acre_handler();g&&(d.acre_handler=g)}if(!a&&c.get_revision()&&(!c.is_dirty("content")||!c.is_dirty("revision")))d.revision=c.get_revision();c.is_dirty("content")?(a=c.get_editor_state(),a.form?b=c.get_store().FileUpload("save_binary_file",a.form,d):(d.text=a.text,d.content_type=c.get_mime_type())):c.is_dirty("revision")&&(b=
c.get_store().XhrPost("set_file_revision",d));b.onready(function(b){if(b.content_id)c._revision=b.content_id;if(b.content_type)c._mime_type=b.content_type;delete c._old_name;c._has_been_saved=true;c.set_dirty("all",false);c._current_editor&&typeof c._current_editor.refresh==="function"&&c._current_editor.refresh();c.get_app().t_flush_cache().onerror(function(b,c,a){console.log("Touch failed: ",b," - ",c,a)}).enqueue()}).onerror(function(b,a,d){if(b==="/api/status/error/file_format/unsupported_mime_type"){delete c._old_name;
c._has_been_saved=true;c.set_dirty("all",false)}else mjt.warn("Save of",c.get_name(),"failed: ",b," - ",a,d)});return b.enqueue()};AcreDoc.prototype.t_delete=function(){function a(){c.get_app().unregister_file(c.get_name());c.destroy()}var c=this,d={appid:c.get_app().get_path(),name:c.get_name()};if(!c.has_been_saved())return mjt.Succeed().enqueue().onready(a);d=c.get_store().XhrPost("delete_app_file",d).onready(a).onerror(function(b,a,d){mjt.warn("Delete of",c.get_name(),"failed: ",b," - ",a,d)});
return this.get_app().t_flush_cache().require(d).enqueue()};AcreDoc.prototype.t_revert_to_saved=function(){var a=this,c={fileid:a.get_fileid()};return a.get_store().XhrGet("get_file",c).onready(function(c){a.set_name(c.name);a.set_acre_handler(c.handler);a.set_mime_type(c.content_type);a.set_revision(c.content_id);a.set_dirty("all",!1);a.clear_editors()}).onerror(function(c,b,g){mjt.warn("Rever of",a.get_name(),"failed: ",c," - ",b,g)}).enqueue()};AcreDoc.prototype.is_editor_loaded=function(a){var c=
!1;if(a)c=this._loaded_editors[a]?!0:!1;else for(var d in this._loaded_editors){c=!0;break}return c};AcreDoc.prototype.clear_editors=function(a){function c(b){var c=d._loaded_editors[b];c.destroy&&c.destroy();delete d._loaded_editors[b]}var d=this;if(a)d.get_edtior_name()===a&&(d._current_editor=null),c(a);else{d._current_editor=null;for(var b in d._loaded_editors)c(b)}};AcreDoc.prototype.get_editor_name=function(){for(var a in EDITORS)if(this._current_editor&&this._current_editor instanceof EDITORS[a].editor_class)return a;
return!1};AcreDoc.prototype.t_editor_show=function(a,c,d){var b=this;if(b._showing_editor)return mjt.Succeed().enqueue();b._showing_editor=!0;var g=null;d?(g=d,b.set_dirty("content")):b.is_dirty("revision")?g=null:b._current_editor?g=b.get_editor_state():b._initial_state&&(g=b._initial_state,b._initial_state=null);b.is_dirty("editor")&&(b.clear_editors(),b.set_dirty("editor",!1));d=EDITORS[a].editor_class;b._current_editor&&!(b._current_editor instanceof d)&&b._current_editor.hide();return"undefined"!==
typeof b._loaded_editors[a]?(b._current_editor=b._loaded_editors[a],b.is_dirty("content")&&g&&b.set_editor_state(g),b._current_editor.show(c),b._showing_editor=!1,mjt.Succeed().enqueue()):d.t_load(b,g).onready(function(d){b._loaded_editors[a]=d;b._current_editor=b._loaded_editors[a];b._current_editor.show(c);b._showing_editor=false}).onerror(function(c,a,d){mjt.warn("Loading of",b.get_name(),"failed: ",c," - ",a,d)}).enqueue()};AcreDoc.prototype.get_editor_state=function(){var a=null;this._current_editor?
a=this._current_editor.get_state():this._initial_state&&(a=this._initial_state);return a};AcreDoc.prototype.set_editor_state=function(a){assert.critical(a,"Trying to set undefined editor state");this._current_editor&&this._current_editor.set_state(a)};AcreDoc.prototype.get_editor_supported_features=function(a){if(!this.get_editor_name())return!1;var c=EDITORS[this.get_editor_name()].supports;return a?!!c[a]:c};AcreDoc.prototype.register_editor_event_handlers=function(a){for(var c in a)this._event_handlers[c]=
a[c]};AcreDoc.prototype.trigger_editor_event=function(a,c){if("change"===a){var d=c[0];"number"!==typeof d?this.set_dirty("content"):0<d?(this.set_dirty("content"),this.set_dirty("revision",!1)):this.set_dirty("content",!1)}this._event_handlers[a]&&this._event_handlers[a].apply(this,c)};AcreDoc.prototype.editor_undo=function(){this._current_editor&&this._current_editor.undo&&this._current_editor.undo()};AcreDoc.prototype.editor_redo=function(){this._current_editor&&this._current_editor.redo&&this._current_editor.redo()};
AcreDoc.prototype.editor_indent=function(){this._current_editor&&this._current_editor.reindentSelection&&this._current_editor.reindentSelection()};AcreDoc.prototype.editor_goto_line=function(a){this._current_editor&&this._current_editor.goto_line&&this._current_editor.goto_line(Number(a))}})();var AcreApp;
(function(){AcreApp=function(a,c){this._store=a;this._acre_host=a.get_acre_host();this._service_url=a.get_url();this._path=c;this._version=null;this._name="Untitled";this._release=this._listed=this._write_user=null;this._hosts=[];this._versions=[];this._handlers=$.extend(!0,{},a.get_acre_handlers());this._extensions={};this._authors={};this._files={};this._untitled_label="untitled_";this._untitled_counter=1;return this};AcreApp.prototype.t_load=function(){var a=this;return a._store.XhrGet("get_app",
{appid:a._path}).onready(function(c){a._acre_host=c.acre_host;a._remote_app=c.acre_host!==a.get_store().get_acre_host();a._repository=c.repository||{versioned:!0};a._path=c.path;a._appid=c.id;a._version=c.version;a._name=c.name||"Untitled";a._write_user=c.write_user;a._parent=c.parent;a._children=c.children;a._listed=c.listed;a._release=c.release;a._hosts=c.hosts;a._versions=c.all_versions||[];a._last_edit=null;a._initial_file=c.current_file;a._extensions=c.extensions;for(var d in c.handlers)a._handlers[d]=
a._handlers[d]||{key:d,name:d,plural_name:d,description:"",supported_mime_types:["text/plain"]};for(var b in c.authors)d=c.authors[b],a._authors[d.name]=new AcreUser(a.get_store(),d);for(var g in c.files)b=c.files[g],b.has_been_saved=!0,new AcreDoc(a,b.name,b)}).enqueue()};AcreApp.prototype.t_flush_cache=function(a){var c=this.get_store().AppTouch(this.get_base_url());if(a)for(var a=this.get_hosts(),d=0;d<a.length;d++)this.get_store().AppTouch("http://"+a[d].host).enqueue();return c};AcreApp.prototype.destroy=
function(){for(var a in this._files)this._files[a].destroy();for(var c in this._authors)this._authors[c].destroy()};AcreApp.prototype.register_file=function(a){var c=RegExp(this._untitled_label+"(\\d+)").exec(a.get_name());c&&c.length&&(c=parseInt(c[1],10),this._untitled_counter<=c&&(this._untitled_counter=c+1));this._files[a.get_name()]=a};AcreApp.prototype.unregister_file=function(a){delete this._files[a]};AcreApp.prototype.is_dirty=function(){var a=this.get_files(),c;for(c in a)if(a[c].is_dirty())return!0;
return!1};AcreApp.prototype.get_store=function(){return this._store};AcreApp.prototype.get_repository_capability=function(a){return!!this._repository[a]};AcreApp.prototype.get_path=function(){return this.get_acre_host()===this.get_store().get_acre_host()?this._path:this._path+"."+this._acre_host+"."};AcreApp.prototype.get_versioned_path=function(){var a=this.get_path();this.is_version()&&(a=a.replace("//","//"+this._version+"."));return a};AcreApp.prototype.get_name=function(){return this._path.split("//")[1].split(".").shift()};
AcreApp.prototype.get_display_name=function(){return this._name};AcreApp.prototype.get_parent=function(){return this._parent};AcreApp.prototype.get_children=function(){return this._children};AcreApp.prototype.get_released_version=function(){return this._release};AcreApp.prototype.get_versions=function(){return this._versions};AcreApp.prototype.get_patches=function(){return this._patches};AcreApp.prototype.get_hosts=function(){return this._hosts};AcreApp.prototype.get_extension_metadata=function(a){a=
a.split(".");for(a.shift();a.length;){var c=a.join("."),d={};if(c&&this._extensions&&this._extensions[c]){d=this._extensions[c];break}a.shift()}return d||{}};AcreApp.prototype.get_acre_handlers=function(){return this._handlers};AcreApp.prototype.get_supported_mime_types=function(a){return this._handlers[a].supported_mime_types};AcreApp.prototype.get_files=function(){return this._files};AcreApp.prototype.get_file=function(a){if(a)return this._files[a];if(this._initial_file&&this._files[this._initial_file])return a=
this._files[this._initial_file],this._initial_file=null,a;if(this._files.index)return this._files.index;var c=this.get_files(),d;for(d in c)if(a=c[d])return a;return null};AcreApp.prototype.get_untitled_file_name=function(){return this._untitled_label+this._untitled_counter};AcreApp.prototype.get_acre_host=function(){return this._acre_host};AcreApp.prototype.get_base_url=function(){return this.get_versioned_path()+"."+this.get_acre_host()};AcreApp.prototype.get_view_url=function(){return this._repository.url+
"/apps"+this._appid};AcreApp.prototype.get_edit_url=function(){return this._repository.url+"/apps/admin"+this._appid};AcreApp.prototype.is_version=function(){return!!this._version};AcreApp.prototype.get_version_label=function(){return this._version};AcreApp.prototype.get_version_timestamp=function(a){for(var a=a?a:this._version,c=0;c<this._versions.length;c++){var d=this._versions[c];if(d.name==a)return d.as_of_time}return null};AcreApp.prototype.t_save_all=function(){var a=mjt.Succeed(),c;for(c in this._files){var d=
this._files[c];d.is_dirty()&&a.require(d.t_save())}return this.t_flush_cache().require(a).enqueue()};AcreApp.prototype.t_get_history=function(a){var c={appid:this.get_path()};a&&(c.limit=a);return this.get_store().XhrGet("get_app_history",c).enqueue()};AcreApp.prototype.get_last_change=function(){return this._last_edit};AcreApp.prototype.set_last_change=function(a){this._last_edit=a};AcreApp.prototype.t_set_listing=function(a,c,d){var b=this,g={appid:b.get_path()};a&&(g.name=a);a&&(g.description=
c);a&&(g.listed=d);return b.get_store().XhrPost("set_app_properties",g).onready(function(){if(a)b._display_name=a}).onerror(function(c,a,d){mjt.warn("Changing app listing of",b.get_name(),"failed: ",c," - ",a,d)}).enqueue()};AcreApp.prototype.t_move=function(a){var c=this,d={appid:c.get_path(),to_appid:a};return c.get_store().XhrPost("move_app",d).onready(function(){c._path=a;c.t_flush_cache().enqueue()}).onerror(function(b,a,d){mjt.warn("Move of",c.get_display_name(),"failed: ",b," - ",a,d)}).enqueue()};
AcreApp.prototype.t_delete=function(){var a=this,c={appid:a.get_path()};return this.get_store().XhrPost("delete_app",c).enqueue().onready(function(){a.destroy()}).onerror(function(c,b,a){mjt.warn("Failed to delete app: "+c+", "+b+", "+a)})};AcreApp.prototype.t_set_host=function(a){var c=this,a={appid:c.get_path(),host:a};return c.get_store().XhrPost("set_app_host",a).onready(function(a){c._hosts=a.hosts;a.listed&&(c._listed=!0);c.t_flush_cache(!0).enqueue()}).onerror(function(a,b,g){mjt.warn("Setting release URL of",
c.get_display_name(),"failed: ",a," - ",b,g)}).enqueue()};AcreApp.prototype.t_set_release=function(a){var c=this,a={appid:c.get_path(),version:a};return c.get_store().XhrPost("set_app_release",a).onready(function(a){c._hosts=a.hosts;c._versions=a.versions;c._release=a.release;c.t_flush_cache(!0).enqueue()}).onerror(function(a,b,g){mjt.warn("Setting release of",c.get_display_name(),"failed: ",a," - ",b,g)}).enqueue()};AcreApp.prototype.t_add_version=function(a,c,d){var b=this,a={appid:b.get_path(),
version:a};c&&(a.timestamp=c);"undefined"!==typeof d&&(a.service_url=d);return this.get_store().XhrPost("create_app_version",a).onready(function(c){b._versions=c.versions}).onerror(function(b,c,a){mjt.warn("Failed to add version: "+b+", "+c+", "+a)}).enqueue()};AcreApp.prototype.t_remove_version=function(a){var c=this,a={appid:c.get_path(),version:a};return this.get_store().XhrPost("delete_app_version",a).onready(function(a){c._versions=a.versions}).onerror(function(c,b,a){mjt.warn("Failed to remove version: "+
c+", "+b+", "+a)}).enqueue()};AcreApp.prototype.is_remote=function(){return this._remote_app};AcreApp.prototype.is_writable=function(){return this.is_author()&&!this.is_version()&&!this.is_remote()};AcreApp.prototype.is_author=function(){return this.get_store().get_user()?this.get_store().get_user().get_name()in this.get_authors():!1};AcreApp.prototype.get_authors=function(){return this._authors};AcreApp.prototype.get_write_user=function(){return this._authors[this._write_user]};AcreApp.prototype.t_add_author=
function(a){var c=this,d={appid:c.get_path(),username:a};return this.get_store().XhrPost("add_app_author",d).onready(function(b){b=new AcreUser(c._store,b.authors[a]);c._authors[a]=b}).onerror(function(b,c,a){mjt.warn("Failed to add author: "+b+", "+c+", "+a)}).enqueue()};AcreApp.prototype.t_remove_author=function(a){var c=this,d={appid:c.get_path(),username:a};return this.get_store().XhrPost("remove_app_author",d).onready(function(){delete c._authors[a]}).onerror(function(b,c,a){mjt.warn("Failed to add author: "+
b+", "+c+", "+a)}).enqueue()};AcreApp.prototype.t_get_apikeys=function(){var a={appid:this.get_path()};return this.get_store().XhrPost("list_app_apikeys",a).onerror(function(c,a,b){mjt.warn("Failed to get API Keys: "+c+", "+a+", "+b)}).enqueue()};AcreApp.prototype.t_add_apikey=function(a,c,d){a={appid:this.get_path(),name:a,token:c,secret:d};return this.get_store().XhrPost("create_app_apikey",a).onerror(function(b,c,a){mjt.warn("Failed to add api key: "+b+", "+c+", "+a)}).enqueue()};AcreApp.prototype.t_remove_apikey=
function(a){a={appid:this.get_path(),name:a};return this.get_store().XhrPost("delete_app_apikey",a).onerror(function(c,a,b){mjt.warn("Failed to add api key: "+c+", "+a+", "+b)}).enqueue()};AcreApp.prototype.t_set_writeuser=function(a){var c=this;if(!!c.get_write_user()===a)return mjt.Succeed().enqueue();if(!(!0===a||!1===a))return mjt.Fail(500,"Must set write_user to true or false (current user)").enqueue();var d={appid:c.get_path(),enable:a};return c.get_store().XhrPost("set_app_writeuser",d).onready(function(b){c._write_user=
a?b.write_user:null}).onerror(function(b,a,d){mjt.warn("Setting write user for ",c.get_name(),"failed: ",b," - ",a,d)}).enqueue()}})();var AcreUser;
(function(){AcreUser=function(a,c){this._store=a;this._name=c.name||null;this._full_name=c.full_name||null;this._is_admin=c.admin;return this};AcreUser.prototype.destroy=function(){};AcreUser.prototype.get_name=function(){return this._name};AcreUser.prototype.get_full_name=function(){return this._full_name};AcreUser.prototype.is_admin=function(){return!!this._is_admin};AcreUser.prototype.get_image_url=function(){return this._store.get_user_image_url(this)};AcreUser.prototype.get_view_url=function(){return this._store.get_user_view_url(this)};
AcreUser.prototype.get_new_app_host=function(){return this._store.get_user_default_app_host(this)};AcreUser.prototype.get_new_app_path=function(a){return this._store.get_user_new_app_path(this,a)}})();var EDITORS={},ImageEditor;
(function(){ImageEditor=function(a){this.supports_mime_type_change=!1;this.ui_element=document.createElement("div");a.cssClassName&&(this.ui_element.className=a.cssClassName);this.file=a.file;this.readOnly=a.readOnly;a.onChange&&(this.on_change=a.onChange)};ImageEditor.t_load=function(a,c){var d=EDITORS.ImageEditor.config;d.readOnly=!a.is_writable();d.onChange=function(b,c){a.trigger_editor_event("change",[b,c])};d=new ImageEditor(d);d.file=a;$(a.get_element()).append(d.ui_element);c&&d.set_state(c);
return mjt.Succeed(d)};ImageEditor.prototype.destroy=function(){$(this.ui_element).remove()};ImageEditor.prototype.show=function(a){this._prefs=a;$(this.ui_element).empty();this.file.set_dirty("content",!1);this.file.has_been_saved();$(this.ui_element).append('<p class="image-upload">Uploading of new images is not currently supported.</p>');var a=this.file.get_name(),c=this.file.get_app().get_base_url();this.file.has_been_saved()&&("image/"===this.file.get_mime_type().substr(0,6)?$('<div class="image-preview"><p>'+
a+':</p><img src="'+this.file.get_acre_url()+'"/></div>').appendTo(this.ui_element):this.file.get_revision()&&$('<a href="'+c+"/"+a+'">download file</a>').appendTo(this.ui_element));$(this.ui_element).append('<div class="image-attribution"><img src="'+fb.h.reentrant_url("/static","img/freebase-cc-by-61x23.png")+' alt="Freebase CC-BY" width="61" height="23" /><p>All images included in Acre apps are released under <a href="http://creativecommons.org/licenses/by/3.0/">CC-BY</a>.</p></div>');$(this.ui_element).show()};
ImageEditor.prototype.refresh=ImageEditor.prototype.show;ImageEditor.prototype.hide=function(){$(this.ui_element).hide()};ImageEditor.prototype.get_state=function(){return{form:this.form_element}};ImageEditor.prototype.set_state=function(a){a.revision&&(this.file.set_revision(a.revision),this.file.set_dirty("content"));this.show()}})();EDITORS.ImageEditor={editor_class:ImageEditor,supports:{},config:{cssClassName:"Editor-view"}};
function EditorMargin(a){this._container=a;this._container.innerHTML="<div style='position: relative; left: 0; top: 0; width: 100%; height: 100%'></div>";for(var a=[],c=0;100>c;c++)a.push("<div>0</div>");this._lineMetricDiv=this._createLayer();this._lineMetricDiv.style.visibility="hidden";this._lineMetricDiv.innerHTML=a.join("");this._fontMetricDiv=this._createLayer();this._fontMetricDiv.style.visibility="hidden";this._fontMetricDiv.style.height="100em";this._lineNumberDiv=this._createLayer();this._lineNumberDiv.className=
"editor-margin-line-numbers";this._renderedLineCount=this._firstRenderedLine=0;this._currentLine=-1}
(function(){EditorMargin.get_layout_metrics=function(a,c){var d;if(a.getComputedStyle)return d=a.getComputedStyle(c,null),{paddingTop:d.getPropertyValue("padding-top"),marginTop:d.getPropertyValue("margin-top")};d=c.currentStyle;return{paddingTop:d.paddingTop,marginTop:d.marginTop}};EditorMargin.prototype={dispose:function(){},redraw:function(a,c){var d=this._lineMetricDiv.offsetHeight/100,b=this._fontMetricDiv.offsetHeight/100,g=d/b,i=null;null!==c.contentHeight&&(i=Math.floor(c.contentHeight/d));
var e=Math.floor(c.scrollY/d),d=Math.ceil((c.scrollY+c.visibleHeight)/d)-1;null!==i&&(d=Math.min(d,i-1));var m=this._firstRenderedLine+this._renderedLineCount;if(e<this._firstRenderedLine||e>=m||d>=m||null!==i&&i<d){m=d-e+1;e=Math.max(0,e-m);d+=m;null!==i&&(d=Math.min(d,i-1));this._lineNumberDiv.style.paddingTop=g*e+"em";g=[];for(i=e;i<=d;i++)g.push("<div>"+(i+1)+"</div>");this._lineNumberDiv.innerHTML=g.join("");this._firstRenderedLine=e;this._renderedLineCount=d-e+1;this._highlightCurrentLine()}g=
function(c){try{if(0<c.indexOf("px"))return parseInt(c.replace(/px$/g,""),10);if(0<c.indexOf("em"))return Math.round(parseFloat(c.replace(/em$/g,""),10)*b)}catch(a){}return 0};this._lineNumberDiv.style.top=-c.scrollY+g(a.paddingTop)+g(a.marginTop)+"px"},_createLayer:function(){var a=document.createElement("div");a.style.position="absolute";this._container.firstChild.appendChild(a);return a},setCurrentLine:function(a){a!==this._currentLine&&(this._unhighlightCurrentLine(),this._currentLine=a,this._highlightCurrentLine())},
_unhighlightCurrentLine:function(){if(-1!==this._currentLine){var a=this._lineNumberDiv.childNodes,c=this._currentLine-this._firstRenderedLine;0<=c&&c<a.length&&(a[c].className="")}},_highlightCurrentLine:function(){if(-1!==this._currentLine){var a=this._lineNumberDiv.childNodes,c=this._currentLine-this._firstRenderedLine;0<=c&&c<a.length&&(a[c].className="edit-margin-current-line-number")}}}})();var TextareaEditor;
(function(){TextareaEditor=function(a){var c=this;c._edit_element=document.createElement("textarea");a.cssClassName&&(c._edit_element.className=a.cssClassName);a.readOnly&&($(c._edit_element).attr("readonly","yes").addClass("readonly"),$(c._top_element).append("<div class='readonly-warning'>READ ONLY</div></div>"));if(a.on_change){c.timeout_id=null;var d=function(){c.timeout_id&&window.clearTimeout(c.timeout_id);c.timeout_id=window.setTimeout(a.on_change,300)},b=["input","drop"];$.browser.mozilla||
b.push("paste","keypress");for(var g=0;g<b.length;g++)$(c._edit_element).bind(b[g],d)}};TextareaEditor.t_load=function(a,c){var d=EDITORS.TextareaEditor.config;d.readOnly=!a.is_writable();d.on_change=function(){a.trigger_editor_event("change",[])};var b=new TextareaEditor(d);b._top_element=document.createElement("div");$(b._top_element).css({height:"100%",width:"100%"});$(a.get_element()).append(b._top_element);$(b._top_element).append(b._edit_element);b._margin_width=d.marginWidth;b._margin_element=
document.createElement("div");b._margin_element.className="edit-margin";$(b._top_element).append(b._margin_element);d=mjt.Succeed(b);if(c)b.set_state(c);else if(a.has_been_saved()){var g=a.t_get_revision().onready(function(c){b.set_state({text:c.text})});d.require(g)}return d};TextareaEditor.prototype.destroy=function(){$(this._top_element).remove()};TextareaEditor.prototype.show=function(a){var c=this;c._prefs=a;a.margin&&(c.editorMargin||(c.editorMargin=new EditorMargin(c._margin_element,{})),c._scroll_callback=
function(){c._redraw_editor_margin()},$.browser.msie?c._edit_element.onscroll=c._scroll_callback:$(c._edit_element).bind("scroll",c._scroll_callback));c._resize_callback=function(){c._on_resize()};$(window).bind("resize",c._resize_callback);c._on_resize();$(c._top_element).show()};TextareaEditor.prototype.hide=function(){$(this._top_element).hide();$(this._edit_element).unbind("scroll",this._scroll_callback);$(window).unbind("resize",this._resize_callback)};TextareaEditor.prototype.get_state=function(){return{text:this._edit_element.value}};
TextareaEditor.prototype.set_state=function(a){this._edit_element.value=a.text};TextareaEditor.prototype._on_resize=function(){this._prefs.margin?($(this._edit_element).css("left",this._margin_width),$(this._edit_element).width($(this._top_element).width()-this._margin_width),$(this._margin_element).width(this._margin_width),$(this._margin_element).show(),this._redraw_editor_margin()):($(this._edit_element).css("left",0).width($(this._top_element).width()),$(this._margin_element).hide())};TextareaEditor.prototype._redraw_editor_margin=
function(){if(this._prefs.margin)try{var a=this._get_scroll_info(),c=this._get_layout_metrics();this.editorMargin.redraw(c,a)}catch(d){}};TextareaEditor.prototype._get_scroll_info=function(){return{scrollY:$(this._edit_element).scrollTop(),visibleHeight:$(this._edit_element).innerHeight(),contentHeight:null}};TextareaEditor.prototype._get_layout_metrics=function(){return EditorMargin.get_layout_metrics(window,this._edit_element)}})();
EDITORS.TextareaEditor={name:"TextArea",editor_class:TextareaEditor,supports:{hotswap:!0,mimetype_change:!0,margin:!0},config:{cssClassName:"Editor-view",marginWidth:45}};
var QueryEditor=function(a,c,d){var b;a.innerHTML='<div style="position: relative"><div style="position: absolute;"></div><div style="position: absolute;"></div></div>';var g=a.firstChild.childNodes[0],i=a.firstChild.childNodes[1];$(g).css("top","10px");$(g).css("left","10px");$(i).css("right","10px").css("top","10px");var e=this,m=function(){var c=Math.max(100,a.offsetWidth),c=Math.round((c-20-10)/2)+"px",d=Math.max(100,a.offsetHeight);a.firstChild.style.width="100%";a.firstChild.style.height=d+
"px";d-=20;b.queryEditor.layout(d,c);b.outputPane.layout(d,c)};c.focusOnReady=!0;c.onReady=function(){d.ready(e)};this.composition=b=CueCard.createComposition({queryEditorElement:g,queryEditorOptions:c,outputPaneElement:i,outputPaneOptions:{verticalPadding:2,horizontalPadding:2,hideHelp:!0}});b.queryEditor._onRun=function(){this.run(!0)};this.get_state=function(){return{text:b.queryEditor.content()}};this.set_state=function(c){b.queryEditor.content(c.text)};this.destroy=function(){$(a).hide();$(a).remove()};
this.show=function(c){var d=this;d._prefs=c;c.emql&&(this.composition.queryEditor._getQueryEnvelope=function(){return{extended:1}});var e=b.queryEditor._editor;setTimeout(function(){e.setLineNumbers(c.margin);e.setTextWrapping(c.softwrap);d._file.trigger_editor_event("linechange",[e.currentLine()]);if(e._last_selection){var b=e._last_selection.start,a=e._last_selection.end;e.selectLines(b.line,b.character,a.line,a.character);delete e._last_selection}},1);$(window).bind("resize",m);$(".cuecard-queryEditor-controls-bottom").acre(fb.acre.apps.appeditor+
"/mjt/templates.mjt","query_button_bar");$(d._file.get_element()).show();$(a).show();m()};this.hide=function(){$(a).hide();$(window).unbind("resize",m)};this.undo=function(){b.queryEditor._editor.editor.history.undo()};this.redo=function(){b.queryEditor._editor.editor.history.redo()};this.reindentSelection=function(){b.queryEditor._editor.editor.reindentSelection()};this.query_assist=function(){b.queryEditor.startAssistAtCursor()};this.query_run=function(){b.queryEditor.run(this._file.is_writable())};
this.query_redangle=function(){var c=b.queryEditor,a=c.getQueryModelAndContext();a.model.toInsideOutQueryJson(a.context,CueCard.UI.createBlockingContinuations(function(b,a){c.content(CueCard.jsonize(a,c.getJsonizingSettings()))}))};this.generate_template=function(){var c=this,a=ui.get_app().get_untitled_file_name(),d=b.queryEditor.getQueryModelAndContext().model.toQueryJson();CueCard.CodeGeneration.serializers["acre-template"].generateQueryCall=function(b,a,d,l,e,g,m){a.appendIndent();a.append("<acre:script>");
a.appendLineBreak();a.indent();a.appendIndent();a.append("var "+g+' = acre.require("'+c._file.get_name()+'").query');a.append(";");a.appendLineBreak();c._prefs.emql?(a.appendIndent(),a.append("var "+m+" = acre.freebase.mqlread("+g+", {extended:1});")):(a.appendIndent(),a.append("var "+m+" = acre.freebase.mqlread("+g+");"));a.appendLineBreak();a.unindent();a.appendIndent();a.append("</acre:script>");a.appendLineBreak();return m+".result"};d=CueCard.CodeGeneration.generate(d,CueCard.CodeGeneration.serializers["acre-template"],
{indentLevel:1});ui.do_file_create_new(a,{handler:"mjt"},{text:'<html>\r<head>\r\r  <title>Query-Generated Template</title>\r\r  <style type="text/css" media="screen">\r    * { vertical-align: baseline; font-weight: inherit; font-family: inherit; \r        font-style: inherit; font-size: inherit; border: 0 none; outline: 0; padding: 0; margin: 0; }\r    body { margin: 15px; }\r    ul { list-style: none; }\r    li { padding: 3px; }\r    table { border-collapse: collapse; border-spacing: 0; width: 100%; }\r    th, td { border: 1px solid #ddd; vertical-align: top; padding: 6px; }\r    th { width: 20%; text-align: right; font-size: 11px; font-weight: bold; padding: 6px; color: #666; background: #f5f5f5; }\r    td { width: 80%; font-size: 12px; }\r    img { padding: 1px; border: 1px solid #ccc;}\r    ins { color: #aaa; text-decoration: none;}\r  </style>\r\r</head>\r\r<body>\r'+
d+'  \r  <\!-- Freebase attribution template --\>\r  ${acre.require("/freebase/apps/attribution/templates").blanket()}\r</body>\r</html>\r'})};CodeMirror.prototype.highlight_line=function(){var b=this._file,c=this.currentLine(),a=$(this.lineNumbers);a.find(".Codemirror-current-line").removeClass("Codemirror-current-line");a.find("div").eq(c).addClass("Codemirror-current-line");b.trigger_editor_event("linechange",[c])};this.goto_line=function(c){var a=b.queryEditor._editor.editor;try{a.jumpToLine(c)}catch(d){a.selectLines(a.prevLine(a.lastLine()),
0)}}};
(function(){var a=mjt.define_task(null,[{name:"parent"},{name:"editor_config"}]);a.prototype._task_class="CreateQueryEditor";a.prototype.request=function(){return new QueryEditor(this.parent,this.editor_config,this)};QueryEditor.t_load=function(c,d){CueCard.helper=fb.acre.freebase.site_host+"/cuecard/";CueCard.freebaseServiceUrl=fb.acre.freebase.service_url+"/";CueCard.urlPrefix=CueCard.apiProxy.base=fb.acre.appeditor.cuecard_api;var b=$.extend(!0,{},EDITORS.QueryEditor.config);b.readOnly=!c.is_writable();var g=
document.createElement("div");$(g).css({height:"100%",width:"100%"});$(c.get_element()).hide().append(g);b.codeMirror.onChange=function(){try{var b=c._loaded_editors.QueryEditor.composition.queryEditor._editor.historySize();c.trigger_editor_event("change",[b.undo,b.redo])}catch(a){}};b.codeMirror.cursorActivity=function(){c._loaded_editors.QueryEditor.composition.queryEditor._editor.highlight_line()};var i,e=a(g,b).onready(function(a){a.composition.queryEditor._editor.setParser("JSParser");d?a.set_state(d):
i&&a.set_state({text:i.result.text});a._file=a.composition.queryEditor._editor._file=c;a._top_element=g;$(">div",g).css("height","100%");b.readOnly&&($(c.get_element()).addClass("readonly"),$(".cuecard-queryEditor",c.get_element()).append("<div class='readonly-warning'>READ ONLY</div>"));c.trigger_editor_event("newframe",[a.composition.queryEditor._editor.frame])});!d&&c.has_been_saved()&&(i=c.t_get_revision(),e.require(i));return e}})();
EDITORS.QueryEditor={editor_class:QueryEditor,supports:{margin:!0,linenumbers:!0,softwrap:!0,undo:!0,indent:!0,inline_preview:!0,emql:!0},config:{codeMirror:{lineNumbers:!1,parserfile:[fb.acre.libs.codemirror],stylesheet:[fb.acre.libs.codemirror_css]}}};
(function(){function a(b){var c="DummyParser",a={mqlquery:"JSParser",acre_script:"JSParser",mjt:"HTMLMixedParser",freebase_template:"HTMLMixedParser",coffee_script:"JSParser",controller:"JSParser",ajax:"JSParser"},d={"text/html":"HTMLMixedParser","text/css":"CSSParser","text/javascript":"JSParser","application/json":"JSParser"},m=b.get_acre_handler(),b=b.get_mime_type();"text/plain"!==b?b in d&&(c=d[b]):m in a&&(c=a[m]);return c}var c=mjt.define_task(null,[{name:"parent"},{name:"editor_config"}]);
c.prototype._task_class="CreateCodeMirror";c.prototype.request=function(){var b=this,c=new CodeMirror(this.parent,this.editor_config);this.editor_config.initCallback=function(){b.ready(c)};c.get_state=function(){return{text:this.editor.getCode()}};c.set_state=function(b){this.editor.importCode(b.text)}};CodeMirror.t_load=function(b,d){var i=$.extend(!0,{},EDITORS.CodeMirror.config);i.readOnly=!b.is_writable();i.readOnly&&$(b.get_element()).addClass("readonly").append("<div class='readonly-warning'>READ ONLY</div>");
i.onChange=function(){if(b._loaded_editors.CodeMirror){var c=b._loaded_editors.CodeMirror.historySize();b.trigger_editor_event("change",[c.undo,c.redo])}};var e=document.createElement("div");$(e).css({height:"100%",width:"100%"});$(b.get_element()).append(e);var m,j=c(e,i).onready(function(c){c.setParser(a(b));d?c.set_state(d):m&&c.set_state({text:m.result.text});c._file=b;c._top_element=e;b.trigger_editor_event("newframe",[c.frame]);i.cursorActivity=function(){c.highlight_line()}});!d&&b.has_been_saved()&&
(m=b.t_get_revision(),j.require(m));return j};CodeMirror.prototype.destroy=function(){"_codeAssist"in this&&(this._codeAssist.dispose(),this._codeAssist=null);$(this._top_element).remove()};CodeMirror.prototype.show=function(b){var c=this,a=c._file;c._prefs=b;setTimeout(function(){c.setLineNumbers(b.margin);c.setTextWrapping(b.softwrap);c.highlight_line();$(c._top_element).show();$("iframe",c._top_element).focus();if(c._last_selection){var d=c._last_selection.start,m=c._last_selection.end;c.selectLines(d.line,
d.character,m.line,m.character);delete c._last_selection}b.dotTrigger&&a.is_writable()&&fb.get_script(fb.acre.libs.codeassist,function(){c._codeAssist||(c._codeAssist=new CodeAssist(c.frame,c,{isMjt:"mjt"==a.get_acre_handler()}));c._codeAssist.putSetting("dotTrigger",b.dotTrigger)})},1)};CodeMirror.prototype.hide=function(){var b=this.cursorPosition(),c=this.cursorPosition(!1);this._last_selection={start:b,end:c};$(this._top_element).hide()};CodeMirror.prototype.highlight_line=function(){var b=this._file,
c=this.currentLine(),a=$(this.lineNumbers);a.find(".Codemirror-current-line").removeClass("Codemirror-current-line");a.find("div").eq(c).addClass("Codemirror-current-line");b.trigger_editor_event("linechange",[c])};CodeMirror.prototype.goto_line=function(b){try{this.jumpToLine(b)}catch(c){this.selectLines(this.prevLine(this.lastLine()),0)}};var d={"acre:doc":"xml-tagname-acre","acre:block":"xml-tagname-acre","acre:script":"xml-tagname-acre"};CodeMirror.style_token=function(b,c){var a=c.content.toLowerCase();
"xml-tagname"==c.style&&d[a]&&(b.className+=" "+d[a])}})();
EDITORS.CodeMirror={name:"CodeMirror",editor_class:CodeMirror,supports:{hotswap:!0,mimetype_change:!0,margin:!0,linenumbers:!0,softwrap:!0,undo:!0,indent:!0,codeassist:!0},config:{parserConfig:{triggers:{"acre:script":"JSParser",script:"JSParser",style:"CSSParser"}},activeTokens:CodeMirror.style_token,height:"100%",marginWidth:45,autoMatchParens:!0,passDelay:100,undoDelay:250,basefiles:[],parserfile:[fb.acre.libs.codemirror],stylesheet:[fb.acre.libs.codemirror_css],lineNumbers:!0,highlightActiveLine:!0,
tabMode:"shift",dotTrigger:!1}};var ui={};
(function(){function a(b){b=b.replace(/<\?xml[^>]+>/g,"");b=b.replace(/<style[^>]+>/g,"<style>");return b=b.replace(/type=['"]text\/(css|javascript)['"]/g,"")}function c(b){return b.replace(/acre:/g,"")}function d(b){b=b.replace(/<acre:script>/g,"<script>").replace(/<\/acre:script>/g,"<\/script>");b=b.replace(/<\/?acre:(block|doc)[^>]*>/g,"");b=b.replace(/<[^>]+>/g,c);return b=a(b)}function b(b){/^\s*@charset\s+"UTF-8";/.test(b)||(b='@charset "UTF-8"; '+b);return b}ui.init=function(){$("#body").acre(fb.acre.apps.appeditor+
"/mjt/templates.mjt","body");$("#button-apps").click(function(){ui.do_show_menu("apps")}).attr("title",ui.shortcut.get_keys("Open App"));ui.shortcut.register_keys(document);window.onbeforeunload=ui.warn_user_about_unsaved_files;$(document).keydown(function(b){return!(8===b.which&&"INPUT"!==b.target.nodeName&&"TEXTAREA"!==b.target.nodeName)});$(".exit").live("click",ui.do_hide_overlays);$(".app-link").live("click",function(b){if(!b.ctrlKey&&!b.metaKey&&!b.altKey&&!b.shiftKey)return b=$(this).attr("apppath"),
ui.do_hide_overlays(),ui.get_app()&&ui.get_app().is_dirty()?ui.do_show_dialog("files_dirty",[b]):ui.do_choose_app(b),!1});ui.check_browser_hash();setInterval(ui.check_browser_hash,250)};ui.refresh_app_templates=function(b){var c=ui.get_app();$("#header-apptitle").acre(fb.acre.apps.appeditor+"/mjt/templates.mjt","header",[b]);c&&($("#list-column").acre(fb.acre.apps.appeditor+"/mjt/templates.mjt","list_column"),c.is_writable()?$("#about-bar").hide():$("#about-bar").acre(fb.acre.apps.appeditor+"/mjt/templates.mjt",
"about_bar").show())};ui.refresh_file_templates=function(){$("#file-list").acre(fb.acre.apps.appeditor+"/mjt/templates.mjt","file_list");$("#button-bar").acre(fb.acre.apps.appeditor+"/mjt/templates.mjt","button_bar");ui.finish_drawing()};ui.finish_drawing=function(){$(".refresh").show();ui.set_state();$(window).trigger("resize")};ui.do_show_dialog=function(b,c){function a(b){27==b.keyCode&&(ui.do_hide_dialog_overlays(),$(document).unbind("keydown",a))}ui.do_hide_overlays();"welcome"==b?ui.dialog=
$("<div id='"+b+"'></div>").acre(fb.acre.apps.appeditor+"/mjt/dialogs.mjt",b,c).prependTo(document.body):($("<div id='dialog-overlay'></div>").prependTo(document.body),$(document).bind("keydown",a),ui.dialog=$("<div id='dialog-"+b+"' class='dialog'></div>").acre(fb.acre.apps.appeditor+"/mjt/dialogs.mjt",b,c).prepend("<div class='dialog-close' onclick='ui.do_hide_overlays()'></div>").prependTo(document.body));ui.dialog.show();ui.dialog.css("left",($(window).width()-ui.dialog.outerWidth())/2);return!1};
ui.do_show_menu=function(b,c){function a(){ui.do_hide_menu_overlays();$(document).unbind("keydown",f)}function f(b){27==b.keyCode&&a()}$("<div id='menu-overlay'></div>").prependTo(document.body).click(a);$(document).bind("keydown",f);$("#button-"+b).addClass("button-open");var h=$("#button-"+b).offset(),d=$("#button-"+b).height();$("<div id='menu-"+b+"' class='menu'></div>").css({top:h.top+d+10,left:h.left}).prependTo(document.body).acre(fb.acre.apps.appeditor+"/mjt/menus.mjt",b,c);return!1};ui.do_setup_submenu=
function(b,c,a){var f,h,d=!1,j=$("#"+b),l=j.closest(".menu"),n=$("<div id='menu-"+c+"' class='menu submenu'></div>");j.mouseenter(function(){f=setTimeout(function(){d?n.css("visibility","visible"):(n.css({top:j.offset().top,left:l.offset().left+l.width()}).prependTo(document.body).acre(fb.acre.apps.appeditor+"/mjt/menus.mjt",c,a).mouseenter(function(){clearTimeout(h)}).mouseleave(function(){clearTimeout(f);h=setTimeout(function(){n.css("visibility","hidden")},100)}),d=!0)},250)}).mouseleave(function(){clearTimeout(f);
h=setTimeout(function(){n.css("visibility","hidden")},100)})};ui.do_hide_dialog_overlays=function(){delete ui.dialog;$("#dialog-overlay, .dialog").remove();$(".fbs-pane, .fbs-flyout-pane").hide()};ui.do_hide_menu_overlays=function(){$("#menu-overlay, .menu").remove();$(".button-open").removeClass("button-open");$(".fbs-pane, .fbs-flyout-pane").hide()};ui.do_hide_overlays=function(){ui.do_hide_dialog_overlays();ui.do_hide_menu_overlays()};ui.do_hide_welcome=function(){$("#welcome").remove()};var g=
!0,i,e,m,j,l,q=!1,h=!1,f;ui.check_browser_hash=function(){if(!h){var b=ui._get_browser_hash();if("0"==b)ui.set_state();else if(g||ui._ui_state_to_browser_hash()!==b){g=!1;var b=mjt.app.decode_uristate(b),c=/[\<\>]/,a=b.path||b.app,a=!c.test(a)?a:null,c=!c.test(b.file)?b.file:null;ui.do_choose_app(a,c,b.line,b.create)}}};ui._get_browser_hash=function(){return window.location.hash.replace(/#!?/,"")};ui._ui_state_to_browser_hash=function(){if("undefined"==typeof ui.get_app())return null;var b={};ui.get_app()&&
(b.path=ui.get_app().get_versioned_path());ui.get_file()&&(b.path+="/"+ui.get_file().get_relative_path());return mjt.app.encode_uristate(b)};ui.set_state=function(){var b=ui.get_app(),c=ui.get_file();q=c?c.is_dirty():null;var a="";b&&(a+=(b.get_display_name()||b.get_path())+" - ");c&&(a+=c.get_name()+" - ");document.title=a+"Freebase App Editor";b=ui._ui_state_to_browser_hash();b!==ui._get_browser_hash()&&(window.location.hash="!"+b);h=!1};ui.clear_state=function(){q=l=j=m=null};ui.get_store=function(){return i};
ui.set_store=function(b){i=b};ui.set_user=function(b){var c=ui.get_store();b!==c.get_user()&&c.set_user(b);e=c.get_user()};ui.get_app=function(){return!m?null:m};ui.get_file=function(){return!j?null:j};ui.get_line=function(){return l};ui.get_user=function(){return e};ui.get_recents=function(b,c){var a=$.localstore("recent_"+b,void 0,!1);null===a&&(a=[]);!c&&(a&&0<a.length)&&a.shift();return a};ui.add_recent=function(b,c,a){var f=$.localstore("recent_"+b,void 0,!1);if(!f||!jQuery.isArray(f))f=[];for(var h=
JSON.stringify(c),d=0;d<f.length;d++)(JSON.stringify(f[d])==h||"apps"==b&&(c&&(f[d].path==c.path||ui.id_to_path(f[d].path)==c.path)||f[d].path==a))&&f.splice(d,1);if(c&&(f.unshift(c),f&&16<f.length&&(c=f.splice(16),"apps"==b)))for(a=0;a<c.length;a++)ui.clear_recents(c[a]);$.localstore("recent_"+b,f,!1)};ui.clear_recents=function(b){$.localstore("recent_"+b,null,!1)};ui.do_choose_app=function(b,c,a,f){function d(){ui.clear_state();ui.set_state();ui.refresh_app_templates("open");var b=ui.get_recents("apps",
!0);if("app"==f)ui.get_user()||(location.href=ui.get_store().get_user_account_url("signin")+"create=app"),ui.do_show_dialog("new_app");else if(0<b.length){var c=b.shift();$.localstore("recent_apps",b,!1);ui.do_choose_app(c.path)}else ui.get_user()?ui.do_show_dialog("welcome",[!0]):ui.do_show_dialog("welcome")}function l(){"file"==f?(ui.set_state(),ui.do_show_dialog("add_file")):ui.do_choose_file(c,a)}h=!0;var n=ui.get_app(),e=n?n.get_versioned_path():null;if(b&&n&&b==e)ui.refresh_app_templates(),
l();else if(ui.do_hide_overlays(),ui.do_hide_welcome(),$(".refresh").hide(),b){n&&n.destroy();ui.refresh_app_templates("loading");var C=new AcreApp(ui.get_store(),b);C.t_load().onready(function(){m=C;ui.add_recent("apps",{path:C.get_path(),name:C.get_display_name()});j=null;ui.refresh_app_templates();l();ui.do_status_check()}).onerror(function(c,a,f){"/api/status/error/input/no_app"==c?(ui.MessagePanel.error(a?a:"Error loading app: "+b+". "+a||""),ui.add_recent("apps",null,b),d()):(assert.critical(!1,
"Error connecting to Freebase<br/>"+a),mjt.error(c,a,f),ui.clear_state(),ui.set_state(),ui.refresh_app_templates("open"))})}else d()};ui.do_choose_file=function(b,c){function a(){var b=ui.get_file();if(!b)return ui.refresh_file_templates();var f=ui._get_desired_editor_classname();return b.t_editor_show(f,ui.get_editor_prefs()).onready(function(){c&&setTimeout(function(){b.editor_goto_line(c)},0);ui.refresh_file_templates();ui.set_state()})}h=!0;var f=ui.get_app(),d=ui.get_file(),l=f.get_file(b);l||
(l=f.get_file());if(!l||l==d)a(c);else return j=l,q=l.is_dirty(),0===$("#file-area").has(l.get_element()).length&&($("#file-area").append(l.get_element()),ui._register_editor_event_handlers(l)),d&&d.hide(),$(l.get_element()).show(),a(c)};ui.do_refresh_file=function(){var b=ui.get_file();if(b){b.set_dirty("editor");var c=ui._get_desired_editor_classname();b.t_editor_show(c,ui.get_editor_prefs()).onready(function(){ui.refresh_file_templates();setTimeout(function(){b.editor_goto_line(ui.get_line())},
0)})}};ui.do_run_view=function(b,c){var a=ui.get_file();if("mqlquery"==a.get_acre_handler())a._current_editor.query_run();else{var f="http:"+ui.get_file().get_acre_url(c),h=window.open("about:blank",ui.get_app().get_path().replace(/[\/-]/g,"_"));if(!h)return ui.MessagePanel.error("A window couldn't be opened.  Tell your web browser to allow this site to open pop up windows and try again to continue."),!1;ui.do_app_save_all(function(){h.location=f;h.focus()})}};ui.do_acre_home_link=function(){location.href=
ui.get_store().get_freebase_url()+"/apps";return!1};ui.do_status_check=function(){var b=+new Date;f&&6E4>b-f||(f=b,b={},ui.get_app()&&(b.appid=ui.get_app().get_path()),ui.get_store().XhrGet("get_app_status",b).enqueue().onready(function(b){ui.get_app().set_last_change(b.change);if(!!b.user!==!!ui.get_user()){ui.set_user(b.user);if(!b.user){ui.MessagePanel.error("You are no longer signed in.  Sign back in in another window to not lose any changes.");$(window).trigger("fb.user.signedout")}$(window).trigger("fb.user.signedin")}$("#app-edits-shim").acre(fb.acre.apps.appeditor+
"/mjt/templates.mjt","app_edits");ui.refresh_file_templates()}))};ui.do_app_create_new=function(b,c,a){var f={appid:b};c&&(f.name=c);a&&(f.clone=a);ui.get_store().get_user_apps(b)?ui.MessagePanel.error("App with that URL already exists"):(ui.MessagePanel.doing("Creating: "+c+"..."),ui.get_store().XhrPost("create_app",f).enqueue().onready(function(a){ui.MessagePanel.info("Created: "+c);ui.do_choose_app(b);ui.get_store().set_user_apps(a)}).onerror(function(c,a){ui.MessagePanel.error(a?a:"Error creating: "+
b+". "+a||"")}))};ui.do_app_move=function(b){var c=ui.get_app(),a=c.get_path();h=!0;ui.MessagePanel.doing("Moving app...");c.t_move(b).onready(function(){ui.set_state();ui.add_recent("apps",{path:c.get_path(),name:c.get_display_name()},a);ui.get_store().t_refresh_user_apps();ui.MessagePanel.info("App moved to "+b)}).onerror(function(b,a){ui.MessagePanel.error(a?a:"Error moving: "+c.get_display_name())})};ui.do_app_set_host=function(b){var c=ui.get_app();ui.MessagePanel.doing("Updating release URL for "+
c.get_display_name()+"...");c.t_set_host(b).onready(function(){ui.MessagePanel.info("Release URL updated");$("#app-hosts-list").acre(fb.acre.apps.appeditor+"/mjt/menus.mjt","app_hosts_list")}).onerror(function(b,a){ui.MessagePanel.error(a?a:"Error updating release URL for: "+c.get_display_name())})};ui.do_app_set_release=function(b){var c=ui.get_app();ui.MessagePanel.doing("Updating release of "+c.get_display_name()+"...");c.t_set_release(b).onready(function(){ui.MessagePanel.info("Release updated to "+
b);$("#app-versions-add").acre(fb.acre.apps.appeditor+"/mjt/menus.mjt","app_versions_list");$("#app-hosts-list").acre(fb.acre.apps.appeditor+"/mjt/menus.mjt","app_hosts_list")}).onerror(function(b,a){ui.MessagePanel.error(a?a:"Error releasing: "+c.get_display_name())})};ui.do_app_add_version=function(b,c,a){var f=ui.get_app();ui.MessagePanel.doing("Creating version "+b);f.t_add_version(b,c,a).onready(function(){ui.MessagePanel.info("Created version "+b);$("#app-versions-add").acre(fb.acre.apps.appeditor+
"/mjt/menus.mjt","app_versions_list")}).onerror(function(b,c){ui.MessagePanel.error("Failed to add version. "+c)})};ui.do_app_remove_version=function(b){var c=ui.get_app();ui.MessagePanel.doing("Removing version "+b);c.t_remove_version(b).onready(function(c){ui.MessagePanel.info("Removed version "+b);$("#app-versions-add").acre(fb.acre.apps.appeditor+"/mjt/menus.mjt","app_versions_list",[c])})};ui.do_app_set_listing=function(b,c,a){var f=ui.get_app();ui.MessagePanel.doing("Updating app name...");
f.t_set_listing(b,c,a).onready(function(){b&&ui.add_recent("apps",{path:f.get_path(),name:f.get_display_name()},f.get_path());ui.MessagePanel.info("Updated app name");ui.refresh_app_templates()}).onerror(function(b,c){ui.MessagePanel.error(c?c:"Error changing app name")})};ui.do_app_add_author=function(b){ui.get_app().t_add_author(b).onready(function(){var b=ui.get_app().get_authors();$("#app-authors-list").acre(fb.acre.apps.appeditor+"/mjt/menus.mjt","app_authors_list",[b])})};ui.do_app_remove_author=
function(b){ui.get_app().t_remove_author(b).onready(function(){var b=ui.get_app().get_authors();$("#app-authors-list").acre(fb.acre.apps.appeditor+"/mjt/menus.mjt","app_authors_list",[b])})};ui.do_app_set_writeuser=function(b){var c=ui.get_app();ui.MessagePanel.doing("Setting write user...");c.t_set_writeuser(b).onready(function(){ui.MessagePanel.info("Write user "+(b?"enabled":"disabled"))}).onerror(function(b,c){ui.MessagePanel.error("Failed to update writeuser state: "+c)})};ui.do_app_add_apikey=
function(b,c,a){var f=ui.get_app();ui.MessagePanel.doing("Adding API key for "+b+"...");f.t_add_apikey(b,c,a).onready(function(c){ui.MessagePanel.info(b+" API key added.");$("#app-apikeys-add").acre(fb.acre.apps.appeditor+"/mjt/menus.mjt","app_apikeys_list",[c.keys])}).onerror(function(b,c){ui.MessagePanel.error("Failed to add API key: "+c)})};ui.do_app_remove_apikey=function(b){var c=ui.get_app();ui.MessagePanel.doing("Deleting API key for "+b+"...");c.t_remove_apikey(b).onready(function(c){ui.MessagePanel.info(b+
" API key deleted.");$("#app-apikeys-add").acre(fb.acre.apps.appeditor+"/mjt/menus.mjt","app_apikeys_list",[c.keys])}).onerror(function(b,c){ui.MessagePanel.error("Failed to delete API key: "+c)})};ui.do_app_save_all=function(b){var c=ui.get_app();!c.is_dirty()&&"function"===typeof b?b():(ui.MessagePanel.doing("Saving all files..."),c.t_save_all().onready(function(){ui.MessagePanel.info("All files saved.");ui.refresh_file_templates();"function"===typeof b&&setTimeout(b,500)}).onerror(function(b,c){ui.MessagePanel.error("Failed to save all files: "+
c)}))};ui.do_app_delete=function(){var b=ui.get_app();ui.MessagePanel.doing("Deleting: "+b.get_display_name()+"...");b.t_delete().onready(function(c){ui.get_store().set_user_apps(c);ui.MessagePanel.info("Deleted app");m=null;ui.add_recent("apps",null,b.get_path());ui.do_choose_app()}).onerror(function(c,a){ui.MessagePanel.error(a?a:"Error deleting: "+b.get_display_name())})};ui.do_app_apply_changes=function(b,c,a){for(var f=0;f<c.length;f++)ui.do_file_apply_change(b.files[c[f]]);ui.refresh_file_templates();
a&&ui.do_app_save_all()};ui.do_file_create_new=function(b,c,a){ui.get_app().get_file(b)?ui.MessagePanel.error("File with that name already exists"):(b=new AcreDoc(ui.get_app(),b,c,a),ui.do_choose_file(b.get_name()))};ui.do_file_set_acre_handler=function(b){var c=ui.get_file();b!==c.get_acre_handler()&&(c.set_acre_handler(b),ui.do_refresh_file())};ui.do_file_set_mime_type=function(b){var c=ui.get_file();b!==c.get_mime_type()&&(c.set_mime_type(b),ui.do_refresh_file())};ui.do_file_save=function(b){var c=
ui.get_file();c.is_dirty()&&(ui.MessagePanel.doing("Saving file: "+c.get_name()+"..."),c.t_save(b).enqueue().onready(function(){ui.refresh_file_templates();ui.MessagePanel.info("File saved: "+c.get_name())}).onerror(function(b,a,f){"/api/status/error/upload/content_mismatch"===b?(ui.MessagePanel.clear(),ui.do_show_dialog("diff_patch",["save_conflict",f.info])):"/api/status/error/auth"===b?ui.MessagePanel.error("You are not currently signed in.  To not lose your changes, sign in in a new tab or window and then try again."):
"/api/status/error/file_format/unsupported_mime_type"===b?ui.MessagePanel.error(a):ui.MessagePanel.error(a||"Error saving: "+c.get_name());ui.refresh_file_templates()}))};ui.do_file_save_as=function(b,c){var a=ui.get_file(),f=b==a.get_app().get_path()?a.get_app():new AcreApp(ui.get_store(),b),h={handler:a.get_acre_handler(),content_type:a.get_mime_type(),based_on:a.get_app().get_path()+"/"+mjt.freebase.mqlkey_quote(a.get_name())},d=new AcreDoc(f,c,h,a.get_editor_state());ui.MessagePanel.doing("Saving file as: "+
c+"...");d.t_save().enqueue().onready(function(){f==ui.get_app()?ui.do_choose_file(d.get_name()):f.destroy();ui.MessagePanel.info("File created: "+c)})};ui.do_file_revert_to_saved=function(){ui.get_file().t_revert_to_saved().onready(function(){ui.do_refresh_file()})};ui.do_file_move=function(b,c){var a=ui.get_file(),f=a.get_name();if(b!=f)if(ui.get_app().get_file(b))ui.MessagePanel.error('The name "'+b+'" is already taken. Please choose a different name.',c);else{try{a.set_name(b)}catch(h){ui.MessagePanel.error(h,
c);return}ui.do_choose_file(a.get_name())}};ui.do_file_delete=function(b){var c=b?ui.get_app().get_file(b):ui.get_file();ui.MessagePanel.doing("Deleting file:"+c.get_name()+"...");c.t_delete().onready(function(){ui.MessagePanel.info("File deleted: "+c.get_name());j=null;ui.do_choose_file()}).onerror(function(b,a){ui.MessagePanel.error(a?a:"Error deleting: "+c.get_name())})};ui.do_file_apply_change=function(b,c){var a=b.file1,f=b.file2,h;a?f?(h=ui.get_app().get_file(f.name),h.set_name(a.name),h.set_acre_handler(a.acre_handler),
h.set_mime_type(a.content_type),b.patch?(a=b.patch.text,h.is_editor_loaded()?h.set_editor_state({text:a}):($("#file-area").append(h.get_element()),h.t_editor_show("TextareaEditor",{margin:!1},{text:a}),h.hide())):a.content_id&&a.content_id!==f.content_id&&h.set_revision(a.content_id)):(h={handler:a.acre_handler,content_type:a.content_type,based_on:a.fileid},h=new AcreDoc(ui.get_app(),a.name,h,{text:a.text}),h.hide()):(h=ui.get_app().get_file(f.name),h.set_dirty("to_delete"));f&&f.name===ui.get_file().get_name()&&
ui.do_refresh_file();c&&ui.do_file_save()};ui.do_file_editor_undo=function(){ui.get_file().editor_undo()};ui.do_file_editor_redo=function(){ui.get_file().editor_redo()};ui.do_file_editor_goto_line=function(b){ui.get_file().editor_goto_line(b)};ui.do_file_editor_indent=function(){ui.get_file().editor_indent()};ui.get_file_check_options=function(){var c={bitwise:!0,eqeqeq:!0,forin:!0,sub:!0,undef:!0,useful:1},f=["acre","JSON","XMLHttpRequest","console"];switch(ui.get_file().get_acre_handler()){case "mqlquery":break;
case "acre_script":c.predef=f;c.es5=!0;break;case "mjt":c.es5=!0;c.useful=0;c.predef=f;c.before_check=d;break;case "passthrough":c.browser=!0;switch(ui.get_file().get_mime_type()){case "application/json":break;case "text/javascript":break;case "text/html":c.before_check=a;break;case "text/css":c.before_check=b;break;case "text/plain":c.useful=0;break;default:c.useful=-1}break;default:c.useful=-1}return c};ui.do_click_error=function(b){b=$(b.target);if(b.hasClass("jslint-error")){var c=b.attr("title");
ui.MessagePanel.clear();c=(c+"").replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");ui.MessagePanel.error(c);b=b.text();ui.get_file().editor_goto_line(b)}};ui.do_file_check=function(){ui.do_hide_overlays();var b=$(".CodeMirror-line-numbers,.editor-margin-line-numbers",ui.get_file().get_element());$(">div.jslint-error",b).attr("title","").removeClass("jslint-error");ui.MessagePanel.clear();var c=ui.get_file_check_options();assert.critical(c,"missing jslint_options");var a=ui.get_file().get_editor_state().text;
c.before_check&&(a=c.before_check(a));fb.get_script(fb.acre.libs.fulljslint,function(){if(JSLINT(a,c))ui.MessagePanel.info("No syntax errors found");else{var f=JSLINT.errors,h="Found "+f.length+" errors.  Click any of the red line numbers below to see corresponding error details.",d=$(">div",b);if(d.length)for(var j=0;j<f.length;j++){var l=f[j];if(l){var n=d.eq(l.line-1);n.addClass("jslint-error");n.attr("title",n.attr("title")+" "+l.reason)}}else f=f.slice(0,3),h=$.map(f,function(b){if(b)return"Line: "+
b.line+" "+b.reason});ui.MessagePanel.error(h);ui.get_file().editor_goto_line(f[0].line)}})};ui.do_zen_coding=function(){if("CodeMirror"===ui.get_file().get_editor_name()){var b=ui.get_file()._current_editor.editor,c=b.cursorPosition(),a=b.options.indentUnit,f=b.lineContent(c.line),f=/(\s*)(.*)/.exec(f),a=Math.floor(f[1].length/a);if(f=f[2])a=zen.convert(f,a),a.error?ui.MessagePanel.error('Zen Coding syntax error in "'+mjt.htmlencode(a.error)+'".<br> See <a target="_blank" href="http://code.google.com/p/zen-coding/wiki/ZenHTMLSelectorsEn">ZenCoding</a> for help'):
(ui.MessagePanel.info('Expanded <a target="_blank" href="http://code.google.com/p/zen-coding/wiki/ZenHTMLSelectorsEn">ZenCoding</a> expression'),b.setLineContent(c.line,a.out))}};var n={texteditor:"CodeMirror",syntax:-1===navigator.userAgent.indexOf("iPad")?!0:!1,margin:!0,softwrap:!1,dotTrigger:!1,flw:200,emql:!1};ui.get_editor_prefs=function(b){function c(b){var a=$.localstore(b);return null===a?n[b]:"1"==a?!0:"0"==a?!1:a}if(b)return c(b);var b={},a;for(a in n)b[a]=c(a);return b};ui.set_editor_prefs=
function(b,c){var a;1==arguments.length?a=b:2==arguments.length&&(a={},a[b]=c);for(var f in a)$.localstore(f,!0===a[f]?"1":!1===a[f]?"0":a[f])};ui._get_desired_editor_classname=function(b){b=b||this.get_file();b=b.get_acre_handler();if("binary"==b)return"ImageEditor";if("mqlquery"==b)return"QueryEditor";b=ui.get_editor_prefs("texteditor");return EDITORS[b]?b:n.texteditor};ui._register_editor_event_handlers=function(b){b.register_editor_event_handlers({change:ui.editor_change_handler,linechange:ui.editor_linechange_handler,
newframe:ui.editor_newframe_handler})};ui.editor_change_handler=function(b,c){ui.do_status_check();(q!=ui.get_file().is_dirty()||0===b)&&ui.refresh_file_templates();0<b?(ui._has_undos||$("#button-undo").removeAttr("disabled"),ui._has_undos=!0):(ui._has_undos&&$("#button-undo").attr("disabled","disabled"),ui._has_undos=!1);0<c?(ui._has_redos||$("#button-redo").removeAttr("disabled"),ui._has_redos=!0):(ui._has_redos&&$("#button-redo").attr("disabled","disabled"),ui._has_redos=!1)};ui.editor_linechange_handler=
function(b){l=b;$("#linenumber").val(b)};ui.editor_newframe_handler=function(b){ui.shortcut.register_keys(b.contentWindow?b.contentWindow.document:b.contentDocument)};ui.warn_user_about_unsaved_files=function(){if(ui&&ui.get_app()&&ui.get_app().is_dirty())return"You have unsaved files! The changes you made to these files will be lost if you leave this page."};ui.url_for=function(b){return fb.acre.request.base_path+"/"+b};ui.get_app_url=function(b){return"http://"+b+ui.get_store().get_acre_host()};
ui.get_appeditor_url=function(b,c){var a;"string"==typeof b?a=b:b instanceof AcreDoc?(a=b.get_app().get_versioned_path(),c=b.get_relative_path()):b instanceof AcreApp&&(a=b.get_versioned_path());var f=window.location.protocol+"//"+window.location.host+window.location.pathname;a&&(f+="#!path="+a);c&&(f+="/"+c);return f};ui.id_to_path=function(b){return"//"+b.split("/").reverse().join(".")+"dev"};ui.get_human_timestamp=function(b){return mjt.freebase.date_from_iso(b).toLocaleString()};ui.get_relative_timestamp=
function(b){var c=new Date,b=mjt.freebase.date_from_iso(b),a=c.getTime()-b.getTime(),c=Math.floor(a/94608E7),b=Math.floor(a/2592E6),f=Math.floor(a/864E5),h=Math.floor(a/36E5),a=Math.floor(a/6E4);if(0<c)return 1===c?"1 year ago":c+" years ago";if(0<b)return 1===b?"1 month ago":b+" months ago";if(0<f)return 1===f?"1 day ago":f+" days ago";if(0<h)return 1===h?"1 hour ago":h+" hours ago";if(0<a)return 1===a?"1 minute ago":a+" minutes ago";if(0===a)return"less than a minute ago";if(0>a)return"in the future???"};
ui.order_section_files=function(b){var c={},b=b.get_files(),a;for(a in b){var f=b[a],h=f.get_name(),f=f.get_acre_handler(),f="acre_script"==f&&"test_"==h.substr(0,5)?"test":f;"undefined"==typeof c[f]&&(c[f]=[]);c[f].push(h)}for(var d in c)c[d].sort(function(b,c){return b.localeCompare(c)});return c};ui.order_lib_files=function(b){var c=[],b=b.get_files(),a;for(a in b)c.push(b[a].get_name());c.sort(function(b,c){return b.localeCompare(c)});return c};ui.watch_inputs=function(b,c){function a(){var b=
!1,f=c.inputs.length,h={};jQuery.each(c.inputs,function(a){var d,j=$("#"+a)[0];"undefined"==typeof j&&(j=$("input[name='"+a+"']")[0]);if("undefined"!=typeof j&&("TEXTAREA"==j.tagName?d=jQuery.trim($("#"+a).val()):"INPUT"==j.tagName?(j=$(j).attr("type"),"text"==j?d=jQuery.trim($("#"+a).val()):"radio"==j?d=$("input[name='"+a+"']:checked").val():"checkbox"==j&&(d=$("#"+a).attr("checked"))):"SELECT"==j.tagName&&(d=$("#"+a+" :selected").val()),d!=c.inputs[a]))b=!0,f-=1,h[a]=d});return"all"==c.activate_on?
0===f?h:!1:b?h:!1}function f(){var h=a();if(h&&c.change){var d=c.change.apply(this,[h]);"undefined"!==typeof d&&(h=d)}h?$("#button-"+b).removeAttr("disabled").addClass("button-main"):$("#button-"+b).attr("disabled","disabled").removeClass("button-main")}function h(b){$("#"+b).bind("change",function(){f()})}function d(b){var a;$("#"+b).bind("keyup",function(){clearTimeout(a);a=setTimeout(f,c.text_delay||300)})}jQuery.each(c.inputs,function(b,c){var a=$("#"+b)[0];"undefined"==typeof a&&(a=$("input[name='"+
b+"']")[0]);"undefined"!=typeof a&&("TEXTAREA"==a.tagName?d(b,c):"INPUT"==a.tagName?(a=$(a).attr("type"),"text"==a?d(b):"radio"==a?$("input[name='"+b+"']").bind("click",function(){f()}):h(b)):"SELECT"==a.tagName&&h(b))});$("#button-"+b).unbind("click").click(function(){var b=a();c.submit.apply(this,[b]);c.update_on_submit&&(jQuery.extend(c.inputs,b),f())})};ui.populate_diff=function(b,c,a){function f(){var c=b.parent().height()-l.height();e.height(c);g.height(c);i.height(c);r.height(c)}function h(){var b;
c.file1||"undefined"===typeof c.file1?(b=g.scrollTop(),e.scrollTop(b)):b=r.scrollTop();if(c.file2||"undefined"===typeof c.file2)i.scrollTop(b),r.scrollTop(b)}function d(b,c,a,f){var h;h=1<a.length?"replace":-1==a[0][0]&&"left"===f?"delete":1==a[0][0]&&"right"===f?"insert":"eq";var j=$('<div class="line"></div>'),l="left"===f?1:-1;1==a.length&&a[0][0]==l?j.append("<pre> </pre>"):(j.append($("<pre></pre>").text(q[f])),1===a.length&&a[0][0]===l||(q[f]+=1));b.append(j);b=$('<div class="code"></div>').addClass(h);
h=$("<pre></pre>");j=!1;for(l=0;l<a.length;l++){var n=a[l],e=""===n[1]?" ":n[1];switch(n[0]){case 0:j=!0;n=$('<span class="text-eq"></span>').text(e);h.append(n);break;case 1:"right"===f&&(j=!0,n=$('<span class="text-add"></span>').text(e),h.append(n));break;case -1:"left"===f&&(j=!0,n=$('<span class="text-delete"></span>').text(e),h.append(n))}}j||h.text(" ");b.append(h);c.append(b)}function j(b){b=b.fileid.split("/");b.pop();return b.join("/")}var l=$('<div class="diff-header-container"></div>'),
n=$('<div class="diff-header"></div>'),e=$('<div class="diff-line-container"></div>'),g=$('<div class="diff-code-container"></div>'),m=$('<div class="diff-header"></div>'),i=$('<div class="diff-line-container"></div>'),r=$('<div class="diff-code-container"></div>'),q={left:1,right:1};if(c.labels&&c.labels.length){if(c.labels[0]&&(a=$("<h3></h3>"),a.text(c.labels[0]),m.append(a),l.append(m)),c.labels[1])a=$("<h3></h3>"),a.text(c.labels[1]),n.append(a),l.append(n)}else{if(c.file2){var t=$("<h3></h3>");
c.file1||(m.addClass("full"),r.addClass("full"),t.append("Delete: "));var u;u=c.file1;var o=c.file2;u=u&&o?u.name!==o.name:!1;u&&t.addClass("change");t.append(c.file2.name);j(c.file2)!==ui.get_app().get_path()&&t.append(" in "+j(c.file2));u=$("<h3></h3>");var o=c.file1,x=c.file2,o=o&&x?o.handler!==x.handler||o.content_type!==x.content_type:!1;o&&u.addClass("change");u.append(ui.get_app().get_acre_handlers()[c.file2.handler].name);c.file2.content_type&&u.append(" ("+c.file2.content_type+")");m.append(t).append(u);
"get_file_diff"===a&&(t=$("<h3></h3>"),c.file2.last_modified&&t.append("Last Mod: "+ui.get_human_timestamp(c.file2.last_modified)),m.append(t));l.append(m)}c.file1&&(m=$("<h3></h3>"),c.file2?"get_file_merge"==a&&m.append("After Merge: "):(n.addClass("full"),g.addClass("full"),m.append("Create: ")),m.append(c.file1.name),"get_file_diff"==a&&j(c.file1)!==ui.get_app().get_path()&&m.append(" in "+j(c.file1)),t=$("<h3></h3>"),t.append(ui.get_app().get_acre_handlers()[c.file1.handler].name),c.file1.content_type&&
t.append(" ("+c.file1.content_type+")"),n.append(m).append(t),"get_file_diff"===a&&(a=$("<h3></h3>"),c.file1.last_modified&&a.append("Last Mod: "+ui.get_human_timestamp(c.file1.last_modified)),n.append(a)),l.append(n))}b.append(l);if(c.message)b.append($('<div class="message"></div>').text(c.message));else if(c.file1&&c.file2&&c.file1.content_id===c.file2.content_id)b.append('<div class="message">No change in content</div>');else if(c.file2&&c.file2.binary||c.file1&&c.file1.binary){if(c.file2&&c.file2.binary&&
(i.append("<pre> </pre>"),r.append('<div class="image"><div class="image-preview"><img src="'+c.file2.binary+'" /></div></div>'),b.append(i).append(r)),c.file1&&c.file1.binary)e.append("<pre> </pre>"),g.append('<div class="image"><div class="image-preview"><img src="'+c.file1.binary+'" /></div></div>'),b.append(e).append(g)}else if(c.diff){for(n=0;n<c.diff.length;n++)a=c.diff[n],(c.file2||"undefined"===typeof c.file2)&&d(i,r,a,"left"),(c.file1||"undefined"===typeof c.file1)&&d(e,g,a,"right");if(c.file2||
"undefined"===typeof c.file2)i.append('<div class="line"><pre> </pre></div>'),b.append(i).append(r),r.scroll(h);if(c.file1||"undefined"===typeof c.file1)e.append('<div class="line"><pre> </pre></div>'),b.append(e).append(g),g.scroll(h);(c.file1||"undefined"===typeof c.file1)&&(c.file2||"undefined"===typeof c.file2)&&r.css("overflow-y","hidden")}f();$(window).resize(f)};var t=function(b,c,a){v&&"error"===v?mjt.error("MessagePanel: Already displaying error. Ignoring: "+b+": "+c):($("#message-panel").hide().acre(fb.acre.apps.appeditor+
"/mjt/templates.mjt","message_panel",[b,c,null]),v=b,window.clearTimeout(u),x=function(){$("#message-panel").empty();v=x=null},u=window.setTimeout(x,a),$("#message-panel").slideDown(300))},u,x,v;ui.MessagePanel={doing:function(b,c){t("doing",b,2E6,c);return""},info:function(b,c){t("info",b,4E3,c);return""},error:function(b,c){t("error",b,6E3,c);return""},clear:function(){window.clearTimeout(u);x&&x()}};ui.shortcut={};var r=[{op:"Code Assist"},{op:"Open App",key:"O",action:function(){ui.do_show_menu("apps",
[!0])}},{op:"Save File",key:"S",action:function(){ui.do_file_save()}},{op:"View",key:"Shift-P",action:function(){ui.do_run_view(null,!1)}},{op:"View with Console",key:"P",action:function(){ui.do_run_view(null,!0)}},{op:"Undo",key:"Z",action:function(){ui.do_file_editor_undo()}},{op:"Redo",key:"Shift-Z",action:function(){ui.do_file_editor_redo()}},{op:"Redo",key:"Y",action:function(){ui.do_file_editor_redo()}},{op:"Check Syntax",key:"Shift-C",action:function(){ui.do_file_check()}},{op:"Expand Expression",
key:"E",action:function(){ui.do_zen_coding()}},{op:"Indent Selection",key:"Shift-I",action:function(){ui.do_file_editor_indent()}},{op:"Jump to Line",key:"J",action:function(){$("#linenumber").focus().select()}}],o=0===navigator.platform.indexOf("Mac")?"Meta":"Ctrl";ui.shortcut.register_keys=function(b){$.each(r,function(c,a){shortcut.add(o+"-"+a.key,a.action,{target:b})})};ui.shortcut.get_shortcuts=function(){return r};ui.shortcut.get_keys=function(b){var c;"Code Assist"==b?c=(0===navigator.platform.indexOf("Mac")?
"Alt-":"Ctrl-")+"Space":$.each(r,function(a,f){f.op==b&&(c=(0===navigator.platform.indexOf("Mac")?"&#8984;-":"Ctrl-")+f.key)});return c}})();
$(document).ready(function(){if($.browser.msie&&"8.0">$.browser.version)assert.critical(!1,"Internet Explorer 6 and 7 are not supported.  IE8+, Firefox 3+ and Safari 3+ are.Another option is to install <a href='http://www.google.com/chromeframe'>Google Chrome Frame</a>");else{ui.set_store(new FreebaseStore);var a=ui.get_store();a.t_init().onready(function(){ui.set_user(a.get_user());ui.init()}).onerror(function(c,a,b){assert.critical(!1,"Error connecting to Freebase<br/>"+a);mjt.error(c,a,b)})}});
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//95a.appeditor.www.tags.svn.freebase-site.googlecode.dev/mjt/templates.mjt",source:{def:function(){var a=function(){var c=this.tpackage,a=this.exports,b=c._template_fragments,g=c.runtime.new_markuplist(),i=0;g[i++]=b[0];var e;e=c.runtime.tfunc_factory("body()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[1];c.runtime.ondomready(function(){var b=parseInt(ui.get_editor_prefs("flw"));$(window).resize(function(){$("#list-column").width(b);
$("#file-margin").css("left",b);$("#file-column").css("left",b+$("#file-margin").width());var c=$("#fixer"),a=c.offset(),d=$("#file-column").offset(),j=Math.max(a.top+c[0].offsetHeight,$(window).height())-Math.max(d.top,$("#header").height()+1),d=Math.max(a.left+c[0].offsetWidth,$(window).width())-d.left,l=$("#file-area").offset(),c=Math.max(a.top+c[0].offsetHeight,$(window).height())-l.top;$(".row").width(d);$(".column").height(j-1);$("#file-area").height(c-1);$("#file-list").height(c-$("#app-edits").height());
$(".refresh-right").show();ui.dialog&&ui.dialog.css("left",($(window).width()-ui.dialog.outerWidth())/2)});$("#file-margin").draggable({axis:"x",iframeFix:!0,containment:[125,,400],drag:function(){b=$("#file-margin").offset().left;$(window).trigger("resize")},stop:function(){b=$("#file-margin").offset().left;ui.set_editor_prefs({flw:b});$(window).trigger("resize")}});$("#file-area").click(ui.do_click_error)},this);a[d++]=b[2];return a},c,void 0,!1);a.body=e;e.source_microdata=null;g[i++]=b[3];e=function(a){var d=
c.runtime.new_markuplist(),e=0;d[e++]=b[4];ui.get_store();ui.get_user();var h=ui.get_app();d[e++]=b[5];"open"==a?d[e++]=b[6]:"loading"==a?d[e++]=b[7]:(a=c.runtime.uniqueid("onclick"),mjt._eventcb[a]=function(){ui.do_show_menu("appsettings")},d[e++]=b[8],d[e++]=c.runtime.make_attr_safe(a,!1),d[e++]=b[9],d[e++]=h.get_display_name(),d[e++]=b[10]);d[e++]=b[11];return d};e=c.runtime.tfunc_factory("header(state)",e,c,void 0,!1);a.header=e;e.source_microdata=null;g[i++]=b[12];e=c.runtime.tfunc_factory("about_bar()",
function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[13];var e=ui.get_app(),h=e.is_author(),f=e.is_remote(),n=ui.get_user(),m=e.get_versions(),g=e.get_released_version(),i=e.get_version_label(),v=e.get_path(),r=e.get_versioned_path(),g=g?v.replace("//","//release."):null,o=m.length;g&&g!=r&&(o-=1);a[d++]=b[14];i?(a[d++]=b[15],a[d++]=i,a[d++]=b[16]):(a[d++]=b[17],i="Current",a[d++]=b[18]);a[d++]=b[19];if(f)a[d++]=b[20],a[d++]=e.get_acre_host(),a[d++]=b[21];else if(h)a[d++]=b[22],n=c.runtime.uniqueid("onclick"),
mjt._eventcb[n]=function(){ui.do_choose_app(ui.get_app().get_path())},a[d++]=b[23],a[d++]=c.runtime.make_attr_safe(n,!1),a[d++]=b[24],n=c.runtime.uniqueid("onclick"),mjt._eventcb[n]=function(){ui.do_show_dialog("new_app",[true])},a[d++]=b[25],a[d++]=c.runtime.make_attr_safe(n,!1),a[d++]=b[26];else{a[d++]=b[27];e=c.runtime.uniqueid("onclick");mjt._eventcb[e]=function(){ui.do_show_dialog("new_app",[true])};a[d++]=b[28];h=n?{}:{disabled:"disabled"};"class"in h||(a[d++]=b[29]);"id"in h||(a[d++]=b[30]);
"onclick"in h||(a[d++]=b[31],a[d++]=c.runtime.make_attr_safe(e,!1),a[d++]=b[32]);for(var p in h)a[d++]=" "+p,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+h[p]),a[d++]=c.runtime.bless('"');a[d++]=b[33];n||(a[d++]=b[34]);a[d++]=b[35]}a[d++]=b[36];m.length&&(a[d++]=b[37],g&&g!=r&&(a[d++]=b[38],a[d++]=c.runtime.make_attr_safe(g,!1),a[d++]=b[39],a[d++]=c.runtime.make_attr_safe(ui.get_appeditor_url(g),!0),a[d++]=b[40]),a[d++]=b[41],i&&"Current"!=i&&(a[d++]=b[42],a[d++]=c.runtime.make_attr_safe(v,
!1),a[d++]=b[43],a[d++]=c.runtime.make_attr_safe(ui.get_appeditor_url(v),!0),a[d++]=b[44]),a[d++]=b[45],0<o&&(m=c.runtime.uniqueid("onclick"),mjt._eventcb[m]=function(){return ui.do_show_menu("appsettings",["general"])},a[d++]=b[46],a[d++]=c.runtime.make_attr_safe(m,!1),a[d++]=b[47]),a[d++]=b[48]);a[d++]=b[49];return a},c,void 0,!1);a.about_bar=e;e.source_microdata=null;g[i++]=b[50];e=c.runtime.tfunc_factory("list_column()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[51];if(ui.get_app().is_writable()){var e=
c.runtime.uniqueid("onclick");mjt._eventcb[e]=function(){ui.do_show_dialog("add_file")};a[d++]=b[52];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[53]}a[d++]=b[54];a[d++]=m();a[d++]=b[55];return a},c,void 0,!1);a.list_column=e;e.source_microdata=null;g[i++]=b[56];var m=function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[57];var e=!1,h=ui.get_app().get_last_change();h&&36E5>+new Date-mjt.freebase.date_from_iso(h.timestamp)&&(e=!0);a[d++]=b[58];e&&(a[d++]=b[59],a[d++]=h.attribution.name,a[d++]=
b[60],a[d++]=mjt.freebase.mqlkey_unquote(h.file),a[d++]=b[61],a[d++]=ui.get_relative_timestamp(h.timestamp),a[d++]=b[62]);a[d++]=b[63];return a},m=c.runtime.tfunc_factory("app_edits()",m,c,void 0,!1);a.app_edits=m;m.source_microdata=null;g[i++]=b[64];e=c.runtime.tfunc_factory("file_list()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[65];var e=function(a,f,h,d,j){var l=c.runtime.new_markuplist(),e=0;l[e++]=b[66];l[e++]=c.runtime.make_attr_safe(a,!1);l[e++]=b[67];d&&(l[e++]=b[68],ui.get_editor_prefs("c_"+
a)?(l[e++]=b[69],l[e++]=c.runtime.make_attr_safe(a,!1),l[e++]=b[70]):(l[e++]=b[71],l[e++]=c.runtime.make_attr_safe(a,!1),l[e++]=b[72]),l[e++]=b[73],j?(l[e++]=b[74],l[e++]=c.runtime.make_attr_safe(h.get_path(),!1),l[e++]=b[75],l[e++]=c.runtime.make_attr_safe(ui.get_appeditor_url(h.get_path()),!0),l[e++]=b[76],l[e++]=f,l[e++]=b[77]):(l[e++]=b[78],l[e++]=f,l[e++]=b[79]),l[e++]=b[80]);l[e++]=b[81];c.runtime.foreach(this,d,function(f,j){for(var m=1;m;){if(d){l[e++]=b[82];var g=h.get_file(j),i=a,t="file-list-item",
q=ui.get_file()?ui.get_file().get_relative_path():null;g.get_relative_path()==q&&(t+=" selected-file");g.is_dirty("to_delete")&&(t+=" deleted-file");g.is_dirty()&&(t+=" edited-file");ui.get_editor_prefs("c_"+i)&&(t+=" hidden-file");var g={"class":t,fname:h.get_file(j).get_relative_path()},B;for(B in g)l[e++]=" "+B,l[e++]=c.runtime.bless('="'),l[e++]=c.runtime.htmlencode(""+g[B]),l[e++]=c.runtime.bless('"');l[e++]=b[83];g=c.runtime.uniqueid("onclick");mjt._eventcb[g]=function(){ui.do_show_dialog("delete_file",
[j])};l[e++]=b[84];i=h.is_writable()?{"class":"file-delete"}:{"class":"file-nodelete"};"class"in i||(l[e++]=b[85]);"onclick"in i||(l[e++]=b[86],l[e++]=c.runtime.make_attr_safe(g,!1),l[e++]=b[87]);for(var C in i)l[e++]=" "+C,l[e++]=c.runtime.bless('="'),l[e++]=c.runtime.htmlencode(""+i[C]),l[e++]=c.runtime.bless('"');l[e++]=b[88];l[e++]=c.runtime.make_attr_safe(ui.get_appeditor_url(h.get_file(j)),!0);l[e++]=b[89];l[e++]=j;l[e++]=b[90]}m--}return m?c.runtime._break_token:c.runtime._continue_token});
l[e++]=b[91];return l},e=c.runtime.tfunc_factory("filelist_section(section_key, section_name, app, filenames, link)",e,c,void 0,!1);e.source_microdata=null;a[d++]=b[92];var h=ui.get_app(),f=ui.order_section_files(h);a[d++]=b[93];c.runtime.foreach(this,ui.get_app().get_acre_handlers(),function(n,g){for(var m=1;m;)a[d++]=b[94],a[d++]=e(n,g.plural_name,h,f[n]),a[d++]=b[95],m--;return m?c.runtime._break_token:c.runtime._continue_token});a[d++]=b[96];f.test&&f.test.length&&(a[d++]=b[97],a[d++]=e("test",
"Tests",h,f.test),a[d++]=b[98]);a[d++]=b[99];c.runtime.ondomready(function(){$(".file-list-section-toggle").click(function(){var b=$(this).attr("section");if($(this).text()=="\u25bc"){$(this).text("\u25ba");ui.set_editor_prefs("c_"+b,true);$("ul[section='"+b+"'] .file-list-item").addClass("hidden-file")}else{$(this).text("\u25bc");ui.set_editor_prefs("c_"+b,false);$("ul[section='"+b+"'] .file-list-item").removeClass("hidden-file")}});$("#file-list .file-list-item").click(function(b){if(!b.ctrlKey&&
!b.metaKey&&!b.altKey&&!b.shiftKey){b=$(this).attr("fname");ui.do_choose_file(b);return false}})},this);a[d++]=b[100];return a},c,void 0,!1);a.file_list=e;e.source_microdata=null;g[i++]=b[101];e=c.runtime.tfunc_factory("button_bar()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[102];var e=ui.get_app(),h=ui.get_file(),f=e?e.is_writable():!1,n=h?h.get_editor_supported_features():!1,n=n.margin||n.softwrap||n.hotswap||n.emql,g=$("#button-fileactions").hasClass("button-open"),m=$("#button-editoroptions").hasClass("button-open");
a[d++]=b[103];if(h){a[d++]=b[104];var i=c.runtime.uniqueid("onclick");mjt._eventcb[i]=function(){ui.do_run_view(null,!1)};a[d++]=b[105];var v=h.get_editor_supported_features("inline_preview")?{disabled:"disabled"}:{};"id"in v||(a[d++]=b[106]);"title"in v||(a[d++]=b[107],a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View")),!1),a[d++]=b[108]);"onclick"in v||(a[d++]=b[109],a[d++]=c.runtime.make_attr_safe(i,!1),a[d++]=b[110]);for(var r in v)a[d++]=" "+r,a[d++]=c.runtime.bless('="'),
a[d++]=c.runtime.htmlencode(""+v[r]),a[d++]=c.runtime.bless('"');a[d++]=b[111];r=c.runtime.uniqueid("onclick");mjt._eventcb[r]=function(){ui.do_run_view(null,true)};a[d++]=b[112];i=h.get_editor_supported_features("inline_preview")?{disabled:"disabled"}:{};"class"in i||(a[d++]=b[113]);"id"in i||(a[d++]=b[114]);"title"in i||(a[d++]=b[115],a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View with Console")),!1),a[d++]=b[116]);"onclick"in i||(a[d++]=b[117],a[d++]=c.runtime.make_attr_safe(r,
!1),a[d++]=b[118]);for(var o in i)a[d++]=" "+o,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+i[o]),a[d++]=c.runtime.bless('"');a[d++]=b[119];o=c.runtime.uniqueid("onclick");mjt._eventcb[o]=function(){ui.do_file_save()};a[d++]=b[120];r=h.is_dirty()?{}:{disabled:"disabled"};"class"in r||(a[d++]=b[121]);"id"in r||(a[d++]=b[122]);"title"in r||(a[d++]=b[123],a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Save File")),!1),a[d++]=b[124]);"onclick"in r||(a[d++]=b[125],a[d++]=
c.runtime.make_attr_safe(o,!1),a[d++]=b[126]);for(var p in r)a[d++]=" "+p,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+r[p]),a[d++]=c.runtime.bless('"');a[d++]=b[127];p=c.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_app_save_all()};a[d++]=b[128];e=e.is_dirty()?{}:{disabled:"disabled"};"class"in e||(a[d++]=b[129]);"id"in e||(a[d++]=b[130]);"onclick"in e||(a[d++]=b[131],a[d++]=c.runtime.make_attr_safe(p,!1),a[d++]=b[132]);for(var w in e)a[d++]=" "+w,a[d++]=c.runtime.bless('="'),
a[d++]=c.runtime.htmlencode(""+e[w]),a[d++]=c.runtime.bless('"');a[d++]=b[133];w=c.runtime.uniqueid("onclick");mjt._eventcb[w]=function(){ui.do_show_dialog("save_file_as")};a[d++]=b[134];e=!ui.get_user()||"binary"==h.get_acre_handler()?{disabled:"disabled"}:{};"class"in e||(a[d++]=b[135]);"id"in e||(a[d++]=b[136]);"onclick"in e||(a[d++]=b[137],a[d++]=c.runtime.make_attr_safe(w,!1),a[d++]=b[138]);for(var s in e)a[d++]=" "+s,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+e[s]),a[d++]=c.runtime.bless('"');
a[d++]=b[139];s=c.runtime.uniqueid("onclick");mjt._eventcb[s]=function(){ui.do_file_editor_undo()};a[d++]=b[140];w=ui._has_undos?{}:{disabled:"disabled"};"class"in w||(a[d++]=b[141]);"id"in w||(a[d++]=b[142]);"title"in w||(a[d++]=b[143],a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Undo")),!1),a[d++]=b[144]);"onclick"in w||(a[d++]=b[145],a[d++]=c.runtime.make_attr_safe(s,!1),a[d++]=b[146]);for(var y in w)a[d++]=" "+y,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+w[y]),
a[d++]=c.runtime.bless('"');a[d++]=b[147];y=c.runtime.uniqueid("onclick");mjt._eventcb[y]=function(){ui.do_file_editor_redo()};a[d++]=b[148];s=ui._has_redos?{}:{disabled:"disabled"};"class"in s||(a[d++]=b[149]);"id"in s||(a[d++]=b[150]);"title"in s||(a[d++]=b[151],a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Redo")),!1),a[d++]=b[152]);"onclick"in s||(a[d++]=b[153],a[d++]=c.runtime.make_attr_safe(y,!1),a[d++]=b[154]);for(var z in s)a[d++]=" "+z,a[d++]=c.runtime.bless('="'),a[d++]=
c.runtime.htmlencode(""+s[z]),a[d++]=c.runtime.bless('"');a[d++]=b[155];z=c.runtime.uniqueid("onclick");mjt._eventcb[z]=function(){ui.do_file_editor_indent()};a[d++]=b[156];f=h.get_editor_supported_features("indent")&&f?{}:{disabled:"disabled"};"id"in f||(a[d++]=b[157]);"title"in f||(a[d++]=b[158],a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Indent Selection")),!1),a[d++]=b[159]);"onclick"in f||(a[d++]=b[160],a[d++]=c.runtime.make_attr_safe(z,!1),a[d++]=b[161]);for(var A in f)a[d++]=
" "+A,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+f[A]),a[d++]=c.runtime.bless('"');a[d++]=b[162];A=c.runtime.uniqueid("onclick");mjt._eventcb[A]=function(){ui.do_show_menu("fileactions")};a[d++]=b[163];g=g?{"class":"button-open"}:{};"class"in g||(a[d++]=b[164]);"id"in g||(a[d++]=b[165]);"onclick"in g||(a[d++]=b[166],a[d++]=c.runtime.make_attr_safe(A,!1),a[d++]=b[167]);for(var D in g)a[d++]=" "+D,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+g[D]),a[d++]=c.runtime.bless('"');
a[d++]=b[168];D=c.runtime.uniqueid("onclick");mjt._eventcb[D]=function(){ui.do_show_menu("editoroptions")};a[d++]=b[169];n=m?{"class":"button-open"}:n?{}:{disabled:"disabled"};"class"in n||(a[d++]=b[170]);"id"in n||(a[d++]=b[171]);"onclick"in n||(a[d++]=b[172],a[d++]=c.runtime.make_attr_safe(D,!1),a[d++]=b[173]);for(var B in n)a[d++]=" "+B,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+n[B]),a[d++]=c.runtime.bless('"');a[d++]=b[174];B=c.runtime.uniqueid("onclick");mjt._eventcb[B]=function(){ui.do_show_menu("help")};
a[d++]=b[175];a[d++]=c.runtime.make_attr_safe(B,!1);a[d++]=b[176];h.get_editor_supported_features("linenumbers")&&(a[d++]=b[177],a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Jump to Line")),!1),a[d++]=b[178],a[d++]=c.runtime.make_attr_safe(ui.get_line()||"",!1),a[d++]=b[179]);a[d++]=b[180]}a[d++]=b[181];c.runtime.ondomready(function(){$("#linenumber").keypress(function(b){13==b.which&&(b=parseInt($("#linenumber").val(),10),ui.do_file_editor_goto_line(b))})},this);a[d++]=b[182];
return a},c,void 0,!1);a.button_bar=e;e.source_microdata=null;g[i++]=b[183];e=c.runtime.tfunc_factory("query_button_bar()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[184];var e=ui.get_app().is_writable();a[d++]=b[185];var h=c.runtime.uniqueid("onclick");mjt._eventcb[h]=function(){ui.get_file()._current_editor.query_run()};a[d++]=b[186];a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("View")),!1);a[d++]=b[187];a[d++]=c.runtime.make_attr_safe(h,!1);a[d++]=b[188];h=c.runtime.uniqueid("onclick");
mjt._eventcb[h]=function(){ui.get_file()._current_editor.query_assist()};a[d++]=b[189];var f=e?{}:{disabled:"disabled"};"title"in f||(a[d++]=b[190]);"onclick"in f||(a[d++]=b[191],a[d++]=c.runtime.make_attr_safe(h,!1),a[d++]=b[192]);for(var n in f)a[d++]=" "+n,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+f[n]),a[d++]=c.runtime.bless('"');a[d++]=b[193];n=c.runtime.uniqueid("onclick");mjt._eventcb[n]=function(){ui.get_file()._current_editor.generate_template()};a[d++]=b[194];e=e?{}:{disabled:"disabled"};
"onclick"in e||(a[d++]=b[195],a[d++]=c.runtime.make_attr_safe(n,!1),a[d++]=b[196]);for(var g in e)a[d++]=" "+g,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+e[g]),a[d++]=c.runtime.bless('"');a[d++]=b[197];return a},c,void 0,!1);a.query_button_bar=e;e.source_microdata=null;g[i++]=b[198];e=function(a,d,e){var h=c.runtime.new_markuplist(),f=0;h[f++]=b[199];h[f++]=c.runtime.make_attr_safe(a,!1);h[f++]=b[200];this.subst_id&&(h[f++]=c.runtime.bless(' id="'+this.subst_id+'"'));h[f++]=b[201];
h[f++]=c.runtime.make_attr_safe(a,!1);h[f++]=b[202];h[f++]=d;h[f++]=b[203];h[f++]=e||"";h[f++]=b[204];c.runtime.ondomready(function(){$("#message-panel-close").click(function(){ui.MessagePanel.clear()})},this);h[f++]=b[205];return h};e=c.runtime.tfunc_factory("message_panel(type, msg, tid)",e,c,void 0,!1);a.message_panel=e;e.source_microdata=null;g[i++]=b[206];return g};a.source_microdata=null;return a}(),info:{file:"//95a.appeditor.www.tags.svn.freebase-site.googlecode.dev/mjt/templates.mjt",stringtable:'\n\n<\!-- called by ui.init --\>;\n  <div id="message-panel"></div>\n  <div id="about-bar"></div>\n  <div id="columns">\n    <div class="refresh column" id="list-column"></div>\n    <div class="refresh column" id="file-margin"></div>\n    <div class="column row" id="file-column">\n      <div class="refresh" id="button-bar"></div>\n      <div class="refresh" id="file-area"></div>\n    </div>\n  </div>;;\n\n<\!-- called by ui.refresh_app_templates --\>;;;\n  <p>\n    <span class="app-name">Acre App Editor</span>\n  </p>;\n  <p><span class="app-name">Loading...</span></p>;\n  <div class="app-name" id="button-appsettings" onclick="return mjt._eventcb.;.apply(this, [event])">\n    <p><span class="button-menu">;</span></p>\n  </div>;;\n\n<\!-- called by ui.refresh_app_templates --\>;;\n  <div class="column left" id="about-bar-left">;\n      <span>\n        Version ;\n      </span>;\n      <span>;\n        Current\n      </span>;\n  </div>\n  <div class="column margin" id="about-bar-margin"> </div>\n  <div class="column row" id="about-bar-middle">;\n    <div>\n      <h2><em>This app is hosted on ;</em></h2>\n    </div>;\n    <div>;\n      <button class="button-main" id="button-trunk" onclick="return mjt._eventcb.;.apply(this, [event])">\n        Edit Current</button>\n      or;\n      <button id="button-clone" onclick="return mjt._eventcb.;.apply(this, [event])">\n        Clone this App</button>\n    </div>;\n    <div>;\n      <button; class="button-main"; id="button-clone"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n        Clone this App</button>;\n        <span>Sign in to make an app based on this one!</span>;\n    </div>;\n    <div class="refresh-right" id="about-bar-right">;\n      <span><b>\n        Versions:;\n        <a apppath=";" class="app-link" href=";">Release</a>;;\n        <a apppath=";" class="app-link" href=";">Current</a>;;\n        <a href="#0" onclick="return mjt._eventcb.;.apply(this, [event])">more...</a>;\n      </b></span>;\n    </div>\n  </div>;;;\n  <button id="button-new-file" onclick="return mjt._eventcb.;.apply(this, [event])">\n    New File</button>;\n  <h1>Files</h1>\n\n  <div id="file-list"></div>\n  <div id="app-edits-shim">\n    ;\n  </div>;;;;\n    <div id="app-edits">\n      <div class="content">\n        <span class="file-list-section-title">Active Author: </span>\n        <span class="change">\n          ; edited \';\' ;\n        </span>\n      </div>\n    </div>;;\n\n<\!-- called by ui.refresh_file_templates --\>;;\n    <ul section=";">;\n      <li class="file-list-section-header">;\n        <span class="file-list-section-toggle" section=";">\u25ba</span>;\n        <span class="file-list-section-toggle" section=";">\u25bc</span>;;\n        <a apppath=";" class="file-list-section-title app-link" href=";">;</a>;\n        <span class="file-list-section-title">;</span>;\n      </li>;;\n      <li;>;\n          <div; class="file-delete"; onclick="return mjt._eventcb.;.apply(this, [event])";></div>\n          <a href=";">;</a>\n      </li>;\n    </ul>;;;\n\n  <div>\n    ;\n  </div>;;\n  <div>\n    ;\n  </div>;;;\n\n<\!-- called by ui.refresh_file_templates --\>;;\n    <div id="file-buttons">;\n      <div>\n      <div class="refresh-right" id="file-buttons-right">\n        <\!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>;\n        <button; id="button-view"; title=";"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          View</button>;\n        <button; class="button-main"; id="button-preview"; title=";"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          View with Console</button>\n      </div>\n      <span class="buttonset">\n        <\!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>;\n        <button; class="button-left button-main"; id="button-save"; title=";"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          Save\n        </button>;<button; class="button-middle"; id="button-saveall"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          Save All\n        </button>;<button; class="button-right"; id="button-save"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          Save As</button>;\n        <button; class="button-left"; id="button-undo"; title=";"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          Undo\n        </button>;<button; class="button-right"; id="button-redo"; title=";"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          Redo</button>;\n        <button; id="button-indent"; title=";"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          Indent\n        </button>\n      </span>\n      <span class="buttonset">;\n       <button; class="button-left"; id="button-fileactions"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          <span class="button-menu">File</span></button>;<button; class="button-middle"; id="button-editoroptions"; onclick="return mjt._eventcb.;.apply(this, [event])";>\n          <span class="button-menu">Editor</span></button>;<button class="button-right" id="button-help" onclick="return mjt._eventcb.;.apply(this, [event])">\n          <span class="button-menu">Help</span></button>\n      </span>\n      <span class="buttoncount">\n        <\!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>;\n        <span class=" buttonset linecount">\n          Line <input class="form-textbox" id="linenumber" title=";" type="text" value=";">\n        </span>;\n      </span>\n    </div>;;\n  </div>;;<div id="query-editor-buttons">;\n  <\!-- mjt.bless for system control characters (HTML entities) declared in ui.shortcut --\>;\n  <button class="button-main" title=";" onclick="return mjt._eventcb.;.apply(this, [event])">\n    Run</button>;\n  <button; title="Tab"; onclick="return mjt._eventcb.;.apply(this, [event])";>Query Assist</button>;\n  <button; onclick="return mjt._eventcb.;.apply(this, [event])";>Create Template</button>\n</div>;\n\n<\!-- utilities --\>;<div class="message-;";>\n  <\!--<span id="message-panel-close">x</span>--\>\n  <div class="message-icon ;"></div>;\n  <span class="message-tid">;</span>;\n</div>;'.split(";"),
debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,18,18,18,18,18,18,18,18,18,18,18,18,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,68,68,68,68,68,70,70,70,70,70,70,71,71,72,73,74,75,76,76,78,78,78,78,78,79,79,79,79,80,80,80,80,80,80,80,81,81,81,82,82,82,83,83,83,83,83,83,86,86,86,86,86,86,87,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,103,103,104,104,104,104,105,105,105,106,107,107,107,110,110,110,
110,113,113,113,113,113,114,114,114,114,115,115,115,116,117,117,117,117,117,117,117,117,120,120,120,120,120,120,120,120,120,122,122,122,122,123,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,126,126,126,126,126,126,127,127,127,129,129,129,131,131,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,132,132,133,133,133,133,133,133,133,133,133,133,134,134,134,137,137,137,137,137,137,137,137,139,139,139,139,140,140,140,140,140,140,140,140,141,141,
141,146,146,146,146,146,146,146,148,148,148,148,148,148,148,150,150,150,150,151,151,152,153,154,155,156,157,158,159,159,163,163,163,163,163,163,163,163,163,163,163,166,166,166,166,166,167,167,167,167,167,167,170,170,170,170,170,170,172,172,172,172,173,173,173,174,174,175,175,175,175,175,175,175,175,176,176,176,176,176,176,178,178,178,178,178,178,178,178,178,178,178,179,179,179,179,179,179,180,180,180,182,182,182,182,182,182,182,182,182,182,182,182,182,182,182,183,183,183,183,183,183,183,183,183,183,
183,183,183,183,183,183,183,183,183,183,184,184,184,184,184,185,185,185,185,185,185,185,187,187,187,187,187,187,189,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,204,204,204,205,205,205,205,205,206,206,206,206,206,206,207,207,208,208,208,208,209,209,209,211,211,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,236,236,236,236,236,238,238,238,238,238,238,239,239,240,241,242,243,244,245,246,247,248,249,251,251,251,255,255,255,255,255,
255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,264,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,267,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,273,
273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,273,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,285,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,287,
288,288,288,288,288,288,288,293,293,293,293,293,293,294,294,294,294,294,294,295,295,295,297,297,297,297,298,298,298,299,300,301,302,303,304,305,306,308,308,308,308,308,308,308,309,309,309,309,310,310,311,312,314,314,314,314,314,314,314,314,314,314,317,317,317,317,317,317,317,317,317,317,317,317,317,317,317,317,317,317,317,317,317,319,319,319,319,319,319,319,319,319,319,319,319,319,319,319,319,319,319,320,320,320,320,320,320,320,323,323,323,323,323,323,323,323,323,323,325,325,325,325,325,325,326,326,
326,327,327,327,328,329,330,331,332,333,333,333,333,333,333,333,334,334,334,334],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//95a.appeditor.www.tags.svn.freebase-site.googlecode.dev/mjt/dialogs.mjt",source:{def:function(){var a=function(){var c=this.tpackage,a=this.exports,b=c._template_fragments,g=c.runtime.new_markuplist(),i=0;g[i++]=b[0];var e=function(a){var d=c.runtime.new_markuplist(),e=0;d[e++]=b[1];var g=c.runtime.uniqueid("onclick");mjt._eventcb[g]=function(){ui.do_choose_app(a)};d[e++]=b[2];d[e++]=c.runtime.make_attr_safe(g,!1);d[e++]=
b[3];return d},e=c.runtime.tfunc_factory("files_dirty(new_app)",e,c,void 0,!1);a.files_dirty=e;e.source_microdata=null;g[i++]=b[4];e=function(a){var d=c.runtime.new_markuplist(),e=0;d[e++]=b[5];a?(d[e++]=b[6],d[e++]=c.runtime.make_attr_safe(ui.get_store().get_freebase_url(),!0),d[e++]=b[7],d[e++]=c.runtime.make_attr_safe(ui.get_store().get_freebase_url(),!0),d[e++]=b[8],a=c.runtime.uniqueid("onclick"),mjt._eventcb[a]=function(){ui.do_show("new_app")},d[e++]=b[9],d[e++]=c.runtime.make_attr_safe(a,
!1),d[e++]=b[10],a=c.runtime.uniqueid("onclick"),mjt._eventcb[a]=function(){ui.do_show_menu("yourapps")},d[e++]=b[11],d[e++]=c.runtime.make_attr_safe(a,!1),d[e++]=b[12]):(d[e++]=b[13],d[e++]=c.runtime.make_attr_safe(ui.get_store().get_freebase_url(),!0),d[e++]=b[14],d[e++]=c.runtime.make_attr_safe(ui.get_store().get_freebase_url(),!0),d[e++]=b[15]);d[e++]=b[16];return d};e=c.runtime.tfunc_factory("welcome(is_user)",e,c,void 0,!1);a.welcome=e;e.source_microdata=null;g[i++]=b[17];e=function(a){var d=
c.runtime.new_markuplist(),e=0;d[e++]=b[18];var g=a?ui.get_app().get_display_name()+" copy":"",h=a?ui.get_app().get_name()+"-copy":"";d[e++]=b[19];var f=a?{}:{checked:"checked"};"id"in f||(d[e++]=b[20]);"name"in f||(d[e++]=b[21]);"type"in f||(d[e++]=b[22]);"value"in f||(d[e++]=b[23]);for(var n in f)d[e++]=" "+n,d[e++]=c.runtime.bless('="'),d[e++]=c.runtime.htmlencode(""+f[n]),d[e++]=c.runtime.bless('"');d[e++]=b[24];f=a?{checked:"checked"}:{};"id"in f||(d[e++]=b[25]);"name"in f||(d[e++]=b[26]);"type"in
f||(d[e++]=b[27]);"value"in f||(d[e++]=b[28]);for(var i in f)d[e++]=" "+i,d[e++]=c.runtime.bless('="'),d[e++]=c.runtime.htmlencode(""+f[i]),d[e++]=c.runtime.bless('"');d[e++]=b[29];i=a?{}:{style:"display:none"};"id"in i||(d[e++]=b[30]);for(var u in i)d[e++]=" "+u,d[e++]=c.runtime.bless('="'),d[e++]=c.runtime.htmlencode(""+i[u]),d[e++]=c.runtime.bless('"');d[e++]=b[31];d[e++]=c.runtime.make_attr_safe(a?ui.get_app().get_versioned_path():"",!1);d[e++]=b[32];d[e++]=c.runtime.make_attr_safe(g,!1);d[e++]=
b[33];d[e++]=c.runtime.make_attr_safe(h,!1);d[e++]=b[34];d[e++]=ui.get_user().get_new_app_host();d[e++]=b[35];c.runtime.ondomready(function(){$("#new-app-dialog-name").focus().select();$("#dialog-new_app input[name='new-app']").change(function(){$("#new-app-clone-field").toggle()});$("#new-app-clone-id").suggest({type:"/freebase/apps/acre_app",filter:"(any type:/freebase/apps/acre_app)"}).bind("fb-select",function(b,c){$(this).val(ui.id_to_path(c.id))});$("#button-new-app").click(function(){var b=
[ui.get_user().get_new_app_path($.trim($("#new-app-dialog-key").val())),$.trim($("#new-app-dialog-name").val())],c=$("#dialog-new_app input[name='new-app']:checked").val(),a=$("#new-app-clone-id").val();"clone"==c&&""!==a&&b.push(a);ui.do_app_create_new.apply(this,b)})},this);d[e++]=b[36];return d};e=c.runtime.tfunc_factory("new_app(clone)",e,c,void 0,!1);a.new_app=e;e.source_microdata=null;g[i++]=b[37];e=c.runtime.tfunc_factory("delete_app()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=
b[38];a[d++]=ui.get_app().get_display_name();a[d++]=b[39];var e=c.runtime.uniqueid("onclick");mjt._eventcb[e]=function(){ui.do_app_delete()};a[d++]=b[40];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[41];return a},c,void 0,!1);a.delete_app=e;e.source_microdata=null;g[i++]=b[42];e=c.runtime.tfunc_factory("save_file_as()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[43];var e=function(a){var d=c.runtime.new_markuplist(),f=0;d[f++]=b[44];ui.app_keys={};$.each(a,function(){ui.app_keys[this.path]=
this.files});d[f++]=b[45];d[f++]=c.runtime.make_attr_safe(ui.get_file().get_name(),!1);d[f++]=b[46];c.runtime.foreach(this,a,function(a,e){for(var g=1;g;){d[f++]=b[47];var j=ui.get_app().get_path()==e.path?{selected:!0}:{};"value"in j||(d[f++]=b[48],d[f++]=c.runtime.make_attr_safe(e.path,!1),d[f++]=b[49]);for(var i in j)d[f++]=" "+i,d[f++]=c.runtime.bless('="'),d[f++]=c.runtime.htmlencode(""+j[i]),d[f++]=c.runtime.bless('"');d[f++]=b[50];d[f++]=e.name;d[f++]=b[51];g--}return g?c.runtime._break_token:
c.runtime._continue_token});d[f++]=b[52];c.runtime.ondomready(function(){$("#clone-filename").focus().select();$("#button-clone").click(function(){var b=$.trim($("#clone-filename").val()),c=$.trim($("#clone-file-app :selected").val());-1==$.inArray(b,ui.app_keys[c])?(ui.do_file_save_as(c,b),ui.do_hide_overlays()):ui.MessagePanel.error("File exists!  Try a different file name.")})},this);d[f++]=b[53];return d},e=c.runtime.tfunc_factory("save_file_applist(applist)",e,c,void 0,!1);e.source_microdata=
null;a[d++]=b[54];c.runtime.ondomready(function(){ui.get_store().XhrGet("list_user_apps",{include_filenames:!0}).enqueue().onready(function(b){$("#applist").acre(e(b))})},this);a[d++]=b[55];return a},c,void 0,!1);a.save_file_as=e;e.source_microdata=null;g[i++]=b[56];e=c.runtime.tfunc_factory("add_file()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[57];var e=ui.get_app().get_untitled_file_name();a[d++]=b[58];var g=function(a){var d=c.runtime.new_markuplist(),e=0;d[e++]=b[59];var g=ui.get_app().get_supported_mime_types(a);
d[e++]=b[60];1<g.length&&"binary"!=a&&(d[e++]=b[61],c.runtime.foreach(this,g,function(a,h){for(var g=1;g;){d[e++]=b[62];var i="text/plain"==h?{selected:""}:{};"value"in i||(d[e++]=b[63],d[e++]=c.runtime.make_attr_safe(h,!1),d[e++]=b[64]);for(var j in i)d[e++]=" "+j,d[e++]=c.runtime.bless('="'),d[e++]=c.runtime.htmlencode(""+i[j]),d[e++]=c.runtime.bless('"');d[e++]=b[65];d[e++]=h;d[e++]=b[66];g--}return g?c.runtime._break_token:c.runtime._continue_token}),d[e++]=b[67]);d[e++]=b[68];return d},g=c.runtime.tfunc_factory("show_mime_types(handler)",
g,c,void 0,!1);g.source_microdata=null;a[d++]=b[69];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[70];c.runtime.foreach(this,ui.get_app().get_acre_handlers(),function(h,f){for(var e=1;e;)a[d++]=b[71],a[d++]=c.runtime.make_attr_safe(f.key,!1),a[d++]=b[72],a[d++]=c.runtime.make_attr_safe(f.key,!1),a[d++]=b[73],a[d++]=f.key,a[d++]=b[74],e--;return e?c.runtime._break_token:c.runtime._continue_token});a[d++]=b[75];c.runtime.ondomready(function(){$("#add-file-name").select().keydown(function(b){13==b.which&&
$("#button-add-file").click()});ui.watch_inputs("add-file",{inputs:{"add-file-handler":null},change:function(b){(b=b["add-file-handler"])?$("#add-file-mimetype-container").acre(g(b)):$("#add-file-mimetype-container").empty()},submit:function(){var b=$.trim($("#add-file-name").val());if(ui.get_store().validate_filename(b)){var c={};$("#add-file-handler :selected").val()&&(c.handler=$("#add-file-handler :selected").val());$("#add-file-mimetype :selected").val()&&(c.content_type=$("#add-file-mimetype :selected").val());
ui.do_file_create_new(b,c);ui.do_hide_overlays()}else ui.MessagePanel.error("Invalid filename.  Only alphanumeric characters, '-', '_' and '.' are allowed.")}})},this);a[d++]=b[76];return a},c,void 0,!1);a.add_file=e;e.source_microdata=null;g[i++]=b[77];e=function(a){var d=c.runtime.new_markuplist(),e=0;d[e++]=b[78];d[e++]=a;d[e++]=b[79];d[e++]=a;d[e++]=b[80];var g=c.runtime.uniqueid("onclick");mjt._eventcb[g]=function(){ui.do_file_delete(a)};d[e++]=b[81];d[e++]=c.runtime.make_attr_safe(g,!1);d[e++]=
b[82];return d};e=c.runtime.tfunc_factory("delete_file(filename)",e,c,void 0,!1);a.delete_file=e;e.source_microdata=null;g[i++]=b[83];e=function(a,d){var e=c.runtime.new_markuplist(),g=0;e[g++]=b[84];var h=function(a,d){var f=c.runtime.new_markuplist(),h=0;f[h++]=b[85];this.subst_id&&(f[h++]=c.runtime.bless(' id="'+this.subst_id+'"'));f[h++]=b[86];var e=a[0]||{},g=!1,i=!1,j=!1;e.revision?e.file?i=!0:j=!0:g=!0;e=ui.get_file().get_based_on();f[h++]=b[87];j&&e&&(f[h++]=b[88],f[h++]=ui.get_file().get_name(),
f[h++]=b[89],f[h++]=c.runtime.make_attr_safe(ui.get_store().get_url(),!0),f[h++]=b[90],f[h++]=c.runtime.make_attr_safe(e.id,!1),f[h++]=b[91],f[h++]=e.id,f[h++]=b[92]);f[h++]=b[93];g&&(f[h++]=b[94]);f[h++]=b[95];i&&(f[h++]=b[96]);f[h++]=b[97];j&&(f[h++]=b[98]);f[h++]=b[99];if(i||j)f[h++]=b[100];f[h++]=b[101];g&&(f[h++]=b[102]);f[h++]=b[103];i&&(f[h++]=b[104]);f[h++]=b[105];j&&(f[h++]=b[106]);f[h++]=b[107];if(i||j)f[h++]=b[108];f[h++]=b[109];c.runtime.foreach(this,a,function(a,d){for(var e=1;e;){f[h++]=
b[110];var n;if(g)n=d.as_of_time;if(i||j)n=d.timestamp;f[h++]=b[111];f[h++]=c.runtime.make_attr_safe(n,false);f[h++]=b[112];f[h++]=c.runtime.make_attr_safe(n,false);f[h++]=b[113];if(g){f[h++]=b[114];f[h++]=d.name;f[h++]=b[115]}f[h++]=b[116];if(i){f[h++]=b[117];f[h++]=mjt.freebase.mqlkey_unquote(d.file);f[h++]=b[118]}f[h++]=b[119];f[h++]=mjt.freebase.date_from_iso(d.as_of_time||d.timestamp).toLocaleString();f[h++]=b[120];if(j){f[h++]=b[121];f[h++]=d.length;f[h++]=b[122]}f[h++]=b[123];if(i||j){f[h++]=
b[124];f[h++]=d.attribution.name;f[h++]=b[125]}f[h++]=b[126];e--}return e?c.runtime._break_token:c.runtime._continue_token});f[h++]=b[127];c.runtime.ondomready(function(){function b(){$("input[name='diff-from'], input[name='diff-to']").removeAttr("disabled");var c=$("input[name='diff-to']").index($("input[name='diff-to']:checked")[0]),a=$("input[name='diff-from']").index($("input[name='diff-from']:checked")[0]);$("input[name='diff-to']").slice(0,a+1).attr("disabled","disabled");$("input[name='diff-from']").slice(c).attr("disabled",
"disabled")}$("#dialog-diff_patch input, .show-revision, .revert-revision, .diff-button").unbind("click");b();$("input[name='diff-from'], input[name='diff-to']").click(function(){$(".button-patch").attr("disabled","disabled");var c={timestamp1:$("input[name='diff-to']:checked").val(),timestamp2:$("input[name='diff-from']:checked").val()};if(g||i){$("#diff-filelist-shim").acre(n(true));$("#diff-view-shim").acre(u());c.appid1=d;c.appid2=d;ui.get_store().XhrGet("get_app_diff",c).enqueue().onready(function(b){$("#diff-filelist-shim").acre(n(b))})}if(j){c.fileid1=
d;c.fileid2=d;ui.get_store().XhrGet("get_file_diff",c).enqueue().onready(function(b){$("#diff-view-shim").acre(u(b,"get_file_diff"));$("#button-file-revert, #button-file-revert-save").removeAttr("disabled").unbind("click");$("#button-file-revert").click(function(){ui.do_file_apply_change(b)});$("#button-file-revert-save").click(function(){ui.do_file_apply_change(b,true)})})}b()})},this);f[h++]=b[128];return f},h=c.runtime.tfunc_factory("revision_list(history, id)",h,c,void 0,!1);h.source_microdata=
null;e[g++]=b[129];var f=function(a){var d=c.runtime.new_markuplist(),f=0;d[f++]=b[130];d[f++]=n(a);d[f++]=b[131];return d},f=c.runtime.tfunc_factory("filelist_shim(patch)",f,c,void 0,!1);f.source_microdata=null;e[g++]=b[132];var n=function(d){var f=c.runtime.new_markuplist(),h=0;f[h++]=b[133];if(d&&d.files){f[h++]=b[134];ui.get_app().get_path();var e=[];if($.isArray(d.files))e=d.files;else for(key in d.files)e.push(key);e.sort(function(b,c){return b.localeCompare(c)});f[h++]=b[135];var g=function(d,
f){var h=c.runtime.new_markuplist(),e=0;h[e++]=b[136];if(f){h[e++]=b[137];if("app_diff"!==a){h[e++]=b[138];var g="update"===f?{checked:"checked"}:{};"type"in g||(h[e++]=b[139]);for(var n in g)h[e++]=" "+n,h[e++]=c.runtime.bless('="'),h[e++]=c.runtime.htmlencode(""+g[n]),h[e++]=c.runtime.bless('"');h[e++]=b[140]}h[e++]=b[141];g="app_diff"===a?{"class":"diff-filelist-stub"}:{};"href"in g||(h[e++]=b[142]);for(var i in g)h[e++]=" "+i,h[e++]=c.runtime.bless('="'),h[e++]=c.runtime.htmlencode(""+g[i]),h[e++]=
c.runtime.bless('"');h[e++]=b[143];h[e++]=mjt.freebase.mqlkey_unquote(d);h[e++]=b[144]}else h[e++]=b[145],h[e++]=mjt.freebase.mqlkey_unquote(d),h[e++]=b[146];h[e++]=b[147];switch(f){case "add":h[e++]=b[148];break;case "delete":h[e++]=b[149];break;case "conflict":h[e++]=b[150];break;case "update":h[e++]=b[151]}h[e++]=b[152];return h},g=c.runtime.tfunc_factory("diff_file(fn, status)",g,c,void 0,!1);g.source_microdata=null;f[h++]=b[153];var n=c.runtime.uniqueid("onclick");mjt._eventcb[n]=function(){$("#diff-filelist input").attr("checked",
"checked")};f[h++]=b[154];f[h++]=c.runtime.make_attr_safe(n,!1);f[h++]=b[155];n=c.runtime.uniqueid("onclick");mjt._eventcb[n]=function(){$("#diff-filelist input").removeAttr("checked")};f[h++]=b[156];f[h++]=c.runtime.make_attr_safe(n,!1);f[h++]=b[157];c.runtime.foreach(this,e,function(a,d){for(var e=1;e;)f[h++]=b[158],f[h++]=c.runtime.make_attr_safe(d,!1),f[h++]=b[159],f[h++]=mjt.freebase.mqlkey_unquote(d),f[h++]=b[160],e--;return e?c.runtime._break_token:c.runtime._continue_token});f[h++]=b[161];
c.runtime.ondomready(function(){var b=$("#diff-filelist .file-list-item").length;$("#diff-filelist .file-list-item").each(function(){function c(a,d,e){$(f).acre(g(h,a)).click(function(){$("#diff-filelist .file-list-item").removeClass("selected-file");$(f).addClass("selected-file");$("#diff-view-shim").acre(d.apply(this,e))});b-=1;0===b&&($(".button-patch").removeAttr("disabled"),$("#diff-filelist .file-list-item input").click(function(b){b.stopPropagation()}))}var f=$(this),h=$(f).attr("data-fn"),
e,n={};switch(a){case "app_history":case "app_diff":e="get_file_diff";n={fileid1:d.files[h].file1?d.files[h].file1.fileid:void 0,fileid2:d.files[h].file2?d.files[h].file2.fileid:void 0,timestamp1:d.app1?d.app1.timestamp:void 0,timestamp2:d.app2?d.app2.timestamp:void 0};break;case "merge_changes":e="get_file_merge",n={fileid1:d.files[h].file1?d.files[h].file1.fileid:void 0,fileid2:d.files[h].file2?d.files[h].file2.fileid:void 0}}ui.get_store().XhrGet(e,n).enqueue().onready(function(b){d.files[h]=b;
status=b.file1?b.file2?b.patch&&!0==b.patch.conflict?"conflict":"update":"add":"delete";c(status,u,[d.files[h],e])}).onerror(function(b,a,d){c(!1,x,[a,d])})})},this);f[h++]=b[162]}else d?f[h++]=b[163]:f[h++]=b[164];f[h++]=b[165];c.runtime.ondomready(function(){$(".patch-apply, .patch-apply-save").unbind("click");$(".patch-apply, .patch-apply-save").click(function(){var b=[];$("#diff-filelist input:checked").each(function(){var c=$(this).closest(".file-list-item").attr("data-fn");b.push(c)});ui.do_app_apply_changes(d,
b,$(this).hasClass("patch-apply-save"))})},this);f[h++]=b[166];return f},n=c.runtime.tfunc_factory("filelist(patch)",n,c,void 0,!1);n.source_microdata=null;e[g++]=b[167];var i=function(a){var d=c.runtime.new_markuplist(),f=0;d[f++]=b[168];d[f++]=u(a);d[f++]=b[169];return d},i=c.runtime.tfunc_factory("diff_view_shim(diff)",i,c,void 0,!1);i.source_microdata=null;e[g++]=b[170];var u=function(a,d){var f=c.runtime.new_markuplist(),h=0;f[h++]=b[171];a?(f[h++]=b[172],c.runtime.ondomready(function(){ui.populate_diff($("#diff-view"),
a,d)},this),f[h++]=b[173]):f[h++]=b[174];f[h++]=b[175];return f},u=c.runtime.tfunc_factory("diff_view(data, method)",u,c,void 0,!1);u.source_microdata=null;e[g++]=b[176];var x=function(a){var d=c.runtime.new_markuplist(),f=0;d[f++]=b[177];d[f++]=a;d[f++]=b[178];return d},x=c.runtime.tfunc_factory("merge_error(msg, info)",x,c,void 0,!1);x.source_microdata=null;e[g++]=b[179];var v;v=c.runtime.tfunc_factory("app_history(t)",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[180];var e=function(){var a=
c.runtime.new_markuplist(),d=0;a[d++]=b[181];a[d++]=f();a[d++]=b[182];a[d++]=i();a[d++]=b[183];return a},e=c.runtime.tfunc_factory("history_diff()",e,c,void 0,!1);e.source_microdata=null;a[d++]=b[184];s&&(a[d++]=b[185]);a[d++]=b[186];s&&(a[d++]=b[187]);a[d++]=b[188];c.runtime.ondomready(function(){function b(c){$("#revision-list-shim").empty().addClass("loader-square");("versions"==c?mjt.Succeed(ui.get_app().get_versions()):ui.get_app().t_get_history()).enqueue().onready(function(b){$("#revision-list-shim").removeClass("loader-square").acre(h(b.history||
b,ui.get_app().get_path()));$("#history-diff").acre(e());$(".button-patch").attr("disabled","disabled")})}$('input[name="app-history"]').change(function(){b($(this).val())});b("versions")},this);a[d++]=b[189];return a},c,void 0,!1);v.source_microdata=null;e[g++]=b[190];var r=function(a){var d=c.runtime.new_markuplist(),h=0;d[h++]=b[191];d[h++]=f(a);d[h++]=b[192];d[h++]=i();d[h++]=b[193];return d},r=c.runtime.tfunc_factory("app_diff(diff)",r,c,void 0,!1);r.source_microdata=null;e[g++]=b[194];var o=
function(a){var d=c.runtime.new_markuplist(),f=0;d[f++]=b[195];d[f++]=h(a.history,a.fileid);d[f++]=b[196];d[f++]=i();d[f++]=b[197];s&&(d[f++]=b[198]);d[f++]=b[199];s&&(d[f++]=b[200]);d[f++]=b[201];return d},o=c.runtime.tfunc_factory("file_history(t)",o,c,void 0,!1);o.source_microdata=null;e[g++]=b[202];var p=function(a){var d=c.runtime.new_markuplist(),h=0;d[h++]=b[203];d[h++]=f(a);d[h++]=b[204];d[h++]=i();d[h++]=b[205];s&&(d[h++]=b[206]);d[h++]=b[207];s&&(d[h++]=b[208]);d[h++]=b[209];return d},p=
c.runtime.tfunc_factory("merge_changes(patch)",p,c,void 0,!1);p.source_microdata=null;e[g++]=b[210];var w=function(a){var d=c.runtime.new_markuplist(),f=0;d[f++]=b[211];a.labels=["Saved Copy","Your Local Version"];d[f++]=b[212];d[f++]=u(a,"get_file_diff");d[f++]=b[213];a=c.runtime.uniqueid("onclick");mjt._eventcb[a]=function(){ui.do_file_save(!0)};d[f++]=b[214];d[f++]=c.runtime.make_attr_safe(a,!1);d[f++]=b[215];return d},w=c.runtime.tfunc_factory("save_conflict(diff)",w,c,void 0,!1);w.source_microdata=
null;e[g++]=b[216];var s=ui.get_app().is_writable(),y,z,A;switch(a){case "app_history":y="App History";z=mjt.Succeed(ui.get_app().get_versions());A=v;break;case "app_diff":v=ui.get_app().get_versions()[0];y="View changes since version "+v.name;z=ui.get_store().XhrGet("get_app_diff",{appid1:ui.get_app().get_path(),appid2:ui.get_app().get_path(),timestamp2:v.as_of_time});A=r;break;case "file_history":y="File History";z=ui.get_file().t_get_history();A=o;break;case "merge_changes":y="View changes from "+
d.appid;z=ui.get_store().XhrGet("get_app_diff",{appid1:d.appid,appid2:ui.get_app().get_path()});A=p;break;case "save_conflict":y="File Save Conflict",z=mjt.Succeed(d),A=w}e[g++]=b[217];e[g++]=y;e[g++]=b[218];c.runtime.ondomready(function(){z.enqueue().onready(function(b){$("#diff-dialog").acre(A(b))})},this);e[g++]=b[219];return e};e=c.runtime.tfunc_factory("diff_patch(mode, opts)",e,c,void 0,!1);a.diff_patch=e;e.source_microdata=null;g[i++]=b[220];e=c.runtime.tfunc_factory("keyboard_shortcuts()",
function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[221];c.runtime.foreach(this,ui.shortcut.get_shortcuts(),function(e,g){for(var h=1;h;)a[d++]=b[222],a[d++]=mjt.bless(ui.shortcut.get_keys(g.op)),a[d++]=b[223],a[d++]=g.op,a[d++]=b[224],h--;return h?c.runtime._break_token:c.runtime._continue_token});a[d++]=b[225];return a},c,void 0,!1);a.keyboard_shortcuts=e;e.source_microdata=null;g[i++]=b[226];e=c.runtime.tfunc_factory("about_appeditor()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=
b[227];a[d++]=ui.get_store().get_acre_version();a[d++]=b[228];return a},c,void 0,!1);a.about_appeditor=e;e.source_microdata=null;g[i++]=b[229];e=function(a){var d=c.runtime.new_markuplist(),e=0;d[e++]=b[230];var g=c.runtime.uniqueid("onclick");mjt._eventcb[g]=function(){ui.do_hide_overlays()};d[e++]=b[231];d[e++]=c.runtime.make_attr_safe(a,!0);d[e++]=b[232];d[e++]=c.runtime.make_attr_safe(g,!1);d[e++]=b[233];d[e++]=c.runtime.make_attr_safe(a,!1);d[e++]=b[234];return d};e=c.runtime.tfunc_factory("documentation(url)",
e,c,void 0,!1);a.documentation=e;e.source_microdata=null;g[i++]=b[235];return g};a.source_microdata=null;return a}(),info:{file:"//95a.appeditor.www.tags.svn.freebase-site.googlecode.dev/mjt/dialogs.mjt",stringtable:'\n\n<\!-- Dirty files dialog --\>{\n  <h3 class="dialog-title">Abandon Changes?</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <p>You haven\'t saved all the changes you made to the app you currently have open. <b>Abandon these changes?</b></p>\n    </div>\n  </div>\n  <div class="button-bar">\n    <button class="button-main exit">No</button>{\n    <button class="exit" onclick="return mjt._eventcb.{.apply(this, [event])">\n      Yes, abandon changes and switch apps</button>\n  </div>{\n\n\n<\!-- New user dialog --\>{\n  <div id="welcome-panel">\n    <div class="acre-logo">\n      <img alt="Acre: Open Code for Open Data" border="0" height="47" src="/static/95a.appeditor.www.tags.svn.freebase-site.googlecode.dev/img/logo-acre.png" width="211">\n    </div>\n    <div>{\n      <ul>\n        <li><em>See what you can build!</em><br>\n          <small>Check out <a class="exit" href="{/apps" target="_new">the App Directory</a> or <a class="exit" href="{/docs/acre" target="_new">the documentation</a>.</small>\n        </li>\n        <li><em>Ready to go?</em><br>\n          <small></small>{<button id="button-newapp" onclick="return mjt._eventcb.{.apply(this, [event])"><small>Create a New App</small></button> {<button id="button-yourapps" onclick="return mjt._eventcb.{.apply(this, [event])">\n            <span class="button-menu">Choose from Your Apps</span></button>\n        </li>\n      </ul>{\n      <ul>\n        <li><em>Create your own Acre app</em><br>\n          <small>Sign in or Sign Up for Freebase above to get started.</small>\n        </li>\n        <li><em>See what you can build!</em><br>\n          <small>Check out <a class="exit" href="{/apps" target="_new">the App Directory</a> or <a class="exit" href="{/docs/acre" target="_new">the documentation</a>.</small>\n        </li>\n      </ul>{\n    </div>\n  </div>{\n\n\n<\!-- App action dialogs --\>{{\n  <h3 class="dialog-title">Create New App</h3>\n  <div class="dialog-content">\n    <fieldset>\n      <div class="dialog-inset">\n        <div class="dialog-inset-header">\n          <input{ id="new-app-create"{ name="new-app"{ type="radio"{ value="create"{>\n          <label for="new-app-create">Create a new app</label>\n          <input{ id="new-app-clone"{ name="new-app"{ type="radio"{ value="clone"{>\n          <label for="new-app-clone">Clone an existing app</label>\n          <span{ id="new-app-clone-field"{>:\n            <input class="longfield" id="new-app-clone-id" type="text" value="{">\n          </span>\n        </div>\n        <div class="form-row">\n          <label for="new-app-dialog-name">Name your App: </label>\n          <input id="new-app-dialog-name" maxlength="50" type="text" value="{">\n        </div>\n        <div class="form-row wide">\n          <label for="new-app-dialog-key">Choose a URL: </label>\n          <span class="url">http://<input class="shortfield" id="new-app-dialog-key" maxlength="20" minlength="5" size="15" type="text" value="{">.{</span>\n        </div>\n        <div class="form-tip">\n          This URL points to the development version of your code.\n          Later you can choose a shorter Release URL to share with others.\n        </div>\n      </div>\n    </fieldset>\n\n    <div class="cc-callout">\n      <a class="cc-logo" href="http://creativecommons.org/licenses/BSD/"><img alt="CC-BSD" src="/appeditor/cc-bsd.png"></a>\n      <div class="cc-about">\n        All Acre apps are published on Freebase under the\n        <a href="http://creativecommons.org/licenses/BSD/">BSD license</a>\n        so everyone can "view source", clone code, and learn from each other.\n      </div>\n    </div>\n  </div>\n\n  <div class="button-bar">\n    <button class="button-main exit" id="button-new-app">Create</button>\n    <button class="exit">Cancel</button>\n  </div>{{{\n  <h3 class="dialog-title">Delete app \u201c{\u201d?</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <p>\n        Are you sure you want to <b>delete this entire app</b>?\n      </p>\n      <p>\n        This can\'t be undone!\n      </p>\n    </div>\n  </div>\n  <div class="button-bar">{\n    <button class="button-main exit" onclick="return mjt._eventcb.{.apply(this, [event])">Delete App</button>\n    <button class="exit">Cancel</button>\n  </div>{\n\n\n<\!-- File action dialogs --\>{\n  <h3 class="dialog-title">Save File As</h3>\n  <div class="dialog-content" id="applist">\n    <span class="loader-square"></span>\n  </div>{{\n    <div class="dialog-inset">\n      <fieldset>\n        <div class="form-row">\n          <label for="clone-filename">New file name: </label>\n          <input id="clone-filename" type="text" value="{">\n        </div>\n        <div class="form-row">\n          <label for="clone-file-app">In app: </label>\n          <select id="clone-file-app">{\n            <option{ value="{"{>\n              {\n            </option>{\n          </select>\n        </div>\n      </fieldset>\n    </div>\n    <div class="button-bar">\n      <button class="button-main" id="button-clone">Save</button>\n      <button class="exit">Cancel</button>\n    </div>{{{{{{\n  <h3 class="dialog-title">Create a New...</h3>{{{\n    <div>\n      <div class="form-row">\n        <label for="add-file-mimetype">MIME type: </label>\n        <select id="add-file-mimetype">{\n          <option{ value="{"{>\n            {</option>{\n        </select>\n      </div>\n    </div>{{\n\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <fieldset>\n        <div class="form-row">\n          <label for="add-file-name">New file name:</label>\n          <input id="add-file-name" type="text" value="{">\n        </div>\n        <div class="form-row">\n          <label for="add-file-handler">Handler: </label>\n          <select id="add-file-handler">\n            <option selected="" value="">(derived from extension)</option>{\n            <option class="handler-section" id="handler-{" value="{">\n              {\n            </option>{\n          </select>\n        </div>\n        <div class="form-row" id="add-file-mimetype-container"></div>\n      </fieldset>\n    </div>\n  </div>\n  <div class="button-bar">\n    <button class="button-main" id="button-add-file">Create New File</button>\n    <button class="exit">Cancel</button>\n  </div>{{{\n  <h3 class="dialog-title">Delete file \u201c{\u201d?</h3>\n  <div class="dialog-content">\n  <div class="dialog-inset">\n    <p>\n      Are you sure you want to delete the file \u201c<b>{</b>\u201d?\n    </p>\n    <p>\n      This can\'t be undone!\n    </p>\n  </div>\n  </div>\n  <div class="button-bar">{\n    <button class="button-main exit" onclick="return mjt._eventcb.{.apply(this, [event])">Delete File</button>\n    <button class="exit">Cancel</button>\n  </div>{\n\n\n<\!-- Diff/Patch dialogs --\>{{<div{>\n    <div class="revision-list">{{\n      <p>\n        <b>{</b> is based on:\n        <a class="external-link" href="{/view{" target="_blank">{</a>\n      </p>{\n      <table class="item-list">\n        <thead>\n          <tr>\n            <th>Compare</th>{\n            <th class="left">Version</th>{{\n            <th class="left">File</th>{\n            <th class="left">Date</th>{\n            <th>Length</th>{{\n            <th class="left">By</th>{\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td class="center">\n              <span>\n                <input checked="checked" name="diff-from" type="radio" value=""> |\n                <input checked="checked" name="diff-to" type="radio" value="">\n              </span>\n            </td>\n            <td><b><i>Current</i></b></td>{\n            <td></td>{{\n            <td></td>{{\n            <td></td>{{\n            <td></td>{\n          </tr>{\n          <tr>\n            <td class="center">\n              <span>{\n                <input name="diff-from" type="radio" value="{"> |\n                <input name="diff-to" type="radio" value="{">\n              </span>\n            </td>{\n            <td>{</td>{{\n            <td>{</td>{\n            <td>\n              <span class="last_mod">\n                {\n              </span>\n            </td>{\n            <td class="center">{</td>{{\n            <td>{</td>{\n          </tr>{\n        </tbody>\n      </table>\n    </div>{\n  </div>{\n\n  <\!-- Used when the filelist needs to be dynamically updated --\>{<div id="diff-filelist-shim">\n    {\n  </div>{{<div id="diff-filelist">{{{{\n        <span>{\n          <input{ type="checkbox"{>{\n          <a{ href="#0"{>\n            {</a>\n        </span>{\n        <span class="diff-filelist-stub">\n          <i>{</i>\n        </span>{{<span class="file-merge-status">+</span>{<span class="file-merge-status">-</span>{<span class="file-merge-status error-alert">!</span>{<span class="file-merge-status"></span>{{\n      <p>\n        Select: {<a href="#0" onclick="return mjt._eventcb.{.apply(this, [event])">All</a> |{\n        <a href="#0" onclick="return mjt._eventcb.{.apply(this, [event])">None</a>\n      </p>\n      <ul>{\n        <li class="file-list-item" data-fn="{">\n          <span class="diff-filelist-stub">{</span>\n        </li>{\n      </ul>{{\n    <span class="loader-square"></span>{\n    <p>Pick revisions above to see changed files</p>{{\n  </div>{\n\n  <\!-- Used when the diff view needs to be dynamically updated --\>{<div id="diff-view-shim">\n    {\n  </div>{{<div class="diff" id="diff-view">{{{\n    <p>Click on a file or revision to see the changes.</p>{\n  </div>{{<div id="diff-error-view">\n    <div class="message">{</div>\n  </div>{\n\n  <\!-- Main content for each mode --\>{\n    <div class="dialog-content">\n      <fieldset id="apphistory-mode">\n        <div class="radiogroup">\n          <h5>\n            <input checked="checked" name="app-history" type="radio" value="versions">\n            Versions\n          </h5>\n        </div>\n        <div class="radiogroup">\n          <h5>\n            <input name="app-history" type="radio" value="all-changes">\n            Edits\n          </h5>\n        </div>\n      </fieldset>\n      <div class="diff-top">\n        <div id="revision-list-shim"></div>\n      </div>\n      <div class="diff-bottom-short" id="history-diff"></div>{\n        {\n        <div class="diff-area-files">{</div>{\n    </div>\n    <div class="button-bar">{\n      <button class="button-patch patch-apply button-main exit" disabled="disabled">Revert to Right</button>{{\n      <button class="button-patch patch-apply-save exit" disabled="disabled">Revert &amp; Save</button>{\n      <button class="exit">Done</button>\n    </div>{{{\n    <div class="dialog-content">\n      <div class="diff-bottom-tall">\n        {\n        <div class="diff-area-files">{</div>\n      </div>\n    </div>\n    <div class="button-bar">\n      <button class="exit">Done</button>\n    </div>{{\n    <div class="dialog-content">\n      <div class="diff-top">\n        {\n      </div>\n      <div class="diff-bottom-short">\n        <div class="diff-area-full diff-area-short">{</div>\n      </div>\n    </div>\n    <div class="button-bar">{\n      <button class="button-main exit" disabled="disabled" id="button-file-revert">Revert to Right</button>{{\n      <button class="exit" disabled="disabled" id="button-file-revert-save">Revert &amp; Save</button>{        <button class="exit">Done</button>\n    </div>{{\n    <div class="dialog-content">\n      <div class="diff-bottom-tall">\n        {\n        <div class="diff-area-files">{</div>\n      </div>\n    </div>\n    <div class="button-bar">{\n      <button class="button-patch patch-apply button-main exit" disabled="disabled">Apply Selected Changes</button>{{\n      <button class="button-patch patch-apply-save exit" disabled="disabled">Apply &amp; Save</button>{\n      <button class="exit">Done</button>\n    </div>{{{\n    <div class="dialog-content">\n      <div class="diff-top">\n        <p>\n          The saved version of this file has changed since it was loaded, likely because\n          it was edited by another user or by you in another browser or tab.\n        </p>\n        <p>\n          Decide how to proceed or view the details of the conflict.\n        </p>\n      </div>\n      <div class="diff-bottom-short">\n        <div class="diff-area-full">{</div>\n      </div>\n    </div>\n    <div class="button-bar">{\n      <button class="button exit" onclick="return mjt._eventcb.{.apply(this, [event])">Save Anyway</button>\n      <button class="button-main exit">Cancel</button>\n    </div>{\n\n  <\!-- Setup the dialog for all modes --\>{\n\n  <h3 class="dialog-title">{</h3>\n  <div id="diff-dialog">\n    <span class="loader-square"></span>\n  </div>{{\n\n\n<\!-- Help dialogs --\>{\n  <h3 class="dialog-title">App Editor Keyboard Shortcuts</h3>\n  <div class="dialog-content">\n    <div class="dialog-inset">\n      <table>{\n        <tr>\n          <\!-- mjt.bless is being used so HTML entities for system control characters\n              can be printed. These are all declared in ui.shortcut --\>\n          <th>{</th>\n          <td>{</td>\n        </tr>{\n      </table>\n    </div>\n  </div>{{\n  <h3 class="dialog-title">About App Editor</h3>\n  <iframe class="dialog-content" id="dialog-aboutappeditor" src="/appeditor/license.html"></iframe>\n  <div class="button-bar">\n    <b>Version: </b>\n    <span>- {</span>\n  </div>{{{\n  <a class="doc-view-link" href="{" target="_blank" onclick="return mjt._eventcb.{.apply(this, [event])">Open in a new window</a>\n  <iframe class="dialog-content" src="{"></iframe>{'.split("{"),
debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,19,19,19,19,19,19,19,19,23,23,23,23,23,23,23,29,29,29,29,29,29,29,31,31,31,31,31,31,31,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,37,37,37,37,37,38,43,43,43,43,43,43,43,43,43,43,45,45,45,45,48,48,48,48,48,48,48,48,52,52,52,52,52,52,52,53,53,54,55,56,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,66,66,66,66,66,66,66,66,66,66,66,66,66,67,
67,67,72,72,72,72,72,72,72,76,76,76,76,76,76,76,76,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,129,129,129,129,129,130,130,130,130,131,131,131,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,146,146,146,146,146,146,146,146,150,150,150,150,150,150,150,156,156,156,156,156,156,156,156,157,157,158,159,160,161,162,167,167,167,167,
167,167,167,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,173,174,174,174,175,175,175,175,175,175,184,184,184,184,184,184,184,184,184,184,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,200,200,200,200,201,201,201,202,203,204,205,206,207,208,209,210,210,210,210,210,210,211,211,211,211,212,212,213,214,217,217,217,217,217,218,218,219,220,221,221,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,227,227,227,
227,227,227,227,227,230,230,230,230,230,231,231,231,231,231,238,238,238,238,238,238,238,238,238,244,244,244,244,244,244,244,244,244,244,244,244,244,244,245,245,245,246,246,246,246,246,246,258,258,258,258,258,258,258,258,258,258,258,258,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,296,296,296,296,296,297,297,297,297,298,298,298,302,302,302,302,302,302,310,310,310,310,310,310,310,310,310,310,
310,310,310,310,313,313,313,313,313,313,313,313,318,318,318,318,318,318,318,320,320,320,320,320,320,322,322,322,323,324,325,326,327,328,329,330,331,331,332,332,332,332,333,333,333,333,333,333,333,334,334,334,339,339,339,339,339,339,339,339,339,340,340,340,340,340,342,342,342,342,342,342,343,343,343,343,343,355,355,355,355,355,355,355,355,355,355,355,355,355,355,355,355,356,356,356,356,356,357,357,357,357,357,358,358,358,358,358,360,360,360,360,360,363,363,363,363,363,364,365,366,367,368,368,368,369,
369,369,372,372,372,372,372,372,372,372,372,373,373,373,373,373,373,373,376,376,376,376,376,379,379,379,379,379,379,379,379,379,380,380,380,380,380,380,380,381,381,381,381,381,381,385,385,385,385,385,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,438,438,438,438,438,440,440,440,440,440,440,441,441,441,442,442,442,442,442,442,444,444,
444,444,445,445,446,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,460,460,460,461,461,462,462,462,462,462,462,462,462,462,462,462,462,462,462,462,462,462,463,463,463,463,463,463,463,463,463,463,463,463,464,464,464,465,465,465,466,467,467,467,467,468,468,468,469,469,469,470,470,470,471,471,471,472,472,472,473,473,473,474,474,474,474,474,477,477,477,477,477,477,477,477,478,478,478,478,478,478,478,481,481,481,481,481,481,481,481,481,482,482,482,483,483,483,483,483,483,485,485,485,485,486,
487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,548,548,548,548,548,549,549,549,549,550,550,550,551,552,553,554,555,556,557,558,559,560,561,562,562,562,562,562,562,564,564,564,564,564,564,565,565,565,566,566,566,566,566,566,568,568,568,568,569,569,570,570,570,571,572,573,574,574,574,574,574,574,575,575,
575,575,575,575,577,577,577,577,578,578,578,579,579,579,579,579,579,582,582,582,582,582,582,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,602,603,603,603,604,604,604,605,605,605,605,605,608,608,608,608,608,608,608,609,609,609,609,609,612,612,612,612,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,632,632,632,632,633,633,633,633,636,636,636,636,636,637,637,637,643,643,643,643,643,643,643,643,643,643,645,645,645,645,648,648,
648,648,648,651,651,651,651,651,655,655,655,655,655,655,655,655,656,656,656,656,656,658,658,658,658,658,658,660,660,660,660,663,663,663,663,663,664,664,664,668,668,668,668,668,668,668,668,669,669,669,669,669,672,672,672,672,672,672,672,674,674,674,674,675,675,676,677,689,689,689,689,689,689,689,689,689,689,689,689,689,689,693,693,693,693,693,693,693,693,693,693,696,696,696,696,696,696,696,699,699,699,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,
724,725,726,727,728,729,730,732,732,732,732,736,736,736,736,736,736,737,738,739,740,741,743,743,743,743,743,743,746,746,746,746,746,746,746,751,751,751,751,751,751,751,751,754,754,754,754,754,754,755,755,755,756,756,756,756,756,756,760,760,760,760,760,760,760,760,760,762,762,762,762,767,767,767,767,767,767,767,769,769,769,769,769,769,769,771,771,771,771,772,772,772,772,772,772,772,772,772,773,773,773,774,774,774,774,774,774,775,775,775,775],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
(function(){jQuery&&jQuery(window).trigger("acre.template.register",{pkgid:"//95a.appeditor.www.tags.svn.freebase-site.googlecode.dev/mjt/menus.mjt",source:{def:function(){var a=function(){var c=this.tpackage,a=this.exports,b=c._template_fragments,g=c.runtime.new_markuplist(),i=0;g[i++]=b[0];var e=function(a){var d=c.runtime.new_markuplist(),e=0;d[e++]=b[1];var g=ui.get_user(),i=ui.get_recents("apps"),j=Math.min(i.length,10);d[e++]=b[2];g&&(g=c.runtime.uniqueid("onclick"),mjt._eventcb[g]=function(){ui.do_show_dialog("new_app")},
d[e++]=b[3],d[e++]=c.runtime.make_attr_safe(g,!1),d[e++]=b[4]);d[e++]=b[5];g=c.runtime.uniqueid("onclick");mjt._eventcb[g]=function(){ui.do_acre_home_link("/apps")};d[e++]=b[6];d[e++]=c.runtime.make_attr_safe(g,!1);d[e++]=b[7];ui.get_user()?d[e++]=b[8]:(d[e++]=b[9],d[e++]=c.runtime.make_attr_safe($("#nav-signin").attr("href"),!0),d[e++]=b[10]);d[e++]=b[11];if(0<j){d[e++]=b[12];for(g=0;g<j;g++){d[e++]=b[13];var l=i[g],m=l.path.match(/\.dev\.([a-z0-9\.\-]*)\.$/),m=m?m[1]:null;d[e++]=b[14];d[e++]=c.runtime.make_attr_safe(l.path,
!1);d[e++]=b[15];d[e++]=c.runtime.make_attr_safe(ui.get_appeditor_url(l.path),!0);d[e++]=b[16];d[e++]=c.runtime.make_attr_safe(l.path,!1);d[e++]=b[17];d[e++]=l.name;d[e++]=b[18];m&&(d[e++]=b[19],d[e++]=m,d[e++]=b[20]);d[e++]=b[21]}d[e++]=b[22]}else d[e++]=b[23];d[e++]=b[24];c.runtime.ondomready(function(){ui.do_setup_submenu("your-apps-menu-item","yourapps");a&&$("#your-apps-menu-item").trigger("mouseenter")},this);d[e++]=b[25];return d},e=c.runtime.tfunc_factory("apps(auto_open)",e,c,void 0,!1);
a.apps=e;e.source_microdata=null;g[i++]=b[26];e=c.runtime.tfunc_factory("yourapps()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[27];var e=ui.get_store().get_user_apps();ui.get_store().t_refresh_user_apps();a[d++]=b[28];0===e.length?a[d++]=b[29]:(a[d++]=b[30],c.runtime.foreach(this,e,function(e,g){for(var n=1;n;)a[d++]=b[31],a[d++]=c.runtime.make_attr_safe(g.path,!1),a[d++]=b[32],a[d++]=c.runtime.make_attr_safe(ui.get_appeditor_url(g.path),!0),a[d++]=b[33],a[d++]=c.runtime.make_attr_safe(g.path,
!1),a[d++]=b[34],a[d++]=g.name,a[d++]=b[35],n--;return n?c.runtime._break_token:c.runtime._continue_token}),a[d++]=b[36]);a[d++]=b[37];c.runtime.ondomready(function(){var b=$("#menu-yourapps"),c=Math.min(b.height(),$(window).height()-b.offset().top-25);b.height(c).css("visibility","visible");$("#your-apps-loader").hide()},this);a[d++]=b[38];return a},c,void 0,!1);a.yourapps=e;e.source_microdata=null;g[i++]=b[39];e=c.runtime.tfunc_factory("fileactions()",function(){var a=c.runtime.new_markuplist(),
d=0;a[d++]=b[40];var e=ui.get_app(),g=ui.get_file();ui.get_user();e=e?e.is_writable():!1;a[d++]=b[41];e&&(a[d++]=b[42],a[d++]=c.runtime.make_attr_safe(ui.get_file().get_name(),!1),a[d++]=b[43],e&&(a[d++]=b[44]),a[d++]=b[45]);a[d++]=b[46];if(e){a[d++]=b[47];var i=function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[48];this.subst_id&&(a[d++]=c.runtime.bless(' id="'+this.subst_id+'"'));a[d++]=b[49];var f=ui.get_app().get_acre_handlers(),h=[],e;for(e in f)$.inArray(g.get_mime_type(),ui.get_app().get_supported_mime_types(e))!=
-1&&h.push(f[e]);f=ui.get_app().get_supported_mime_types(g.get_acre_handler());a[d++]=b[50];e=h.length>1?{}:{disabled:"disabled"};"id"in e||(a[d++]=b[51]);for(var n in e){a[d++]=" "+n;a[d++]=c.runtime.bless('="');a[d++]=c.runtime.htmlencode(""+e[n]);a[d++]=c.runtime.bless('"')}a[d++]=b[52];c.runtime.foreach(this,h,function(f,h){for(var e=1;e;){a[d++]=b[53];var i=h.key===g.get_acre_handler()?{selected:""}:{};if(!("value"in i)){a[d++]=b[54];a[d++]=c.runtime.make_attr_safe(h.key,false);a[d++]=b[55]}for(var n in i){a[d++]=
" "+n;a[d++]=c.runtime.bless('="');a[d++]=c.runtime.htmlencode(""+i[n]);a[d++]=c.runtime.bless('"')}a[d++]=b[56];a[d++]=h.name;a[d++]=b[57];e--}return e?c.runtime._break_token:c.runtime._continue_token});a[d++]=b[58];h=(g.get_editor_supported_features("mimetype_change"),{});"id"in h||(a[d++]=b[59]);for(var j in h){a[d++]=" "+j;a[d++]=c.runtime.bless('="');a[d++]=c.runtime.htmlencode(""+h[j]);a[d++]=c.runtime.bless('"')}a[d++]=b[60];c.runtime.foreach(this,f,function(f,h){for(var e=1;e;){a[d++]=b[61];
var i=h===g.get_mime_type()?{selected:""}:{};if(!("value"in i)){a[d++]=b[62];a[d++]=c.runtime.make_attr_safe(h,false);a[d++]=b[63]}for(var n in i){a[d++]=" "+n;a[d++]=c.runtime.bless('="');a[d++]=c.runtime.htmlencode(""+i[n]);a[d++]=c.runtime.bless('"')}a[d++]=b[64];a[d++]=h;a[d++]=b[65];e--}return e?c.runtime._break_token:c.runtime._continue_token});a[d++]=b[66];c.runtime.ondomready(function(){$("#file-handler").change(function(){ui.do_file_set_acre_handler($(":selected",this).val());$("#metadata-section").acre(i())});
$("#file-mimetype").change(function(){ui.do_file_set_mime_type($(":selected",this).val());$("#metadata-section").acre(i())})},this);a[d++]=b[67];return a},i=c.runtime.tfunc_factory("metadata_section()",i,c,void 0,!1);i.source_microdata=null;a[d++]=b[68];a[d++]=i();a[d++]=b[69]}else a[d++]=b[70],a[d++]=g.get_acre_handler(),a[d++]=b[71],a[d++]=g.get_mime_type(),a[d++]=b[72];a[d++]=b[73];var j=c.runtime.uniqueid("onclick");mjt._eventcb[j]=function(){ui.do_file_check()};a[d++]=b[74];var l=1===ui.get_file_check_options().useful?
{}:{disabled:"disabled"};"title"in l||(a[d++]=b[75],a[d++]=c.runtime.make_attr_safe(mjt.bless(ui.shortcut.get_keys("Check Syntax")),!1),a[d++]=b[76]);"onclick"in l||(a[d++]=b[77],a[d++]=c.runtime.make_attr_safe(j,!1),a[d++]=b[78]);for(var m in l)a[d++]=" "+m,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+l[m]),a[d++]=c.runtime.bless('"');a[d++]=b[79];if(e){m=c.runtime.uniqueid("onclick");mjt._eventcb[m]=function(){ui.do_file_revert_to_saved()};a[d++]=b[80];j=!g.is_dirty()?{disabled:"disabled"}:
{};"class"in j||(a[d++]=b[81]);"onclick"in j||(a[d++]=b[82],a[d++]=c.runtime.make_attr_safe(m,!1),a[d++]=b[83]);for(var o in j)a[d++]=" "+o,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+j[o]),a[d++]=c.runtime.bless('"');a[d++]=b[84]}a[d++]=b[85];o=c.runtime.uniqueid("onclick");mjt._eventcb[o]=function(){ui.do_show_dialog("diff_patch",["file_history",ui.get_file().get_name()])};a[d++]=b[86];a[d++]=c.runtime.make_attr_safe(o,!1);a[d++]=b[87];o=c.runtime.uniqueid("onclick");mjt._eventcb[o]=
function(){ui.do_show_dialog("save_file_as")};a[d++]=b[88];m=ui.get_user()?{}:{disabled:"disabled"};"onclick"in m||(a[d++]=b[89],a[d++]=c.runtime.make_attr_safe(o,!1),a[d++]=b[90]);for(var p in m)a[d++]=" "+p,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+m[p]),a[d++]=c.runtime.bless('"');a[d++]=b[91];p=c.runtime.uniqueid("onclick");mjt._eventcb[p]=function(){ui.do_show_dialog("delete_file",[ui.get_file().get_name()])};a[d++]=b[92];e=e?{}:{disabled:"disabled"};"onclick"in e||(a[d++]=
b[93],a[d++]=c.runtime.make_attr_safe(p,!1),a[d++]=b[94]);for(var q in e)a[d++]=" "+q,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+e[q]),a[d++]=c.runtime.bless('"');a[d++]=b[95];c.runtime.ondomready(function(){ui.watch_inputs("name",{inputs:{"file-name":ui.get_file().get_name()},change:function(b){return b["file-name"]!==""?b:false},submit:function(b){ui.do_file_move(b["file-name"])}})},this);a[d++]=b[96];return a},c,void 0,!1);a.fileactions=e;e.source_microdata=null;g[i++]=b[97];e=
c.runtime.tfunc_factory("editoroptions()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[98];var e=!1;ui.get_store();var g=ui.get_app(),i=ui.get_file();ui.get_user()&&g.is_writable();a[d++]=b[99];i.get_editor_supported_features("hotswap")&&(a[d++]=b[100],e=!0,a[d++]=b[101],c.runtime.foreach(this,EDITORS,function(e,g){for(var i=1;i;){if(g.supports.hotswap){a[d++]=b[102];var n=ui.get_editor_prefs("texteditor")===e?{checked:"checked"}:{};"id"in n||(a[d++]=b[103],a[d++]=c.runtime.make_attr_safe(e,
!1),a[d++]=b[104]);"name"in n||(a[d++]=b[105]);"type"in n||(a[d++]=b[106]);"value"in n||(a[d++]=b[107],a[d++]=c.runtime.make_attr_safe(e,!1),a[d++]=b[108]);for(var j in n)a[d++]=" "+j,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+n[j]),a[d++]=c.runtime.bless('"');a[d++]=b[109];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[110];a[d++]=g.name;a[d++]=b[111]}i--}return i?c.runtime._break_token:c.runtime._continue_token}),a[d++]=b[112]);a[d++]=b[113];if(i.get_editor_supported_features("margin")){a[d++]=
b[114];e=!0;a[d++]=b[115];g=ui.get_editor_prefs("margin")?{checked:"checked"}:{};"id"in g||(a[d++]=b[116]);"name"in g||(a[d++]=b[117]);"type"in g||(a[d++]=b[118]);"value"in g||(a[d++]=b[119]);for(var j in g)a[d++]=" "+j,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+g[j]),a[d++]=c.runtime.bless('"');a[d++]=b[120];j=ui.get_editor_prefs("margin")?{}:{checked:"checked"};"id"in j||(a[d++]=b[121]);"name"in j||(a[d++]=b[122]);"type"in j||(a[d++]=b[123]);"value"in j||(a[d++]=b[124]);for(var l in j)a[d++]=
" "+l,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+j[l]),a[d++]=c.runtime.bless('"');a[d++]=b[125]}a[d++]=b[126];if(i.get_editor_supported_features("softwrap")){a[d++]=b[127];e=!0;a[d++]=b[128];l=ui.get_editor_prefs("softwrap")?{checked:"checked"}:{};"id"in l||(a[d++]=b[129]);"name"in l||(a[d++]=b[130]);"type"in l||(a[d++]=b[131]);"value"in l||(a[d++]=b[132]);for(var m in l)a[d++]=" "+m,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+l[m]),a[d++]=c.runtime.bless('"');a[d++]=
b[133];m=ui.get_editor_prefs("softwrap")?{}:{checked:"checked"};"id"in m||(a[d++]=b[134]);"name"in m||(a[d++]=b[135]);"type"in m||(a[d++]=b[136]);"value"in m||(a[d++]=b[137]);for(var o in m)a[d++]=" "+o,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+m[o]),a[d++]=c.runtime.bless('"');a[d++]=b[138]}a[d++]=b[139];if(i.get_editor_supported_features("codeassist")){a[d++]=b[140];e=!0;a[d++]=b[141];o=ui.get_editor_prefs("dotTrigger")?{checked:"checked"}:{};"id"in o||(a[d++]=b[142]);"name"in
o||(a[d++]=b[143]);"type"in o||(a[d++]=b[144]);"value"in o||(a[d++]=b[145]);for(var p in o)a[d++]=" "+p,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+o[p]),a[d++]=c.runtime.bless('"');a[d++]=b[146];p=ui.get_editor_prefs("dotTrigger")?{}:{checked:"checked"};"id"in p||(a[d++]=b[147]);"name"in p||(a[d++]=b[148]);"type"in p||(a[d++]=b[149]);"value"in p||(a[d++]=b[150]);for(var q in p)a[d++]=" "+q,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+p[q]),a[d++]=c.runtime.bless('"');
a[d++]=b[151]}a[d++]=b[152];if(i.get_editor_supported_features("emql")){a[d++]=b[153];e=!0;a[d++]=b[154];i=ui.get_editor_prefs("emql")?{checked:"checked"}:{};"id"in i||(a[d++]=b[155]);"name"in i||(a[d++]=b[156]);"type"in i||(a[d++]=b[157]);"value"in i||(a[d++]=b[158]);for(var s in i)a[d++]=" "+s,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+i[s]),a[d++]=c.runtime.bless('"');a[d++]=b[159];s=ui.get_editor_prefs("emql")?{}:{checked:"checked"};"id"in s||(a[d++]=b[160]);"name"in s||(a[d++]=
b[161]);"type"in s||(a[d++]=b[162]);"value"in s||(a[d++]=b[163]);for(var y in s)a[d++]=" "+y,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+s[y]),a[d++]=c.runtime.bless('"');a[d++]=b[164]}a[d++]=b[165];e||(a[d++]=b[166]);a[d++]=b[167];c.runtime.ondomready(function(){$("#menu-editoroptions input[type='radio']").click(function(){var b=$(this).attr("name").split("edopt-")[1],c={};c[b]=$(this).val();ui.set_editor_prefs(c);ui.do_refresh_file();ui.do_hide_overlays()})},this);a[d++]=b[168];
return a},c,void 0,!1);a.editoroptions=e;e.source_microdata=null;g[i++]=b[169];e=c.runtime.tfunc_factory("help()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[170];var e=c.runtime.uniqueid("onclick");mjt._eventcb[e]=function(){return ui.do_show_dialog("keyboard_shortcuts")};a[d++]=b[171];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[172];e=c.runtime.uniqueid("onclick");mjt._eventcb[e]=function(){return ui.do_show_dialog("documentation",[ui.get_store().get_freebase_url()+"/appeditor/docs/apis"])};
a[d++]=b[173];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[174];e=c.runtime.uniqueid("onclick");mjt._eventcb[e]=function(){return ui.do_show_dialog("documentation",[ui.get_store().get_freebase_url()+"/appeditor/docs/templates"])};a[d++]=b[175];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[176];e=c.runtime.uniqueid("onclick");mjt._eventcb[e]=function(){return ui.do_show_dialog("about_appeditor")};a[d++]=b[177];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[178];c.runtime.ondomready(function(){$("#help-menu-content a").click(function(){ui.do_hide_overlays()})},
this);a[d++]=b[179];return a},c,void 0,!1);a.help=e;e.source_microdata=null;g[i++]=b[180];e=c.runtime.tfunc_factory("appsettings()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[181];var e=ui.get_app().is_writable();a[d++]=b[182];var g=c.runtime.uniqueid("onclick");mjt._eventcb[g]=function(){ui.do_hide_overlays()};a[d++]=b[183];a[d++]=c.runtime.make_attr_safe(g,!1);a[d++]=b[184];e&&(a[d++]=b[185]);a[d++]=b[186];ui.get_app().is_remote()?(a[d++]=b[196],ui.get_user()&&(e=c.runtime.uniqueid("onclick"),
mjt._eventcb[e]=function(){ui.do_show_dialog("new_app",[!0])},a[d++]=b[197],a[d++]=c.runtime.make_attr_safe(e,!1),a[d++]=b[198]),a[d++]=b[199]):(a[d++]=b[187],ui.get_app().is_author()&&(a[d++]=b[188]),a[d++]=b[189],ui.get_user()&&(g=c.runtime.uniqueid("onclick"),mjt._eventcb[g]=function(){ui.do_show_dialog("new_app",[!0])},a[d++]=b[190],a[d++]=c.runtime.make_attr_safe(g,!1),a[d++]=b[191]),a[d++]=b[192],e&&(e=c.runtime.uniqueid("onclick"),mjt._eventcb[e]=function(){ui.do_show_dialog("delete_app")},
a[d++]=b[193],a[d++]=c.runtime.make_attr_safe(e,!1),a[d++]=b[194]),a[d++]=b[195]);a[d++]=b[200];e=c.runtime.uniqueid("onclick");mjt._eventcb[e]=function(){ui.do_hide_overlays()};a[d++]=b[201];a[d++]=c.runtime.make_attr_safe(e,!1);a[d++]=b[202];c.runtime.ondomready(function(){$("#button-appsettings").addClass("button-open");$("#settings-tabs").tabs("#settings-tab-content > div",{api:!0,initialIndex:0,onBeforeClick:function(b,c){var a=$(this.getPanes()[c]).attr("id");setTimeout(function(){$("#"+a).acre(fb.acre.apps.appeditor+
"/mjt/menus.mjt",a)},0)}});$("#app-general-listing").click(function(){window.open(ui.get_app().get_edit_url());return!1})},this);a[d++]=b[203];return a},c,void 0,!1);a.appsettings=e;e.source_microdata=null;g[i++]=b[204];e=c.runtime.tfunc_factory("app_general()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[205];this.subst_id&&(a[d++]=c.runtime.bless(' id="'+this.subst_id+'"'));a[d++]=b[206];var e=ui.get_app().is_writable();a[d++]=b[207];if(e){a[d++]=b[208];var g=c.runtime.uniqueid("onclick");
mjt._eventcb[g]=function(){ui.do_app_add_version($("#add-version-key").val())};a[d++]=b[209];a[d++]=c.runtime.make_attr_safe(g,!1);a[d++]=b[210];ui.get_app().get_versions().length&&(g=c.runtime.uniqueid("onclick"),mjt._eventcb[g]=function(){ui.do_show_dialog("diff_patch",["app_diff"])},a[d++]=b[211],a[d++]=c.runtime.make_attr_safe(g,!1),a[d++]=b[212]);a[d++]=b[213]}a[d++]=b[214];a[d++]=j();a[d++]=b[215];var i=ui.get_app(),g=i.get_name(),l=i.get_base_url().replace("http://"+g,"").replace("."+i.get_store().get_acre_host(),
"");a[d++]=b[216];e?(a[d++]=b[217],a[d++]=c.runtime.make_attr_safe(g,!1),a[d++]=b[218],a[d++]=l,a[d++]=b[219],a[d++]=i.get_acre_host(),a[d++]=b[220]):(a[d++]=b[221],a[d++]=c.runtime.make_attr_safe(i.get_base_url(),!0),a[d++]=b[222],a[d++]=i.get_base_url(),a[d++]=b[223]);a[d++]=b[224];if(e)c.runtime.ondomready(function(){ui.watch_inputs("devurl",{inputs:{devurl:i.get_name()},update_on_submit:true,submit:function(b){ui.do_app_move("//"+b.devurl+l)}})},this);a[d++]=b[225];a[d++]=m();a[d++]=b[226];return a},
c,void 0,!1);a.app_general=e;e.source_microdata=null;g[i++]=b[227];var m=function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[228];for(var e=ui.get_app(),g=e.is_writable(),i=e.get_hosts(),j=e.get_released_version()||"current",l=/([^.]*)\.freebaseapps\.com$/,m=null,o=0;o<i.length;o++){var p=i[o];if(p.version==j&&(p=l.exec(p.host))){m=p[1];break}}a[d++]=b[229];if(g){a[d++]=b[230];a[d++]=c.runtime.make_attr_safe(m||"",!1);a[d++]=b[231];a[d++]=e.get_acre_host();a[d++]=b[232];m?a[d++]=b[233]:a[d++]=
b[234];a[d++]=b[235];if(m?1<i.length:0<i.length)a[d++]=b[236],c.runtime.foreach(this,i,function(e,g){for(var i=1;i;)g.host!==m+".freebaseapps.com"&&(a[d++]=b[237],a[d++]=c.runtime.make_attr_safe(g.host,!1),a[d++]=b[238],a[d++]=g.host,a[d++]=b[239],g.version!=j&&(a[d++]=b[240],a[d++]=g.version,a[d++]=b[241]),a[d++]=b[242]),i--;return i?c.runtime._break_token:c.runtime._continue_token}),a[d++]=b[243];a[d++]=b[244];c.runtime.ondomready(function(){ui.watch_inputs("puburl",{inputs:{puburl:$("#puburl").val()},
text_delay:1E3,update_on_submit:!0,change:function(b){$("#button-puburl").attr("disabled","disabled");$("#puburl-status").removeClass().html("").addClass("puburl-wait");ui.get_store().XhrGet("check_host_availability",{host:b.puburl}).enqueue().onready(function(b){$("#button-puburl").removeAttr("disabled");$("#puburl-status").removeClass().addClass("puburl-success").html(b.message)}).onerror(function(b,a){$("#puburl-status").removeClass().addClass("puburl-fail").html(a)})},submit:function(b){$("#puburl-status").removeClass().empty();
ui.do_app_set_host(b.puburl)}})},this);a[d++]=b[245]}else a[d++]=b[246],m&&(a[d++]=b[247],m&&(a[d++]=b[248],a[d++]=c.runtime.make_attr_safe(m+"."+ui.get_app().get_acre_host(),!1),a[d++]=b[249],a[d++]=m,a[d++]=b[250],a[d++]=ui.get_app().get_acre_host(),a[d++]=b[251]),a[d++]=b[252]),a[d++]=b[253];a[d++]=b[254];return a},m=c.runtime.tfunc_factory("app_hosts_list()",m,c,void 0,!1);a.app_hosts_list=m;m.source_microdata=null;g[i++]=b[255];var j=function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[256];
for(var e=ui.get_app(),g=e.get_path(),i=e.is_writable(),j=e.get_released_version(),l=j?g.replace("//","//"+j+"."):g,m=e.get_versions(),o=/(\d+)/,p=1,q=0;q<m.length;q++){var s=o.exec(m[q].name);s&&s.length&&(s=parseInt(s[1],10),p<=s&&(p=s+1))}var y=!0;a[d++]=b[257];if(j||i)a[d++]=b[258];a[d++]=b[259];i&&(a[d++]=b[260]);a[d++]=b[261];i&&(a[d++]=b[262]);a[d++]=b[263];if(j||i){a[d++]=b[264];if(i){a[d++]=b[265];o=l==g?{checked:"checked"}:{};"name"in o||(a[d++]=b[266]);"type"in o||(a[d++]=b[267]);"value"in
o||(a[d++]=b[268]);for(var z in o)a[d++]=" "+z,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+o[z]),a[d++]=c.runtime.bless('"');a[d++]=b[269]}else a[d++]=b[270],l==g&&(a[d++]=b[271]),a[d++]=b[272];a[d++]=b[273]}a[d++]=b[274];a[d++]=c.runtime.make_attr_safe(g,!1);a[d++]=b[275];a[d++]=c.runtime.make_attr_safe(ui.get_appeditor_url(g),!0);a[d++]=b[276];i&&(a[d++]=b[277]);a[d++]=b[278];a[d++]=c.runtime.make_attr_safe(e.get_base_url(),!0);a[d++]=b[279];i&&(a[d++]=b[280]);a[d++]=b[281];c.runtime.foreach(this,
m,function(m,o){for(var r=1;r;){a[d++]=b[282];var p=g.replace("//","//"+o.name+"."),q=e.get_base_url().replace("//","//"+o.name+"."),s=!1;/\d+/.test(o.name)?y&&(s=!0,y=!1):s=!0;a[d++]=b[283];if(j||i){a[d++]=b[284];if(i){a[d++]=b[285];var w=l!=p?{}:{checked:"checked"};"name"in w||(a[d++]=b[286]);"type"in w||(a[d++]=b[287]);"value"in w||(a[d++]=b[288],a[d++]=c.runtime.make_attr_safe(o.name,!1),a[d++]=b[289]);for(var z in w)a[d++]=" "+z,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+w[z]),
a[d++]=c.runtime.bless('"');a[d++]=b[290]}else a[d++]=b[291],l==p&&(a[d++]=b[292]),a[d++]=b[293];a[d++]=b[294]}a[d++]=b[295];a[d++]=c.runtime.make_attr_safe(p,!1);a[d++]=b[296];a[d++]=c.runtime.make_attr_safe(ui.get_appeditor_url(p),!0);a[d++]=b[297];a[d++]=o.name;a[d++]=b[298];o.as_of_time&&(a[d++]=b[299],a[d++]=ui.get_relative_timestamp(o.as_of_time),a[d++]=b[300],i&&s&&(a[d++]=b[301],s=c.runtime.uniqueid("onclick"),mjt._eventcb[s]=function(){ui.do_app_add_version(o.name,"__now__")},a[d++]=b[302],
a[d++]=c.runtime.make_attr_safe(s,!1),a[d++]=b[303]),a[d++]=b[304]);a[d++]=b[305];if(i){a[d++]=b[306];s="http://www.sandbox-freebase.com"==o.service_url?{checked:"checked"}:{};"class"in s||(a[d++]=b[307]);"key"in s||(a[d++]=b[308],a[d++]=c.runtime.make_attr_safe(o.name,!1),a[d++]=b[309]);"type"in s||(a[d++]=b[310]);for(var E in s)a[d++]=" "+E,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+s[E]),a[d++]=c.runtime.bless('"');a[d++]=b[311]}a[d++]=b[312];a[d++]=c.runtime.make_attr_safe(q,
!0);a[d++]=b[313];i&&(a[d++]=b[314],l!=p&&(a[d++]=b[315],a[d++]=c.runtime.make_attr_safe(o.name,!1),a[d++]=b[316]),a[d++]=b[317]);a[d++]=b[318];r--}return r?c.runtime._break_token:c.runtime._continue_token});a[d++]=b[319];if(i)c.runtime.ondomready(function(){$("#add-version-key").val(p);$(".remove-version-button").click(function(){$(this).parents("tr").fadeOut("slow");ui.do_app_remove_version($(this).attr("key"));return!1});$("input[name='version-release']").click(function(){var b=$(this).val();ui.do_app_set_release(b);
return!1});$(".version-service-url").click(function(){service_url=$(this).attr("checked")?"http://www.sandbox-freebase.com":!1;ui.do_app_add_version($(this).attr("key"),null,service_url)})},this);a[d++]=b[320];return a},j=c.runtime.tfunc_factory("app_versions_list()",j,c,void 0,!1);a.app_versions_list=j;j.source_microdata=null;g[i++]=b[321];e=c.runtime.tfunc_factory("app_changes()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[322];this.subst_id&&(a[d++]=c.runtime.bless(' id="'+this.subst_id+
'"'));a[d++]=b[323];var e=ui.get_app();e.is_writable();var g=ui.id_to_path("/freebase/apps/seed");a[d++]=b[324];var i=c.runtime.uniqueid("onclick");mjt._eventcb[i]=function(){ui.do_show_dialog("diff_patch",["app_history"])};a[d++]=b[325];a[d++]=c.runtime.make_attr_safe(i,!1);a[d++]=b[326];if(!e.get_parent()&&!e.get_children().length||e.get_parent()&&e.get_parent().path===g)a[d++]=b[327];a[d++]=b[328];e.get_parent()&&e.get_parent().path!==g&&(a[d++]=b[329],a[d++]=c.runtime.make_attr_safe(e.get_parent().path,
!1),a[d++]=b[330],a[d++]=e.get_parent().path,a[d++]=b[331],a[d++]=c.runtime.make_attr_safe(e.get_parent().path,!1),a[d++]=b[332]);a[d++]=b[333];e.get_children().length&&(a[d++]=b[334],c.runtime.foreach(this,e.get_children(),function(e,g){for(var i=1;i;){a[d++]=b[335];a[d++]=c.runtime.make_attr_safe(g.path,false);a[d++]=b[336];a[d++]=g.path;a[d++]=b[337];a[d++]=c.runtime.make_attr_safe(g.path,false);a[d++]=b[338];i--}return i?c.runtime._break_token:c.runtime._continue_token}),a[d++]=b[339]);a[d++]=
b[340];c.runtime.ondomready(function(){$("#merge-app").suggest({type:"/freebase/apps/acre_app",filter:"(any type:/freebase/apps/acre_app)"}).bind("fb-select",function(b,a){var c=ui.id_to_path(a.id);$(this).val(c);$("#button-merge").removeAttr("disabled").val(c)});$(".button-get-changes").click(function(){ui.do_show_dialog("diff_patch",["merge_changes",{appid:$(this).val()}])})},this);a[d++]=b[341];return a},c,void 0,!1);a.app_changes=e;e.source_microdata=null;g[i++]=b[342];e=c.runtime.tfunc_factory("app_authors()",
function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[343];this.subst_id&&(a[d++]=c.runtime.bless(' id="'+this.subst_id+'"'));a[d++]=b[344];ui.get_app().is_writable()?(a[d++]=b[345],a[d++]=l(ui.get_app().get_authors()),a[d++]=b[346],c.runtime.ondomready(function(){$("#add-author-input").suggest({type:"/type/user",filter:"(any type:/type/user)"}).bind("fb-select",function(b,a){$(this).val("");ui.do_app_add_author(a.name)}).focus()},this),a[d++]=b[347]):(a[d++]=b[348],a[d++]=l(ui.get_app().get_authors()),
a[d++]=b[349]);a[d++]=b[350];return a},c,void 0,!1);a.app_authors=e;e.source_microdata=null;g[i++]=b[351];var l=function(a){var d=c.runtime.new_markuplist(),e=0;d[e++]=b[352];var g,i=0,j;for(j in a)i++;g=1==i;d[e++]=b[353];c.runtime.foreach(this,a,function(a,h){for(var i=1;i;)d[e++]=b[354],d[e++]=c.runtime.make_attr_safe(h.get_view_url(),!0),d[e++]=b[355],d[e++]=c.runtime.make_attr_safe(h.get_full_name()||h.get_name(),!1),d[e++]=b[356],d[e++]=c.runtime.make_attr_safe(h.get_image_url(),!1),d[e++]=
b[357],d[e++]=c.runtime.make_attr_safe(h.get_view_url(),!0),d[e++]=b[358],d[e++]=c.runtime.make_attr_safe(h.get_full_name()||h.get_name(),!1),d[e++]=b[359],d[e++]=h.get_name(),d[e++]=b[360],!g&&(ui.get_app().is_writable()&&h.is_admin())&&(d[e++]=b[361],d[e++]=c.runtime.make_attr_safe(h.get_name(),!1),d[e++]=b[362]),d[e++]=b[363],i--;return i?c.runtime._break_token:c.runtime._continue_token});d[e++]=b[364];c.runtime.ondomready(function(){$("#add-author-input").focus();$(".remove-user-button").click(function(){$(this).parents("tr").fadeOut("slow");
ui.do_app_remove_author($(this).attr("user"));return!1})},this);d[e++]=b[365];return d},l=c.runtime.tfunc_factory("app_authors_list(user_dict)",l,c,void 0,!1);a.app_authors_list=l;l.source_microdata=null;g[i++]=b[366];e=c.runtime.tfunc_factory("app_services()",function(){var a=c.runtime.new_markuplist(),d=0;a[d++]=b[367];this.subst_id&&(a[d++]=c.runtime.bless(' id="'+this.subst_id+'"'));a[d++]=b[368];var e=ui.get_app().get_write_user(),g=e&&e.get_name()==ui.get_user().get_name()?!0:!1,i={};e&&(i.checked=
"checked",g||(i.disabled="disabled"));a[d++]=b[369];(g=this.tasks&&this.tasks.apikeys)||(g=this.mktask("apikeys",ui.get_app().t_get_apikeys()));a[d++]=b[370];a[d++]=b[371];switch(g.state){case "ready":a[d++]=b[372];g=g.result.keys;a[d++]=b[373];a[d++]=q(g);a[d++]=b[374];break;case "wait":a[d++]=b[375];break;case "error":a[d++]=b[376]}a[d++]=b[377];"id"in i||(a[d++]=b[378]);"type"in i||(a[d++]=b[379]);for(var j in i)a[d++]=" "+j,a[d++]=c.runtime.bless('="'),a[d++]=c.runtime.htmlencode(""+i[j]),a[d++]=
c.runtime.bless('"');a[d++]=b[380];a[d++]=e?e.get_name():ui.get_user().get_name();a[d++]=b[381];a[d++]=c.runtime.make_attr_safe(fb.h.build_url(ui.get_app().get_base_url(),"/acre/account/signin",[["provider","freebase_writeuser"],["onsucceed",window.location.href]]),!0);a[d++]=b[382];c.runtime.ondomready(function(){$("#permission-writeuser").change(function(){ui.do_app_set_writeuser(!!$(this).attr("checked"))})},this);a[d++]=b[383];return a},c,!0,!1);a.app_services=e;e.source_microdata=null;g[i++]=
b[384];var q=function(a){var d=c.runtime.new_markuplist(),e=0;d[e++]=b[385];a.length?(d[e++]=b[386],c.runtime.foreach(this,a,function(a,g){for(var h=1;h;)d[e++]=b[387],d[e++]=g.key_id,d[e++]=b[388],d[e++]=g.token,d[e++]=b[389],d[e++]=g.secret,d[e++]=b[390],"freebase.com"!==g.key_id&&(d[e++]=b[391],d[e++]=c.runtime.make_attr_safe(g.key_id,!1),d[e++]=b[392]),d[e++]=b[393],h--;return h?c.runtime._break_token:c.runtime._continue_token}),d[e++]=b[394]):d[e++]=b[395];d[e++]=b[396];c.runtime.ondomready(function(){ui.watch_inputs("apikey-add",
{inputs:{"apikey-name":null,"apikey-token":null,"apikey-secret":null},submit:function(a){ui.do_app_add_apikey(a["apikey-name"],a["apikey-token"],a["apikey-secret"])}});$(".remove-key-button").click(function(){$(this).parents("tr").fadeOut("slow");ui.do_app_remove_apikey($(this).attr("key"));return false})},this);d[e++]=b[397];return d},q=c.runtime.tfunc_factory("app_apikeys_list(keys)",q,c,void 0,!1);a.app_apikeys_list=q;q.source_microdata=null;g[i++]=b[398];return g};a.source_microdata=null;return a}(),
info:{file:"//95a.appeditor.www.tags.svn.freebase-site.googlecode.dev/mjt/menus.mjt",stringtable:'\n\n<\!-- Your Apps Menu --\>{{{\n  <div class="menu-section selectable" onclick="return mjt._eventcb.{.apply(this, [event])">\n    New App...\n  </div>{{\n  <div class="menu-section selectable" onclick="return mjt._eventcb.{.apply(this, [event])">\n    App Directory...\n  </div>{\n  <div class="menu-section selectable" id="your-apps-menu-item">\n    <div id="your-apps-opener"><img id="your-apps-loader" src="/static/95a.appeditor.www.tags.svn.freebase-site.googlecode.dev/img/loader-tinyorange.gif" style="display:none;"></div>\n    Your Apps\n  </div>{\n  <div class="menu-section">\n    <h3>Your Apps</h3>\n    <a href="{" title="Sign in to your Freebase account">Sign in</a> to show your apps here.\n  </div>{\n\n  <div class="menu-section last">\n    <h3>Recent Apps</h3>{\n    <ul>{\n      <li>{\n        <a apppath="{" class="app-link" href="{" title="{">{</a>{\n        <em>on {</em>{\n      </li>{\n    </ul>{\n    <div>If you work on multiple apps, recently opened ones will appear here.</div>{\n  </div>{{{{{\n    <p class="menu-message">Apps you create or clone will appear here.</p>{\n    <ul>{\n      <li>\n        <a apppath="{" class="app-link" href="{" title="{">\n          {\n        </a>\n      </li>{\n    </ul>{{{\n\n\n<\!-- File Menu --\>{{{\n  <div class="menu-section">\n    <h3>Name</h3>\n    <fieldset class="center">\n      <label for="file-name">File name </label>\n      <input class="form-textbox" id="file-name" type="text" value="{">{\n      <button class="exit" disabled="disabled" id="button-name">Rename</button>{\n    </fieldset>\n  </div>{{\n  <div class="menu-section">\n    <h3>Type</h3>\n    <fieldset id="fieldset-metadata">{<div{>{\n        <div class="form-row">\n          <label for="file-handler">Acre type </label>\n          <select{ id="file-handler"{>\n            <option selected="" value="">(derived from extension)</option>{\n            <option{ value="{"{>\n                {\n            </option>{\n          </select>\n        </div>\n        <div class="form-row">\n          <label for="file-mimetype">MIME type </label>\n          <select{ id="file-mimetype"{>{\n            <option{ value="{"{>\n              {\n            </option>{\n          </select>\n        </div>{\n      </div>{\n      <div id="metadata-section">{</div>\n    </fieldset>\n  </div>{\n  <div class="menu-section">\n    <h3>Type</h3>\n    <fieldset id="fieldset-metadata">\n      <div class="form-row">\n        <label for="file-handler">Acre type:</label>\n        <span class="form-static">{</span>\n      </div>\n      <div class="form-row">\n        <label for="file-mimetype">MIME type: </label>\n        <span class="form-static">{</span>\n      </div>\n    </fieldset>\n  </div>{\n  <div class="menu-section">\n    <h3>Validate</h3>\n    <\!-- mjt.bless is being used so HTML entities for system control characters\n        can be printed. These are all declared in ui.shortcut --\>{\n    <button{ title="{"{ onclick="return mjt._eventcb.{.apply(this, [event])"{>\n      Check Syntax</button>\n  </div>\n  <div class="menu-section">\n    <h3>History</h3>\n    <fieldset>{\n      <button{ class="exit"{ onclick="return mjt._eventcb.{.apply(this, [event])"{>\n        Revert to Saved</button>{{\n      <button onclick="return mjt._eventcb.{.apply(this, [event])">\n        Review Older Versions</button>\n    </fieldset>\n  </div>\n  <div class="menu-section last">\n    <h3>Actions</h3>{\n    <button{ onclick="return mjt._eventcb.{.apply(this, [event])"{>\n      Clone this File</button>{\n    <button{ onclick="return mjt._eventcb.{.apply(this, [event])"{>\n      Delete this File</button>\n  </div>{{\n\n\n<\!-- Editor Menu --\>{{{\n  <div class="menu-section">{\n    <h3>Text Editor</h3>\n    <fieldset>{\n      <div class="line">\n        <input{ id="edopt-texteditor-{"{ name="edopt-texteditor"{ type="radio"{ value="{"{>\n        <label for="edopt-texteditor-{">{</label><br>\n      </div>{\n    </fieldset>\n  </div>{{\n  <div class="menu-section">{\n    <h3>Line Numbers</h3>\n    <fieldset>\n      <input{ id="edopt-margin-y"{ name="edopt-margin"{ type="radio"{ value="1"{> <label for="edopt-margin-y">yes</label>\n      <input{ id="edopt-margin-n"{ name="edopt-margin"{ type="radio"{ value="0"{> <label for="edopt-margin-y">no</label>\n    </fieldset>\n  </div>{{\n  <div class="menu-section">{\n    <h3>Soft Wrap</h3>\n    <fieldset>\n      <input{ id="edopt-softwrap-y"{ name="edopt-softwrap"{ type="radio"{ value="1"{> <label for="edopt-softwrap-y">yes</label>\n      <input{ id="edopt-softwrap-n"{ name="edopt-softwrap"{ type="radio"{ value="0"{> <label for="edopt-softwrap-n">no</label>\n    </fieldset>\n  </div>{{\n  <div class="menu-section last">{\n    <h3>Automatic Code Assist</h3>\n    <fieldset>\n      <input{ id="edopt-dotTrigger-y"{ name="edopt-dotTrigger"{ type="radio"{ value="1"{> <label for="edopt-dotTrigger-y">yes</label>\n      <input{ id="edopt-dotTrigger-n"{ name="edopt-dotTrigger"{ type="radio"{ value="0"{> <label for="edopt-dotTrigger-n">no</label>\n    </fieldset>\n  </div>{{\n  <div class="menu-section last">{\n    <h3>Enable MQL Extensions (experimental)</h3>\n    <fieldset>\n      <input{ id="edopt-emql-y"{ name="edopt-emql"{ type="radio"{ value="1"{> <label for="edopt-emql-y">yes</label>\n      <input{ id="edopt-emql-n"{ name="edopt-emql"{ type="radio"{ value="0"{> <label for="edopt-emql-n">no</label>\n    </fieldset>\n  </div>{{\n  <div>\n    <p style="margin:10px">\n      No configuration options for this file type.\n    </p>\n  </div>{{{\n\n\n<\!-- Help Menu --\>{\n  <div id="help-menu-content">\n  <div class="menu-section">\n    <h3>Documentation</h3>\n    <ul>\n      <li>{<a href="#0" onclick="return mjt._eventcb.{.apply(this, [event])">\n        Keyboard Shortcuts</a></li>\n      <li>{<a href="#0" onclick="return mjt._eventcb.{.apply(this, [event])">\n        Acre API Reference</a></li>\n      <li>{<a href="#0" onclick="return mjt._eventcb.{.apply(this, [event])">\n        Acre Template Tag Reference</a></li>\n    </ul>\n  </div>\n  <div class="menu-section last">{\n    <a href="#0" onclick="return mjt._eventcb.{.apply(this, [event])">About App Editor</a>\n  </div>\n  </div>{{\n\n\n<\!-- App  menu --\>{{{\n  <div class="dialog-close" onclick="return mjt._eventcb.{.apply(this, [event])"></div>\n  <div class="clear" id="app-settings-section">\n    <div id="settings-tabs">\n      <ul id="settings-tabs-bar">\n        <li class="tab"><a class="settings-tab-link" href="#app_general">Versions</a></li>\n        <li class="tab"><a class="settings-tab-link" href="#app_changes">Changes</a></li>\n        <li class="tab"><a class="settings-tab-link" href="#app_authors">Authors</a></li>{\n        <li class="tab"><a class="settings-tab-link" href="#app_services">Keys</a></li>{\n      </ul>\n      <div class="tabbed-content" id="settings-tab-content">\n        <div id="app_general"></div>\n        <div id="app_changes"></div>\n        <div id="app_authors"></div>\n        <div id="app_services"></div>\n      </div>\n    </div>\n  </div>\n  <div class="button-bar">{\n    <fieldset id="app-clonedelete">{\n      <button class="button-main" id="app-general-listing">\n        Edit Name &amp; Directory Listing</button>{{\n      <button id="app-general-clone" onclick="return mjt._eventcb.{.apply(this, [event])">\n        Clone this App</button>{{\n      <button id="app-general-delete" onclick="return mjt._eventcb.{.apply(this, [event])">\n        Delete this App</button>{\n    </fieldset>{\n    <fieldset id="app-clonedelete">{\n      <button id="app-general-clone" onclick="return mjt._eventcb.{.apply(this, [event])">\n        Clone this App</button>{\n    </fieldset>{{\n    <button onclick="return mjt._eventcb.{.apply(this, [event])">Done</button>\n  </div>{{{<div class="tab-body"{>{\n\n    <div class="tab-section">\n      <h3>Versions</h3>\n      <div class="sidebar">\n        <p>\n          App authors can create and release new versions of their app any time.\n        </p>\n        <p>\n          <em>Current</em> is always the latest version; all edits are made to Current.  Other versions are read only.\n        </p>\n        <p>\n          <em>Release</em> is the version the app author wants people to use.  Any version can be released, but it\'s good practice to create and release a version other than Current to prevent development from impacting users.\n        </p>\n      </div>{\n      <fieldset id="add-version">\n        <label for="add-version-key">Create a new version: </label>\n        <input id="add-version-key" maxlength="10" type="text">{\n        <button id="button-version" onclick="return mjt._eventcb.{.apply(this, [event])">\n          Add Version</button>{\n        <button onclick="return mjt._eventcb.{.apply(this, [event])">\n          View Changes</button>{\n      </fieldset>{\n      <div id="app-versions-add">{</div>\n    </div>\n\n    <div class="tab-section">{{\n      <div class="app-url">\n        <p>\n          Your <strong>Dev URL</strong> points to <em>Current:</em>\n        </p>\n        <fieldset>\n            http://<input class="shortfield" id="devurl" maxlength="20" minlength="5" type="text" value="{">{.{\n          <button disabled="disabled" id="button-devurl">Change URL</button>\n        </fieldset>\n      </div>{\n      <div class="app-url">\n        <p>URL to <em>Current</em> version:</p>\n        <p><a href="{" target="current">{</a></p>\n      </div>{{\n    </div>\n    <div class="tab-section last">\n      <div class="app-url">\n        {\n      </div>\n    </div>\n  </div>{{{{\n      <div>\n        <p>Your <strong>Release URL</strong> points to <em>Release:</em></p>\n        <fieldset>\n          http://<input id="puburl" maxlength="20" minlength="5" type="text" value="{">.{\n          <button disabled="disabled" id="button-puburl">{\n            <span>Change URL</span>{\n            <span>Choose URL</span>{\n          </button>\n          <span id="puburl-status"></span>\n        </fieldset>{\n        <div>\n          <h4 class="list-title">Other URLs:</h4>\n          <table class="edit-list">{\n            <tr>\n              <td><a href="http://{" target="_blank">{</a></td>\n              <td>{<span class="version-bad">{</span>{</td>\n            </tr>{\n          </table>\n        </div>{{\n      </div>{\n      <div>{\n        <div>\n          <p>URL to <em>Release</em> version:</p>{\n          <p><a href="http://{" target="release">http://{.{</a>\n          </p>{\n        </div>{\n      </div>{{{{\n\n      <div id="app-versions-list">\n        <table class="edit-list">\n          <thead>\n            <tr>{\n              <th class="center">release</th>{\n              <th class="left">version</th>\n              <th class="left">snapshot time</th>{\n              <th class="center">run on<br>sandbox</th>{\n              <th></th>{\n              <th></th>{\n            </tr>\n          </thead>\n          <tbody>\n            <tr class="version-listitem">{\n              <td class="center">{\n                <input{ name="version-release"{ type="radio"{ value="current"{>{\n                <span>{<em>\u2713</em>{</span>{\n              </td>{\n              <td>\n                <a apppath="{" class="app-link" href="{">Current</a>\n              </td>\n              <td></td>{\n              <td></td>{\n              <td><a href="{" target="_blank">view</a></td>{\n              <td></td>{\n            </tr>{\n            <tr class="version-listitem">{{\n              <td class="center">{\n                <input{ name="version-release"{ type="radio"{ value="{"{>{\n                <span>{<em>\u2713</em>{</span>{\n              </td>{\n              <td>\n                <a apppath="{" class="app-link" href="{">{</a>\n              </td>\n              <td>{\n                <span>\n                  {{\n                  <span>\n                    [{<a href="#0" onclick="return mjt._eventcb.{.apply(this, [event])">set to now</a>]\n                  </span>{\n                </span>{\n              </td>{\n              <td class="center">\n                <input{ class="version-service-url"{ key="{"{ type="checkbox"{>\n              </td>{\n              <td><a href="{" target="_blank">view</a></td>{\n              <td class="remove">{\n                <a class="remove-version-button" href="#0" key="{">x</a>{\n              </td>{\n            </tr>{\n          </tbody>\n        </table>\n      </div>{{{<div class="tab-body"{>{\n    <div class="tab-section">\n      <div class="sidebar">\n        <p>\n          View the changes between versions or even individual edits.\n        </p>\n        <p>\n          If you\'re an author, you can also <em>revert</em> the changes.\n        </p>\n      </div>\n      <h3>App History</h3>{\n      <button id="button-app-history" onclick="return mjt._eventcb.{.apply(this, [event])">\n        Diff Versions &amp; Edits</button>\n    </div>\n    <div class="tab-section">\n      <div class="sidebar">\n        <p>\n          View the changes between this app and it\'s parents or children.\n        </p>\n        <p>\n          If you\'re an author, you can also <em>merge</em> the changes.\n        </p>\n\n      </div>\n      <h3>View Changes from Clones</h3>\n      <div id="clone-list">{\n        <p>\n          <i>\n            This app does not have either parent or children apps.  <br>\n            Choose any app to view changes from below.\n          </i>\n        </p>{{\n        <table class="edit-list">\n          <thead>\n            <tr colspan="2"><th class="left">Parent:</th></tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td class="left">\n                <a apppath="{" class="app-link" href="#0">{</a>\n              </td>\n              <td class="right">\n                <button class="button-get-changes" value="{">View Changes</button>\n              </td>\n            </tr>\n          </tbody>\n        </table>{{\n        <table class="edit-list">\n          <thead>\n            <tr colspan="2"><th class="left">Children:</th></tr>\n          </thead>\n          <tbody>{\n            <tr>\n              <td class="left">\n                <a apppath="{" class="app-link" href="#0">{</a>\n              </td>\n              <td class="right">\n                <button class="button-get-changes" value="{">View Changes</button>\n              </td>\n            </tr>{\n          </tbody>\n        </table>{\n      </div>\n    </div>\n    <div class="tab-section last">\n      <div class="sidebar">\n        <p>\n          Select any app you\'d like to view changes from.\n        </p>\n      </div>\n      <h3>View Changes from any App</h3>\n      <fieldset id="add-patch">\n        <label for="merge-app">Choose app: </label>\n        <input id="merge-app" maxlength="60" type="text">\n        <button class="button-get-changes" disabled="disabled" id="button-merge">\n          View Changes</button>\n      </fieldset>\n    </div>{\n  </div>{{<div class="tab-body"{>\n    <div class="tab-section last">{\n      <div>\n        <div class="sidebar">\n          <p>\n            You can add other Freebase users as <em>Authors</em>\n            to your app.  Choose authors carefully! They can edit code, release versions,\n            and delete files.\n          </p>\n        </div>\n        <h3>Add an Author</h3>\n        <fieldset class="form-indent">\n          <label for="add-author-input">Find a user to add</label>\n          <input id="add-author-input" type="text">\n        </fieldset>\n\n        <div id="app-authors-list">\n          {\n        </div>{\n      </div>{\n      <div>\n        <h3>Authors</h3>\n        <div id="app-authors-list">\n          {\n        </div>\n      </div>{\n    </div>\n  </div>{{{\n\n      <h4 class="list-title">These authors can edit this app:</h4>\n\n      <table class="edit-list">{\n        <tr class="user-listitem">\n          <td class="user-image-cell">\n            <div class="user-image">\n              <a href="{" target="user" title="View profile for {">\n                <img alt="mugshot" src="{">\n              </a>\n            </div>\n          </td>\n          <td>\n            <a class="user-name" href="{" target="user" title="View profile for {">{</a>\n          </td>\n          <td class="remove">{\n            <a class="remove-user-button" href="#0" user="{">x</a>{\n          </td>\n        </tr>{\n      </table>{{{<div class="tab-body"{>{\n    <div class="tab-section">\n      <div class="sidebar">\n        <p>\n          <em>API keys</em> authorize information exchange with other web applications or services.\n        </p>\n        <p>\n          To use the Freebase APIs specifically, follow the <a href="http://wiki.freebase.com/wiki/How_to_obtain_an_API_key" target="blank">instructions on the wiki</a>.\n        </p>\n      </div>\n      <h3>API Keys</h3>{\n      <div id="app-apikeys-add">{\n      <div>{<div>{\n          {\n        </div>{<p><span class="loader-square hidden" id="version-loader"></span></p>{<p>Error loading API keys.</p>{</div>\n      </div>\n    </div>\n    <div class="tab-section last">\n      <div class="sidebar">\n        <p>\n          To make a Freebase API call as this writeuser, use the <em>http_sign: "keystore"</em> option.\n        </p>\n        <p>\n          Be careful with this option, as you may exceed\n          Freebase\'s daily single-user write limit.\n        </p>\n      </div>\n      <fieldset id="permissions-settings">\n        <h3>Freebase writeuser</h3>\n        <div class="radiogroup">\n          <h5>\n            <input{ id="permission-writeuser"{ type="checkbox"{>\n            Allow <strong>{</strong> to write on behalf of any user\n          </h5>\n          <p>\n            <small>\n              <em>Note:</em> You also need to do a special\n              <a href="{">\n              login</a> to your app to set the <strong>freebase_writeuser_access</strong> API key.\n            </small>\n          </p>\n        </div>\n      </fieldset>\n    </div>{\n  </div>{{\n      <fieldset>\n        <div class="form-row">\n          <label for="apikey-name">Name / Domain:</label>\n          <input id="apikey-name" type="text">\n        </div>\n        <div class="form-row">\n          <label for="apikey-token">Key:</label>\n          <input id="apikey-token" type="text">\n        </div>\n        <div class="form-row">\n          <label for="apikey-secret">Secret:</label>\n          <input id="apikey-secret" type="text"><br>\n        </div>\n        <div class="form-row">\n          <button disabled="disabled" id="button-apikey-add">Add API Key</button>\n        </div>\n      </fieldset>{\n      <div id="api-key-list">\n        <table class="edit-list">\n          <thead>\n            <tr class="key-listitem">\n              <th>Name / Domain</th>\n              <th>Key</th>\n              <th>Secret</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>{\n            <tr class="key-listitem">\n              <td>{</td>\n              <td>{</td>\n              <td>{</td>\n              <td class="remove">{\n                <a class="remove-key-button" href="#0" key="{">x</a>{\n              </td>\n            </tr>{\n          </tbody>\n        </table>\n      </div>{\n      <h4 class="list-title">You haven\'t added any API keys.</h4>{{{'.split("{"),
debug_locs:[1,1,1,1,1,1,7,7,7,7,7,7,8,8,9,10,11,12,13,13,13,13,13,13,13,13,15,15,15,15,16,16,16,16,16,16,16,19,19,19,19,22,22,22,22,22,22,23,25,25,25,25,25,26,26,26,30,30,30,30,30,31,31,31,32,32,32,33,34,35,36,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,39,39,39,40,40,40,41,41,41,41,43,43,43,43,44,45,46,47,48,49,50,50,50,50,50,50,51,51,51,51,52,52,53,54,55,56,57,57,57,57,57,58,59,59,59,59,59,60,60,60,60,60,60,60,60,61,61,61,63,63,63,63,63,63,63,64,64,64,65,65,65,66,67,68,69,70,71,72,73,73,73,
73,73,73,76,76,76,76,76,76,76,77,77,78,79,80,81,82,83,83,87,87,87,87,87,87,87,88,88,88,88,88,90,90,90,90,91,91,94,94,94,94,94,94,94,94,94,95,95,96,97,98,99,100,101,102,103,104,105,108,108,108,108,108,108,108,108,108,108,108,108,108,108,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,112,112,112,113,113,113,113,113,113,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,122,122,122,123,123,
123,123,123,123,126,126,126,126,126,127,128,129,130,131,132,133,134,135,136,137,138,138,138,138,138,138,138,138,138,140,140,140,140,141,146,146,146,146,146,146,146,146,150,150,150,150,150,150,153,153,153,153,153,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,167,167,167,168,168,168,168,168,168,168,175,175,175,175,175,175,175,175,175,175,175,
175,175,175,175,175,175,175,175,175,175,175,175,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,178,181,181,181,181,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,195,195,195,195,195,198,198,198,198,198,198,198,199,199,200,201,202,203,204,205,206,207,208,208,209,209,209,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,213,214,214,214,214,214,215,215,215,215,215,215,215,217,217,217,217,218,218,219,
219,219,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,223,223,223,223,223,223,223,223,223,223,223,223,223,223,223,223,223,223,225,225,225,225,226,226,227,227,227,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,231,233,233,233,233,234,234,235,235,235,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,238,239,239,239,239,239,239,239,239,239,239,
239,239,239,239,239,239,239,239,241,241,241,241,242,242,243,243,243,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,246,247,247,247,247,247,247,247,247,247,247,247,247,247,247,247,247,247,247,249,249,249,249,250,250,254,254,254,254,254,254,254,255,255,255,256,257,258,259,260,261,262,263,264,265,266,266,266,266,266,266,269,269,269,269,269,269,269,274,274,274,274,274,274,274,274,274,274,274,276,276,276,276,276,276,276,276,278,278,278,278,278,278,278,278,283,283,283,283,283,
283,283,283,283,283,283,286,286,286,286,286,287,288,289,290,291,292,292,292,292,292,292,295,295,295,295,295,295,295,296,296,297,298,299,299,299,299,299,299,299,306,306,306,306,306,306,306,306,306,306,306,317,317,317,317,317,317,317,317,317,317,317,317,318,318,318,319,319,319,319,320,320,320,320,320,320,320,320,321,321,321,322,322,322,322,322,322,322,322,323,323,323,324,324,324,325,326,326,326,326,326,326,326,326,326,327,327,327,328,328,328,329,329,329,329,329,329,329,331,331,331,331,332,333,334,335,
336,337,338,339,340,341,342,343,344,345,346,347,348,349,349,349,349,349,349,350,350,350,350,350,350,351,351,352,353,368,368,368,368,368,368,368,368,368,368,368,368,368,368,368,368,371,371,371,371,371,371,371,371,371,371,374,374,374,374,374,374,374,374,374,375,375,375,376,376,376,377,377,377,381,381,381,381,381,382,383,384,385,386,386,391,391,391,391,391,391,391,391,391,391,391,391,394,394,394,394,394,395,397,397,397,397,397,397,397,398,398,398,399,399,399,399,400,401,402,403,404,405,406,407,408,409,
410,410,413,413,413,413,413,413,416,416,416,416,416,416,416,416,416,418,418,418,418,419,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,438,441,441,441,441,441,441,441,441,443,443,443,443,443,443,444,444,444,444,448,448,448,448,448,451,451,451,451,451,451,451,451,452,452,452,452,452,452,453,453,453,453,453,453,453,454,454,454,454,454,454,454,456,456,456,456,457,457,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,
483,484,484,484,484,485,485,485,487,487,487,487,487,487,487,487,487,487,487,488,488,488,489,489,489,490,490,490,491,491,491,491,491,491,493,493,493,493,494,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,519,519,519,519,519,519,519,519,519,519,522,522,522,522,522,522,522,524,524,524,524,524,524,529,529,529,529,529,529,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,531,531,531,531,531,531,531,531,532,532,532,534,534,534,534,534,534,
537,537,537,537,537,537,537,538,538,538,539,539,539,539,539,541,541,541,541,541,542,542,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,556,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,558,559,559,559,559,559,559,559,559,560,560,560,562,562,562,562,562,562,562,562,565,565,565,565,566,566,566,566,567,567,568,568,568,568,568,568,568,568,569,569,569,570,570,570,572,572,572,574,574,574,574,574,574,574,574,574,574,574,574,574,574,574,574,574,574,574,
575,575,575,576,576,576,577,577,578,578,578,578,578,578,578,578,579,579,579,580,580,580,580,580,580,584,584,584,584,584,584,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,604,605,605,605,605,605,605,607,607,607,607,607,607,608,608,609,610,611,612,623,623,623,623,623,623,623,623,623,623,623,623,623,623,623,623,623,638,638,638,638,638,638,638,638,638,638,638,638,638,638,638,638,643,643,643,643,643,643,643,643,644,644,651,651,651,651,651,651,651,651,651,651,651,651,
654,654,654,654,654,658,658,658,658,658,658,659,659,664,664,664,664,664,664,664,664,664,666,666,666,666,666,666,666,669,669,669,669,669,671,671,671,671,671,671,671,673,673,673,673,690,690,690,690,690,690,690,690,690,690,690,690,690,690,690,690,690,690,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,707,707,707,707,707,707,708,708,708,708,708,708,710,710,710,725,725,725,725,725,725,725,725,725,725,725,725,725,725,725,725,725,725,727,727,727,727,728,729,730,731,732,733,734,735,
736,737,738,739,739,739,739,742,742,742,742,742,742,744,744,744,744,746,746,746,746,746,746,746,746,748,748,748,748,749,749,750,751,756,756,756,756,756,756,756,756,759,759,759,759,759,759,759,759,760,760,760,765,765,765,765,765,765,765,765,765,765,765,768,768,768,768,768,768,768,768,768,770,770,770,770,770,770,770,772,772,772,772,773,774,775,776,777,778,779,780,781,781,781,781,781,781,782,782,782,782,782,782,783,783,784,785,786,787,788,789,790,791,792,793,794,805,805,805,805,805,805,805,805,805,805,
805,805,805,805,805,805,809,809,809,809,809,809,811,811,812,813,815,815,815,816,816,816,816,816,816,816,817,817,817,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,835,836,836,836,845,845,845,845,845,845,845,845,845,845,845,852,852,852,852,852,852,852,852,852,853,854,855,856,857,858,858,858,858,858,858,858,859,859,859,859,877,877,877,877,877,877,877,877,877,877,877,877,877,877,877,877,877,877,877,888,888,888,888,888,888,888,888,888,
888,888,888,888,888,888,889,889,889,889,890,890,890,891,891,891,893,893,893,893,893,893,893,893,895,895,895,895,895,895,895,898,898,898,898,898,899,899,899,899,900,900,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,919,919,919,919,919,920,920,920,920],output_mode:"html"}}})})(window.freebase.acre,window.freebase.h);
